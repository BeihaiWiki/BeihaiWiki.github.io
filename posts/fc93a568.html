<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>é‡‘ç –å›½å®¶æœºå™¨å­¦ä¹ æ¯”èµ› | åŒ—æµ·`Blog</title><meta name="keywords" content="åšå®¢,æˆ‘çš„å¤§å­¦ç”Ÿæ´»,Java,ç®—æ³•,åŒ—æµ·wiki"><meta name="author" content="åŒ—æµ·ğŸŒŠ"><meta name="copyright" content="åŒ—æµ·ğŸŒŠ"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="ğŸ±â€ğŸ‘“é‡‘ç –å›½å®¶åä¸œåŒºåŸŸç«èµ›">
<meta property="og:type" content="article">
<meta property="og:title" content="é‡‘ç –å›½å®¶æœºå™¨å­¦ä¹ æ¯”èµ›">
<meta property="og:url" content="https://www.beihai.wiki/posts/fc93a568.html">
<meta property="og:site_name" content="åŒ—æµ·&#96;Blog">
<meta property="og:description" content="ğŸ±â€ğŸ‘“é‡‘ç –å›½å®¶åä¸œåŒºåŸŸç«èµ›">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tuchuang.voooe.cn/images/2024/06/28/bc18.webp">
<meta property="article:published_time" content="2023-08-10T01:57:03.000Z">
<meta property="article:modified_time" content="2023-08-10T14:00:00.000Z">
<meta property="article:author" content="åŒ—æµ·ğŸŒŠ">
<meta property="article:tag" content="åšå®¢,æˆ‘çš„å¤§å­¦ç”Ÿæ´»,Java,ç®—æ³•,åŒ—æµ·wiki">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tuchuang.voooe.cn/images/2024/06/28/bc18.webp"><link rel="shortcut icon" href="/assets/img/%E9%BB%84%E6%B3%89.webp"><link rel="canonical" href="https://www.beihai.wiki/posts/fc93a568"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"limitCount":50,"languages":{"author":"ä½œè€…: åŒ—æµ·ğŸŒŠ","link":"é“¾æ¥: ","source":"æ¥æº: åŒ—æµ·`Blog","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.js',
      css: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'é‡‘ç –å›½å®¶æœºå™¨å­¦ä¹ æ¯”èµ›',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-08-10 22:00:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><script src="https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js"></script><link rel="stylesheet" href="https://cdn1.tianli0.top/npm/element-ui@2.15.6/packages/theme-chalk/lib/index.css"><style id="themeColor"></style><style id="rightSide"></style><style id="transPercent"></style><style id="blurNum"></style><style id="settingStyle"></style><span id="fps"></span><style id="defineBg"></style><style id="menu_shadow"></style><svg aria-hidden="true" style="position:absolute; overflow:hidden; width:0; height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="åŒ—æµ·`Blog" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/assets/img/%E5%A4%B4%E5%83%8F.gif" onerror="onerror=null;src='/assets/r1.jpg'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">5</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-home"></use></svg><span class="menu_word" style="font-size:17px"> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-article"></use></svg><span class="menu_word" style="font-size:17px"> æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-guidang">                   </use></svg><span class="menu_word" style="font-size:17px"> å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-sekuaibiaoqian">                   </use></svg><span class="menu_word" style="font-size:17px"> æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-fenlei">                   </use></svg><span class="menu_word" style="font-size:17px"> åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-kafei"></use></svg><span class="menu_word" style="font-size:17px"> ä¼‘é—²</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-music">                   </use></svg><span class="menu_word" style="font-size:17px"> å…«éŸ³ç›’</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/movies/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-dianying">                   </use></svg><span class="menu_word" style="font-size:17px"> å½±é™¢</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-gamepad">                   </use></svg><span class="menu_word" style="font-size:17px"> æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiangzi"></use></svg><span class="menu_word" style="font-size:17px"> å…«å®ç®±</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-tubiaozhizuomoban">                   </use></svg><span class="menu_word" style="font-size:17px"> ç”»å»Š</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-Halloween-">                   </use></svg><span class="menu_word" style="font-size:17px"> åŠ¨ç”»</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifengche">                   </use></svg><span class="menu_word" style="font-size:17px"> ç½‘å€å¯¼èˆª</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shejiaoxinxi"></use></svg><span class="menu_word" style="font-size:17px"> ç¤¾äº¤</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/social/fcircle/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pengyouquan">                   </use></svg><span class="menu_word" style="font-size:17px"> æœ‹å‹åœˆ</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-liuyan">                   </use></svg><span class="menu_word" style="font-size:17px"> ç•™è¨€æ¿</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-lianjie1">                   </use></svg><span class="menu_word" style="font-size:17px"> å‹äººå¸</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-wangye"></use></svg><span class="menu_word" style="font-size:17px"> ç½‘ç«™</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/census/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--tongjibiao">                   </use></svg><span class="menu_word" style="font-size:17px"> ç½‘ç«™ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/echarts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shujutongji1">                   </use></svg><span class="menu_word" style="font-size:17px"> æ–‡ç« ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/time/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xianxingshalou">                   </use></svg><span class="menu_word" style="font-size:17px"> æ—§æ—¶å…‰</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-mofashikatong"></use></svg><span class="menu_word" style="font-size:17px"> ä¸ªäºº</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/personal/bb/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-go">                   </use></svg><span class="menu_word" style="font-size:17px"> å” å¨</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/love/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-aiqing">                   </use></svg><span class="menu_word" style="font-size:17px"> æ‹çˆ±å°å±‹</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/about/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-paperplane">                   </use></svg><span class="menu_word" style="font-size:17px"> å…³äº</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">åŒ—æµ·`Blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-home"></use></svg><span class="menu_word" style="font-size:17px"> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-article"></use></svg><span class="menu_word" style="font-size:17px"> æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-guidang">                   </use></svg><span class="menu_word" style="font-size:17px"> å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-sekuaibiaoqian">                   </use></svg><span class="menu_word" style="font-size:17px"> æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-fenlei">                   </use></svg><span class="menu_word" style="font-size:17px"> åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-kafei"></use></svg><span class="menu_word" style="font-size:17px"> ä¼‘é—²</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-music">                   </use></svg><span class="menu_word" style="font-size:17px"> å…«éŸ³ç›’</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/movies/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-dianying">                   </use></svg><span class="menu_word" style="font-size:17px"> å½±é™¢</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-gamepad">                   </use></svg><span class="menu_word" style="font-size:17px"> æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiangzi"></use></svg><span class="menu_word" style="font-size:17px"> å…«å®ç®±</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-tubiaozhizuomoban">                   </use></svg><span class="menu_word" style="font-size:17px"> ç”»å»Š</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-Halloween-">                   </use></svg><span class="menu_word" style="font-size:17px"> åŠ¨ç”»</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifengche">                   </use></svg><span class="menu_word" style="font-size:17px"> ç½‘å€å¯¼èˆª</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shejiaoxinxi"></use></svg><span class="menu_word" style="font-size:17px"> ç¤¾äº¤</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/social/fcircle/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pengyouquan">                   </use></svg><span class="menu_word" style="font-size:17px"> æœ‹å‹åœˆ</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-liuyan">                   </use></svg><span class="menu_word" style="font-size:17px"> ç•™è¨€æ¿</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-lianjie1">                   </use></svg><span class="menu_word" style="font-size:17px"> å‹äººå¸</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-wangye"></use></svg><span class="menu_word" style="font-size:17px"> ç½‘ç«™</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/census/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--tongjibiao">                   </use></svg><span class="menu_word" style="font-size:17px"> ç½‘ç«™ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/echarts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shujutongji1">                   </use></svg><span class="menu_word" style="font-size:17px"> æ–‡ç« ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/time/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xianxingshalou">                   </use></svg><span class="menu_word" style="font-size:17px"> æ—§æ—¶å…‰</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-mofashikatong"></use></svg><span class="menu_word" style="font-size:17px"> ä¸ªäºº</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/personal/bb/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-go">                   </use></svg><span class="menu_word" style="font-size:17px"> å” å¨</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/love/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-aiqing">                   </use></svg><span class="menu_word" style="font-size:17px"> æ‹çˆ±å°å±‹</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/about/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-paperplane">                   </use></svg><span class="menu_word" style="font-size:17px"> å…³äº</span></a></li></ul></div></div><center id="name-container"><a id="page-name" href="javascript:scrollToTop()">PAGE_NAME</a></center><div id="nav-right"><div id="search-button"><a class="search faa-parent animated-hover" title="æ£€ç´¢ç«™å†…ä»»ä½•ä½ æƒ³è¦çš„ä¿¡æ¯"><svg class="faa-tada icon" style="height:24px;width:24px;fill:currentColor;position:relative;top:6px" aria-hidden="true"><use xlink:href="#icon-valentine_-search-love-find-heart"></use></svg><span> æœç´¢</span></a></div><a class="meihua faa-parent animated-hover" onclick="toggleWinbox()" title="ç¾åŒ–è®¾ç½®-è‡ªå®šä¹‰ä½ çš„é£æ ¼" id="meihua-button"><svg class="faa-tada icon" style="height:26px;width:26px;fill:currentColor;position:relative;top:8px" aria-hidden="true"><use xlink:href="#icon-tupian1"></use></svg></a><a class="sun_moon faa-parent animated-hover" onclick="switchNightMode()" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢" id="nightmode-button"><svg class="faa-tada" style="height:25px;width:25px;fill:currentColor;position:relative;top:7px" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon">       </use></svg></a><div id="toggle-menu"><a><i class="fas fa-bars fa-fw"></i></a></div></div></div></nav><div id="post-info"><h1 class="post-title">é‡‘ç –å›½å®¶æœºå™¨å­¦ä¹ æ¯”èµ›</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><svg class="meta_icon post-meta-icon" style="width:30px;height:30px;position:relative;top:10px"><use xlink:href="#icon-rili"></use></svg><span class="post-meta-label">å‘è¡¨äº </span><time class="post-meta-date-created" datetime="2023-08-10T01:57:03.000Z" title="å‘è¡¨äº 2023-08-10 09:57:03">2023-08-10</time><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-gengxin1"></use></svg><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-08-10T14:00:00.000Z" title="æ›´æ–°äº 2023-08-10 22:00:00">2023-08-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-biaoqian"></use></svg><a class="post-meta-categories" href="/categories/%E5%B7%A5%E4%BD%9C%E5%AE%A4/">å·¥ä½œå®¤</a><i class="fas fa-angle-right post-meta-separator"></i><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-biaoqian"></use></svg><a class="post-meta-categories" href="/categories/%E5%B7%A5%E4%BD%9C%E5%AE%A4/%E5%A4%A7%E6%95%B0%E6%8D%AE/">å¤§æ•°æ®</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:8px"><use xlink:href="#icon-charuword"></use></svg><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">2.7w</span><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:20px;height:20px;position:relative;top:5px"><use xlink:href="#icon-shizhong"></use></svg><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>113åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="é‡‘ç –å›½å®¶æœºå™¨å­¦ä¹ æ¯”èµ›"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:5px"><use xlink:href="#icon-eye"></use></svg><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1>æœºå™¨å­¦ä¹ ä¸å¤§æ•°æ®èµ›é¡¹</h1>
<p>ç«èµ›ç¯å¢ƒï¼š</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>æŠ€æœ¯è§„æ ¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>Hadoop</td>
<td>3.3.x</td>
</tr>
<tr>
<td>Sqoop</td>
<td>1.4.x</td>
</tr>
<tr>
<td>Hive</td>
<td>2.3.x</td>
</tr>
<tr>
<td>Zookeeper</td>
<td>3.6.x</td>
</tr>
<tr>
<td>Flume</td>
<td>1.10.x</td>
</tr>
<tr>
<td>Spark</td>
<td>3.3.x</td>
</tr>
<tr>
<td>Flink</td>
<td>1.15.x</td>
</tr>
<tr>
<td>JDK</td>
<td>11</td>
</tr>
<tr>
<td>Scala</td>
<td>2.13.x</td>
</tr>
<tr>
<td>Python</td>
<td>3.7.x</td>
</tr>
</tbody>
</table>
<p>æ¯”èµ›å†…å®¹:</p>
<blockquote>
<p>Hadoop å¹³å°æ­å»ºã€HDFS æ•°æ®å­˜å‚¨ã€Flume æ•°æ®é‡‡é›†ã€Sqoop æ•°æ®å¯¼å…¥ã€MapReduce æ‰¹å¤„ç†æ“ä½œã€Hive æ•°æ®æŸ¥è¯¢ã€å¤§æ•°æ® å¯è§†åŒ–ã€æ•°æ®æ•´åˆã€æ•°æ®è¯»å–ã€æ•°æ®æ¢æŸ¥ã€æ•°æ®å¤„ç†ã€æ•°æ® å»ºæ¨¡ã€æ¨¡å‹è¯„ä»·ã€‚</p>
</blockquote>
<h1>æ¨¡å—Aï¼šå¤§æ•°æ®è¿ç»´ä¸åº”ç”¨(30åˆ†)</h1>
<blockquote>
<p>ä¸‰å¤©æŠŠå®Œå…¨åˆ†å¸ƒå¼è‡ªå·±æ­å»ºäº†ä¸€éï¼Œä¸­é—´mysqlçš„å®‰è£…æ˜¯æäº†å¥½ä¹…ï¼Œhiveå¯åŠ¨å¤±è´¥ï¼Œå¤šåŠæ˜¯mysqlæœ‰é”™è¯¯ï¼Œmysqlé‚£é‡Œè¿˜æ˜¯è¦å¤šçœ‹çœ‹ã€‚å‰©ä¸‹çš„æ—¶é—´å°±æ˜¯èƒŒåŠ ç»ƒäº†ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„</p>
</blockquote>
<h2 id="HadoopåŸºç¡€ç¯å¢ƒæ­å»º">HadoopåŸºç¡€ç¯å¢ƒæ­å»º</h2>
<p>å‚è€ƒé“¾æ¥: <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44715376/article/details/130843233?csdn_share_tail=%7B%22type%22%3A%22blog%22%2C%22rType%22%3A%22article%22%2C%22rId%22%3A%22130843233%22%2C%22source%22%3A%22qq_44715376%22%7D&amp;fromshare=blogdetail">https://blog.csdn.net/qq_44715376/article/details/130843233?csdn_share_tail={&quot;type&quot;%3A&quot;blog&quot;%2C&quot;rType&quot;%3A&quot;article&quot;%2C&quot;rId&quot;%3A&quot;130843233&quot;%2C&quot;source&quot;%3A&quot;qq_44715376&quot;}&amp;fromshare=blogdetail</a></p>
<p>1ã€å®‰è£…è™šæ‹Ÿæœºå’ŒLinuxæ“ä½œç³»ç»Ÿï¼Œé…ç½®IPåœ°å€ã€ä¸»æœºåã€é˜²ç«å¢™ã€åœ°å€æ˜ å°„ç­‰</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ç½‘å¡</span><br><span class="line">vi /etc/sysconfig/network-scripts/ifcfg-ens33</span><br><span class="line"></span><br><span class="line">/ect/hosts        é…ç½®ä¸»æœºåå’ŒIPåœ°å€çš„å¯¹åº”ï¼Œå¯¹æœ¬æœºæä¾›è§£æ</span><br><span class="line">/etc/resolv.conf      é…ç½®åŸŸåï¼ˆåœ¨hostså†…è§£æä¸åˆ°æ—¶æ­¤åŸŸåç”Ÿæ•ˆï¼‰</span><br><span class="line">/etc/sysconfig/network      é…ç½®ä¸»æœºåå’Œç½‘å…³</span><br><span class="line">/etc/sysconfig/network-scripts/ifcfg-eth0 é…ç½®IPã€Maskç­‰ç½‘ç»œå‚æ•°</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:%5CUsers%5Cbeihai%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230704224936122.png" alt="image-20230704224936122"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">é‡å¯ç½‘å¡</span><br><span class="line">systemctl restart netword</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹ç½‘å¡</span><br><span class="line">ip addr æˆ– ifconfig</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ä¸»æœºå ï¼š/etc/hostname</span><br><span class="line">master</span><br><span class="line">æ˜ å°„ï¼š/etc/hosts</span><br><span class="line">192.168.43.10 master</span><br><span class="line">192.168.43.20 node01</span><br><span class="line">192.168.43.30 node02</span><br><span class="line">å…³é—­é˜²ç«å¢™</span><br><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl disable firewalld</span><br><span class="line">å…³é—­Linunxå®‰å…¨å­ç³»ç»Ÿ</span><br><span class="line">vi /etc/selinux/config</span><br><span class="line">SELINUX=disabled</span><br><span class="line">é‡å¯ç³»ç»Ÿ</span><br><span class="line">reboot</span><br></pre></td></tr></table></figure>
<p>2ã€å®‰è£… JDK ä¸ Hadoop</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">ä¸Šä¼ å®‰è£…åŒ…</span><br><span class="line">è§£å‹</span><br><span class="line">tar -zxvf jdk-8u261-linux-x64.tar.gz -C /opt/softwore/</span><br><span class="line">tar -zxvf hadoop-2.7.7\ .tar.gz -C /opt/softwore</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹é…ç½®æ–‡ä»¶</span><br><span class="line">vim + /etc/profile</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">JAVA_HOME</span></span><br><span class="line">export JAVA_HOME=/usr/local/src/jdk</span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">HADOOP_HOME</span></span><br><span class="line">export HADOOP_HOME=/usr/local/src/hadoop</span><br><span class="line">export PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbin</span><br><span class="line">export HDFS_NAMENODE_USER=root</span><br><span class="line">export HDFS_DATANODE_USER=root</span><br><span class="line">export HDFS_SECONDARYNAMENODE_USER=root</span><br><span class="line">export YARN_RESOURCEMANAGER_USER=root</span><br><span class="line">export YARN_NODEMANAGER_USER=root</span><br><span class="line"></span><br><span class="line">é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ï¼Œä½¿é…ç½®ç”Ÿæ•ˆ</span><br><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>
<p>3ã€å®Œå…¨åˆ†å¸ƒå¼éƒ¨ç½²ï¼ˆHDFS)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">é…ç½®æ–‡ä»¶è·¯å¾„ï¼š/usr/local/src/hadoop/etc/hadoop</span><br><span class="line">HDFS</span><br><span class="line">ä¿®æ”¹ hadoop-env.sh è®¾ç½® Hadoop ç¯å¢ƒå¯¹åº”çš„ JDK</span><br><span class="line">export JAVA_HOME=/usr/local/src/jdk</span><br><span class="line"></span><br><span class="line">é…ç½® MapReduce ä¸ YARN</span><br><span class="line">ä¿®æ”¹ yarn-env.shã€mapred-env.sh æ·»åŠ  JAVA_HOME é…ç½®</span><br><span class="line">export JAVA_HOME=/usr/local/src/jdk</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>ä¿®æ”¹ core-site.xml é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ NotePad++ è¿›è¡Œé…ç½®</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--NameNodeçš„è®¿é—®URIï¼Œä¹Ÿå¯ä»¥å†™ä¸ºIPï¼Œ8020ä¸ºé»˜è®¤ç«¯å£--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://192.168.201.10:8020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--ä¸´æ—¶æ•°æ®ç›®å½•ï¼Œç”¨æ¥å­˜æ”¾æ•°æ®ï¼Œæ ¼å¼åŒ–æ—¶ä¼šè‡ªåŠ¨ç”Ÿæˆ--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>/usr/local/src/hadoop/data/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>ä¿®æ”¹ hdfs-site.xml é…ç½®æ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--Blockçš„å‰¯æœ¬æ•°ï¼Œä¼ªåˆ†å¸ƒå¼è¦æ”¹ä¸º1--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--NameNode å…ƒæ•°æ®å­˜æ”¾åœ°å€--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.name.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>/usr/local/src/hadoop/data/namenode<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--DataNode å‰¯æœ¬å­˜æ”¾åœ°å€--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.data.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>/usr/local/src/hadoop/data/datanode<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--HDFS ä¸´æ—¶å­˜æ”¾åœ°å€--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>/usr/local/src/hadoop/data/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--é…ç½®æœ‰secondarynamenodeçš„ä¸»æœº--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>master:50090<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>mapred-site.xml ï¼ŒæŠŠ mapred-sit.xml.template å¤åˆ¶ä¸€ä»½ï¼Œä¿®æ”¹ä¸º mapred-site.xml yarn-site.xml æ·»åŠ ç›¸åº” é…ç½®</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--mapred-site.xml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!---è®¡ç®—æ¡†æ¶çš„è¿è¡Œå¹³å°é…ç½® --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--yarn-site.xml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!---YARN çš„èŠ‚ç‚¹è¾…åŠ©æœåŠ¡é…ç½® --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--é»˜è®¤æ˜¯0.0.0.0 æœ¬åœ°è®¿é—®--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>master<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>åœ¨ slaves é…ç½®æ–‡ä»¶ä¸­ æ·»åŠ  ä¸»æœºåï¼Œå®ƒæŒ‡å®šäº† DataNode å’Œ NodeManageræ‰€åœ¨çš„æœºå™¨ã€‚(æ³¨æ„è¿™é‡Œæœ‰å¯èƒ½è‡ªå¸¦workerséœ€è¦ä¿®æ”¹workers)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">node01</span><br><span class="line">node02</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å…³æœº</span><br><span class="line">poweroff</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>å…‹éš†</p>
</li>
<li>
<p>åˆ†å‘</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -r /usr/local/hadoop-3.3.1 root@slave03:/usr/local</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>4ã€SSHå…å¯†ç™»å½•</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å…ˆåœ¨æ¯ä¸€å°èŠ‚ç‚¹ç”Ÿæˆå…¬é’¥å’Œç§é’¥</span><br><span class="line">ssh-keygen</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">æŠŠæ¯ä¸€ä¸ªèŠ‚ç‚¹ä¸Šçš„å…¬é’¥æ–‡ä»¶å‘é€åˆ°æ‰€æœ‰èŠ‚ç‚¹ï¼ˆåŒ…æ‹¬è‡ªå·±ï¼‰ï¼Œæ³¨æ„ï¼šæ¯ä¸€æ¡å‘½ä»¤éƒ½éœ€è¦åœ¨3ä¸ªèŠ‚ç‚¹ä¸­æ‰§è¡Œ</span><br><span class="line">ssh-copy-id master</span><br><span class="line">ssh-copy-id node01</span><br><span class="line">ssh-copy-id node02</span><br></pre></td></tr></table></figure>
<p>5ã€æ ¼å¼åŒ–HDFS</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#master</span><br><span class="line">hdfs namenode -format</span><br></pre></td></tr></table></figure>
<p>6ã€å¯åŠ¨æœåŠ¡</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">start-dfs.sh /start-yarn.sh</span><br><span class="line"></span><br><span class="line">start-all.sh</span><br></pre></td></tr></table></figure>
<p>7ã€æŸ¥çœ‹è¿›ç¨‹</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">jps</span><br><span class="line"></span><br><span class="line">#master</span><br><span class="line">[root@master hadoop]# jps</span><br><span class="line">6002 SecondaryNameNode</span><br><span class="line">6435 NodeManager</span><br><span class="line">6280 ResourceManager</span><br><span class="line">5594 NameNode</span><br><span class="line">7835 Jps</span><br><span class="line">5775 DataNode</span><br><span class="line"></span><br><span class="line">#node01</span><br><span class="line">[root@node01 hadoop]# jps</span><br><span class="line">2131 DataNode</span><br><span class="line">2532 Jps</span><br><span class="line">2271 NodeManager</span><br><span class="line"></span><br><span class="line">#node02</span><br><span class="line">[root@node02 hadoop]# jps</span><br><span class="line">2145 NodeManager</span><br><span class="line">2405 Jps</span><br><span class="line">2023 DataNode</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Hadoopå¸¸ç”¨ç«¯å£è¯´æ˜ï¼š</span><br><span class="line">hadoop2.x</span><br><span class="line">HDFS Namenodeå†…éƒ¨é€šå¸¸ç«¯å£:8020/9000</span><br><span class="line">HDFS Namenodeå¯¹ç”¨æˆ·çš„æŸ¥è¯¢ç«¯å£:50070</span><br><span class="line">YarnæŸ¥çœ‹ä»»åŠ¡è¿è¡Œæƒ…å†µçš„:8088</span><br><span class="line">å†å²æœåŠ¡å™¨:19888</span><br><span class="line"></span><br><span class="line">hadoop3.x</span><br><span class="line">HDFS Namenodeå†…éƒ¨é€šå¸¸ç«¯å£:8020/9000/9820</span><br><span class="line">HDFS Namenodeå¯¹ç”¨æˆ·çš„æŸ»è¯¢ç«¯å£:9870</span><br><span class="line">YarnæŸ¥çœ‹ä»»åŠ¡è¿è¡Œæƒ…å†µçš„:8088</span><br><span class="line">å†å²æœåŠ¡å™¨:19888</span><br></pre></td></tr></table></figure>
<h2 id="MySQLç¦»çº¿å®‰è£…">MySQLç¦»çº¿å®‰è£…</h2>
<p>å®‰è£…åŒ…<code>mysql-5.7.20-linux-glibc2.12-x86_64.tar.gz</code>Â æ‹·è´åˆ° ç¦»çº¿ç”Ÿäº§ç¯å¢ƒ<code>/usr/local</code>ç›®å½•ä¸‹ã€‚</p>
<p>==<strong>1ã€åˆ›å»ºç”¨æˆ·</strong>==</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ mysqlç”¨æˆ·ç»„</span></span><br><span class="line">groupadd mysql</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ mysqlç”¨æˆ·</span></span><br><span class="line">useradd -g mysql mysql -d /home/mysql</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹mysqlç”¨æˆ·çš„ç™»é™†å¯†ç </span></span><br><span class="line">passwd mysql</span><br></pre></td></tr></table></figure>
<p><strong>==2ã€è§£å‹ç¼©==</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/</span><br><span class="line"></span><br><span class="line">tar -xzvf mysql-<span class="number">5.7</span><span class="number">.13</span>-linux-glibc2<span class="number">.5</span>-x86_64 </span><br><span class="line"></span><br><span class="line"><span class="comment"># æ”¹åä¸ºmysql</span></span><br><span class="line">mv mysql-<span class="number">5.7</span><span class="number">.13</span>-linux-glibc2<span class="number">.5</span>-x86_64 mysql</span><br><span class="line"></span><br><span class="line"><span class="comment">#èµ‹äºˆç”¨æˆ·è¯»å†™æƒé™</span></span><br><span class="line">chown -R mysql:mysql mysql/</span><br><span class="line">    </span><br><span class="line"><span class="comment"># åˆ é™¤maridb</span></span><br><span class="line">rpm -qa | grep mariadb</span><br><span class="line">yum remove mariadb*</span><br></pre></td></tr></table></figure>
<p><strong>==3ã€åˆ›å»ºé…ç½®æ–‡ä»¶==</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/my.cnf</span><br><span class="line"></span><br><span class="line"><span class="comment">#å†…å®¹</span></span><br><span class="line"></span><br><span class="line">[client]</span><br><span class="line">port = <span class="number">3306</span></span><br><span class="line">socket = /tmp/mysql.sock</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">character_set_server=utf8</span><br><span class="line">init_connect=<span class="string">&#x27;SET NAMES utf8&#x27;</span></span><br><span class="line">basedir=/usr/local/src/mysql</span><br><span class="line">datadir=/usr/local/src/mysql/data</span><br><span class="line">socket=/tmp/mysql.sock</span><br><span class="line">log-error=/var/log/mysqld.log</span><br><span class="line">pid-file=/var/run/mysqld/mysqld.pid</span><br><span class="line"><span class="comment">#ä¸åŒºåˆ†å¤§å°å†™</span></span><br><span class="line">lower_case_table_names = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">sql_mode=STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION</span><br><span class="line"></span><br><span class="line">max_connections=<span class="number">5000</span></span><br><span class="line"></span><br><span class="line">explicit_defaults_for_timestamp=true</span><br><span class="line"></span><br><span class="line">default-time_zone = <span class="string">&#x27;+8:00&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>==<strong>åˆå§‹åŒ–æ–‡ä»¶</strong>==</p>
<p>1ã€åˆå§‹åŒ–logæ–‡ä»¶ï¼Œé˜²æ­¢æ²¡æœ‰æƒé™</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ‰‹åŠ¨ç¼–è¾‘ä¸€ä¸‹æ—¥å¿—æ–‡ä»¶ï¼Œä»€ä¹ˆä¹Ÿä¸ç”¨å†™ï¼Œç›´æ¥ä¿å­˜é€€å‡º</span></span><br><span class="line">cd /var/log/</span><br><span class="line"></span><br><span class="line">vim mysqld.log</span><br><span class="line">ï¼šwq</span><br><span class="line"></span><br><span class="line">chmod <span class="number">777</span> mysqld.log</span><br><span class="line">chown mysql:mysql mysqld.log</span><br></pre></td></tr></table></figure>
<p>2ã€åˆå§‹åŒ–pidæ–‡ä»¶ï¼Œé˜²æ­¢æ²¡æœ‰æƒé™</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ‰‹åŠ¨ç¼–è¾‘ä¸€ä¸‹æ—¥å¿—æ–‡ä»¶ï¼Œä»€ä¹ˆä¹Ÿä¸ç”¨å†™ï¼Œç›´æ¥ä¿å­˜é€€å‡º</span></span><br><span class="line">cd /var/run/				<span class="comment">#runçš„æ–‡ä»¶ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œé‡å¯ä¼šåˆ é™¤</span></span><br><span class="line">mkdir mysqld</span><br><span class="line">cd mysqld</span><br><span class="line">vi mysqld.pid</span><br><span class="line">ï¼šwq</span><br><span class="line"><span class="comment"># ç»™æƒé™</span></span><br><span class="line">cd ..</span><br><span class="line">chmod <span class="number">777</span> mysqld</span><br><span class="line">chown -R mysql:mysql mysqld</span><br></pre></td></tr></table></figure>
<p>åˆ›å»º/opt/module/mysql/data</p>
<p>3ã€åˆå§‹åŒ–æ•°æ®åº“</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆå§‹åŒ–æ•°æ®åº“ï¼Œå¹¶æŒ‡å®šå¯åŠ¨mysqlçš„ç”¨æˆ·ï¼Œå¦åˆ™å°±ä¼šåœ¨å¯åŠ¨MySQLæ—¶å‡ºç°æƒé™ä¸è¶³çš„é—®é¢˜</span></span><br><span class="line">/usr/local/src/mysql/<span class="built_in">bin</span>/mysqld --initialize --user=mysql --basedir=/usr/local/src/mysql --datadir=/usr/local/src/mysql/data --lc_messages_dir=/usr/local/src/mysql/share --lc_messages=en_US</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥çœ‹rootçš„éšæœºå¯†ç </span></span><br><span class="line">cat /var/log/mysqld.log</span><br><span class="line"></span><br><span class="line"><span class="comment">#root@local: XXXXX   XXXXXå°±æ˜¯åˆå§‹å¯†ç </span></span><br></pre></td></tr></table></figure>
<p>bash_profile åœ¨ ~ /ä¸­</p>
<p>==<strong>å¯åŠ¨æ•°æ®åº“</strong>==</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æºç›®å½•å¯åŠ¨ï¼š</span></span><br><span class="line">/usr/local/src/mysql/support-files/mysql.server start</span><br></pre></td></tr></table></figure>
<p>è®¾ç½®å¼€æœºè‡ªåŠ¨å¯åŠ¨æœåŠ¡</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¤åˆ¶å¯åŠ¨è„šæœ¬åˆ°èµ„æºç›®å½•</span></span><br><span class="line">cp /usr/local/src/mysql/support-files/mysql.server /etc/rc.d/init.d/mysqld</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¢åŠ mysqldæœåŠ¡æ§åˆ¶è„šæœ¬æ‰§è¡Œæƒé™</span></span><br><span class="line">chmod +x /etc/rc.d/init.d/mysqld</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†mysqldæœåŠ¡åŠ å…¥åˆ°ç³»ç»ŸæœåŠ¡</span></span><br><span class="line">chkconfig --add mysqld</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥mysqldæœåŠ¡æ˜¯å¦å·²ç»ç”Ÿæ•ˆ</span></span><br><span class="line">chkconfig --<span class="built_in">list</span> mysqld</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ‡æ¢è‡³mysqlç”¨æˆ·ï¼Œå¯åŠ¨mysqlï¼Œæˆ–è€…ç¨åä¸‹ä¸€æ­¥å†å¯åŠ¨ã€‚</span></span><br><span class="line">su mysql</span><br><span class="line"></span><br><span class="line">service mysqld start </span><br></pre></td></tr></table></figure>
<p>==<strong>é…ç½®ç¯å¢ƒå˜é‡</strong>==</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ‡æ¢è‡³mysqlç”¨æˆ·</span></span><br><span class="line">su mysql</span><br><span class="line"></span><br><span class="line">vi .bash_profile</span><br><span class="line"><span class="comment"># ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå¢åŠ export PATH=$PATH:/usr/local/src/mysql/bin</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç«‹å³ç”Ÿæ•ˆ</span></span><br><span class="line">source .bash_profile</span><br></pre></td></tr></table></figure>
<p>==<strong>ç™»å½•ï¼Œä¿®æ”¹å¯†ç </strong>==</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç³»ç»Ÿé»˜è®¤ä¼šæŸ¥æ‰¾/usr/binä¸‹çš„å‘½ä»¤;å»ºç«‹ä¸€ä¸ªé“¾æ¥æ–‡ä»¶ã€‚</span></span><br><span class="line">ln -s /usr/local/usr/mysql/<span class="built_in">bin</span>/mysql /usr/<span class="built_in">bin</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç™»é™†mysqlçš„rootç”¨æˆ·</span></span><br><span class="line">mysql -uroot -p</span><br><span class="line"><span class="comment"># è¾“å…¥2.4ç”Ÿæˆçš„ éšæœºå¯†ç </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹rootç”¨æˆ·å¯†ç ä¸º123456</span></span><br><span class="line"><span class="built_in">set</span> password <span class="keyword">for</span> root@localhost=password(<span class="string">&quot;123456&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç»™æƒé™,ä½¿ç”¨æˆ·å¯ä»¥è¿œç¨‹ç™»å½•</span></span><br><span class="line">mysql&gt;grant <span class="built_in">all</span> privileges on *.* to <span class="string">&#x27;æ–°ç”¨æˆ·å&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified by <span class="string">&#x27;æ–°å¯†ç &#x27;</span>;</span><br><span class="line"></span><br><span class="line">mysql&gt;flush privileges;</span><br></pre></td></tr></table></figure>
<h2 id="Hiveå®‰è£…">Hiveå®‰è£…</h2>
<p>1ï¼‰è§£å‹</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf /opt/softwares/apache-hive-3.1.2-bin.tar.gz  -C /opt/module</span><br></pre></td></tr></table></figure>
<p>2ï¼‰é…ç¯å¢ƒå˜é‡</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export HIVE_HOME=/opt/module/hive</span><br><span class="line">export PATH=$PATH:$HIVE_HOME/bin</span><br><span class="line">export HADOOP_CLASSPATH=&#x27;hadoop classpath&#x27;</span><br></pre></td></tr></table></figure>
<p>3ï¼‰ä¿®æ”¹é…ç½®æ–‡ä»¶</p>
<p><a target="_blank" rel="noopener" href="http://hive-env.sh">hive-env.sh</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/opt/module/jdk1.8</span><br><span class="line">export HIVE_HOME=/opt/module/hive</span><br><span class="line">export HADOOP_HOME=/opt/module/hadoop-3.1.3</span><br><span class="line">export HIVE_CONF_DIR=/opt/module/hive/conf</span><br></pre></td></tr></table></figure>
<p>hive-site.xmlï¼ˆå¯å»hive/hcatalog/etc/hcatalog/ç›®å½•ä¸‹æŠŠproto-hive-site.xmlå¤åˆ¶åˆ°confç›®å½•ä¸‹å¹¶æ”¹åä¸ºhive-site.xmlï¼Œåˆ é™¤ç¬¬ä¸€ä¸ªpropertyä¹‹é—´çš„å’Œé™¤è¿™å››ä¸ªä»¥å¤–çš„ï¼‰</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">           &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;</span><br><span class="line">           &lt;value&gt;jdbc:mysql://master:3306/hive_db?createDatabaseIfNotExist=true&amp;amp;useSSL=false&lt;/value&gt;</span><br><span class="line">   &lt;/property&gt;</span><br><span class="line">   &lt;property&gt;</span><br><span class="line">           &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;</span><br><span class="line">           &lt;value&gt;root(åå­—çœ‹é¢˜ç›®è¦æ±‚)&lt;/value&gt;</span><br><span class="line">   &lt;/property&gt;</span><br><span class="line">   &lt;property&gt;</span><br><span class="line">           &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;</span><br><span class="line">           &lt;value&gt;000000(å¯†ç çœ‹é¢˜ç›®è¦æ±‚)&lt;/value&gt;</span><br><span class="line">   &lt;/property&gt;</span><br><span class="line">   &lt;property&gt;</span><br><span class="line">           &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;</span><br><span class="line">           &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;</span><br><span class="line">   &lt;/property&gt;</span><br><span class="line">   &lt;!--cli æ˜¾ç¤ºè¡¨å¤´å’Œåˆ—å--&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">	&lt;name&gt;hive.cli.print.header&lt;/name&gt;</span><br><span class="line">	&lt;value&gt;true&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">	&lt;name&gt;hive.cli.print.current.db&lt;/name&gt;</span><br><span class="line">	&lt;value&gt;true&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure>
<p>4ï¼‰æ‹·è´jaråŒ…</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cp mysql-connector-java-5.1.37-bin.jar  /opt/module/hive/lib</span><br><span class="line">rm -rf /opt/module/hive/lib/guave-19.0.jar</span><br><span class="line">cp /opt/module/hadoop-3.1.3/share/hadoop/commond/lib/guava-27.0-jre.jar /opt/module/hive/lib</span><br></pre></td></tr></table></figure>
<p>5ï¼‰åˆå§‹åŒ–</p>
<p>åœ¨srcä¸‹</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schematool -dbType mysql -initSchema</span><br></pre></td></tr></table></figure>
<p>6ï¼‰æŸ¥çœ‹</p>
<p>è¾“å…¥hiveï¼Œå‡ºç°hive&gt;</p>
<p>7ï¼‰é€€å‡º exitï¼›</p>
<ul>
<li>
<p>ç™»å½•</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>æ›´æ”¹å¯†ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter user &#x27;root&#x27;@&#x27;localhost&#x27; identified by &#x27;root&#x27;;</span><br><span class="line">set password for &#x27;root&#x27;@&#x27;localhost&#x27;=&#x27;123456&#x27;;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>å¼€å¯è¿œç¨‹ç™»å½•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">grant all privileges on *.* to &#x27;root&#x27;@&#x27;%&#x27; identified by &#x27;root&#x27; with grant option;</span><br><span class="line"></span><br><span class="line">åˆ·æ–°</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>3ã€é…ç½®hive</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é…ç½® conf/hive-env.shæ–‡ä»¶ä¸­çš„ HADOOP_HOME</span><br><span class="line">export HADOOP_HOME=/usr/local/hadoop/</span><br></pre></td></tr></table></figure>
<p>4.å¯¼å…¥jaråŒ… å’Œ ç§»é™¤jaråŒ…</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å°† mysql-connector-java-5.1.47.jar æ·»åŠ åˆ°hive lib ä¸‹</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/hive/lib/</span><br><span class="line">/usr/local/hadoop/share/hadoop/common/lib/</span><br><span class="line">åˆ é™¤ä½ç‰ˆæœ¬çš„jaråŒ…ï¼Œå°†é«˜ç‰ˆæœ¬çš„jaråŒ…å¤åˆ¶åˆ°åŸæ¥ä½ç‰ˆæœ¬çš„ä½ç½®å³å¯</span><br></pre></td></tr></table></figure>
<p>5.ä¿®æ”¹hive-site.xmlé…ç½®æ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--éœ€è¦ç™»å½•MySQLæ•°æ®åº“ï¼Œåˆ›å»ºä¸€ä¸ª hive æ•°æ®åº“å¤‡ç”¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://mater:3306/hive?</span><br><span class="line">createDatabaseIfNotExist=true<span class="symbol">&amp;amp;</span>useSSL=false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å®‰è£…MySQLæ•°æ®åº“çš„é©±åŠ¨ç±»--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å®‰è£…MySQLæ•°æ®åº“çš„åç§°--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å®‰è£…MySQLæ•°æ®åº“çš„å¯†ç --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="Hiveä½¿ç”¨">Hiveä½¿ç”¨</h2>
<p>==1ã€<strong>å¤–éƒ¨è¡¨</strong>==</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">EXTERNAL</span> <span class="keyword">TABLE</span> t1 (</span><br><span class="line">  cust_id STRING,</span><br><span class="line">  fname STRING,</span><br><span class="line">  lname STRING,</span><br><span class="line">  email STRING,</span><br><span class="line">  level STRING,</span><br><span class="line">  phone MAP<span class="operator">&lt;</span>STRING, STRING<span class="operator">&gt;</span>,</span><br><span class="line">  order_ids <span class="keyword">ARRAY</span><span class="operator">&lt;</span>STRING<span class="operator">&gt;</span>,</span><br><span class="line">  order_value STRUCT<span class="operator">&lt;</span>min: STRING, max: STRING, avg: STRING, total: STRING<span class="operator">&gt;</span></span><br><span class="line">)</span><br><span class="line"><span class="type">row</span> format delimited</span><br><span class="line">fields terminated <span class="keyword">by</span> <span class="string">&#x27;|&#x27;</span></span><br><span class="line">collection items terminated <span class="keyword">by</span> <span class="string">&#x27;,&#x27;</span></span><br><span class="line">map keys terminated <span class="keyword">by</span> <span class="string">&#x27;:&#x27;</span></span><br><span class="line">location <span class="string">&#x27;/yyh&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">EXTERNAL</span> <span class="keyword">TABLE</span> t1 (</span><br><span class="line"> cust_id STRING,</span><br><span class="line"> fname STRING,</span><br><span class="line"> lname STRING,</span><br><span class="line"> email STRING,</span><br><span class="line"> level STRING,</span><br><span class="line"> phone MAP<span class="operator">&lt;</span>STRING, STRING<span class="operator">&gt;</span>,</span><br><span class="line"> order_ids <span class="keyword">ARRAY</span><span class="operator">&lt;</span>STRING<span class="operator">&gt;</span>,</span><br><span class="line"> order_value STRUCT<span class="operator">&lt;</span>min: <span class="keyword">DOUBLE</span>, max: <span class="keyword">DOUBLE</span>, avg: <span class="keyword">DOUBLE</span>, total: <span class="keyword">DOUBLE</span><span class="operator">&gt;</span>)</span><br><span class="line"><span class="type">row</span> format delimited</span><br><span class="line">fields terminated <span class="keyword">by</span> <span class="string">&#x27;|&#x27;</span></span><br><span class="line">collection items terminated <span class="keyword">by</span> <span class="string">&#x27;,&#x27;</span></span><br><span class="line">map keys terminated <span class="keyword">by</span> <span class="string">&#x27;:&#x27;</span></span><br><span class="line">location <span class="string">&#x27;/yyh&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">EXTERNAL</span> <span class="keyword">TABLE</span> t5 (</span><br><span class="line"> cust_id STRING,</span><br><span class="line"> fname STRING,</span><br><span class="line"> lname STRING,</span><br><span class="line"> email STRING,</span><br><span class="line"> level STRING,</span><br><span class="line"> phone MAP<span class="operator">&lt;</span>STRING, STRING<span class="operator">&gt;</span>,</span><br><span class="line"> order_ids <span class="keyword">ARRAY</span><span class="operator">&lt;</span>STRING<span class="operator">&gt;</span>,</span><br><span class="line"> order_value STRUCT<span class="operator">&lt;</span>min: <span class="keyword">DOUBLE</span>, max: <span class="keyword">DOUBLE</span>, avg: <span class="keyword">DOUBLE</span>, total: <span class="keyword">DOUBLE</span><span class="operator">&gt;</span>)</span><br><span class="line"><span class="type">row</span> format delimited</span><br><span class="line">fields terminated <span class="keyword">by</span> <span class="string">&#x27;|&#x27;</span></span><br><span class="line">collection items terminated <span class="keyword">by</span> <span class="string">&#x27;,&#x27;</span></span><br><span class="line">map keys terminated <span class="keyword">by</span> <span class="string">&#x27;#&#x27;</span></span><br><span class="line">location <span class="string">&#x27;/yyh&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- å¯¹ä¸Šæ­¥ä»»åŠ¡åˆ›å»ºçš„æ–°è¡¨loyalty_programå®ç°ä»¥ä¸‹è¦æ±‚çš„ç®€å•æŸ¥è¯¢ï¼š</span></span><br><span class="line"><span class="comment">-- è¿è¡ŒæŸ¥è¯¢ä»¥é€‰æ‹©å®¢æˆ·ID1200866çš„HOMEç”µè¯å·ç ã€‚å¹¶è®°å½•ç»“æœåˆ° master èŠ‚ç‚¹ä¸Š ec2-user ç”¨æˆ·ä¸‹çš„~/results/task4-2.txtæ–‡ä»¶ä¸­ã€‚ï¼ˆ1åˆ†ï¼‰</span></span><br><span class="line"><span class="keyword">INSERT</span> OVERWRITE <span class="keyword">LOCAL</span> DIRECTORY <span class="string">&#x27;/home/ec2-user/results&#x27;</span></span><br><span class="line"><span class="type">ROW</span> FORMAT DELIMITED</span><br><span class="line">FIELDS TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;,&#x27;</span></span><br><span class="line"><span class="keyword">SELECT</span> phone[<span class="string">&#x27;HOME&#x27;</span>] <span class="keyword">FROM</span> loyalty_program <span class="keyword">WHERE</span> cust_id <span class="operator">=</span> <span class="string">&#x27;1200866&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢å®¢æˆ·ID1200866çš„HOMEç”µè¯å·ç </span></span><br><span class="line"><span class="keyword">SELECT</span> phone[<span class="string">&#x27;HOME&#x27;</span>] <span class="keyword">FROM</span> loyalty_program <span class="keyword">WHERE</span> cust_id <span class="operator">=</span> <span class="string">&#x27;1200866&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä»order_idsæ•°ç»„ä¸­ä¸ºå®¢æˆ·ID1200866é€‰æ‹©ç¬¬ä¸‰ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="keyword">SELECT</span> order_ids[<span class="number">2</span>] <span class="keyword">FROM</span> loyalty_program <span class="keyword">WHERE</span> cust_id <span class="operator">=</span> <span class="string">&#x27;1200866&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä»order_valueç»“æ„ä¸­ä¸ºå®¢æˆ·ID1200866é€‰æ‹©totalå±æ€§</span></span><br><span class="line"><span class="keyword">SELECT</span> order_value.total <span class="keyword">FROM</span> loyalty_program <span class="keyword">WHERE</span> cust_id <span class="operator">=</span> <span class="string">&#x27;1200866&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>==<strong>åˆ†ææ•°å€¼äº§å“è¯„åˆ†</strong>==</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- å®¢æˆ·è¯„ä»·å’Œåé¦ˆæ˜¯å®¢æˆ·å’Œåƒ Dualcore çš„é›¶å”®å•†çš„é‡è¦ä¿¡æ¯æ¥æºã€‚æˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°å®¢æˆ·æœ€å–œæ¬¢çš„äº§å“ï¼Œä½†å¿…é¡»é˜²æ­¢è¯„çº§å¾ˆå°‘çš„äº§å“è¯¯å¯¼ã€‚</span></span><br><span class="line"><span class="comment">-- æ¢æŸ¥ Hive ä¸­çš„ratingsè¡¨ä¸­æ•°æ®ï¼ŒæŸ¥è¯¢æ‰€æœ‰å…·æœ‰è‡³å°‘50ä¸ªè¯„çº§çš„äº§å“ä¸­è¯„åˆ†å¹³å‡å€¼æœ€é«˜çš„äº§å“ï¼Ÿå¹¶è®°å½•prod_id(äº§å“ID)ç»“æœåˆ° master -- èŠ‚ç‚¹ä¸Š ec2-user ç”¨æˆ·ä¸‹çš„~/results/task4-3.txtæ–‡ä»¶ä¸­ã€‚ï¼ˆ2åˆ†ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> prod_id</span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">  <span class="keyword">SELECT</span> prod_id, <span class="built_in">AVG</span>(rating) <span class="keyword">AS</span> avg_rating, <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> rating_count</span><br><span class="line">  <span class="keyword">FROM</span> ratings</span><br><span class="line">  <span class="keyword">GROUP</span> <span class="keyword">BY</span> prod_id</span><br><span class="line">  <span class="keyword">HAVING</span> rating_count <span class="operator">&gt;=</span> <span class="number">50</span></span><br><span class="line">) t</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> avg_rating <span class="keyword">DESC</span></span><br><span class="line">LIMIT <span class="number">1</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="Sqoopå®‰è£…ä¸ä½¿ç”¨">Sqoopå®‰è£…ä¸ä½¿ç”¨</h2>
<p>==1ã€<strong>ä¸Šä¼ å®‰è£…åŒ…ã€è§£å‹</strong>==</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf sqoop-1.4.7.bin__hadoop-2.6.0.tar.gz</span><br><span class="line"></span><br><span class="line">mv sqoop-1.4.7.bin__hadoop-2.6.0 sqoop</span><br></pre></td></tr></table></figure>
<p>==2ã€<strong>æ‹·è´jaråŒ…ï¼ŒMySQLï¼Œhive</strong>==</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp mysql-connector-java-5.1.46.jar hive-exec-2.3.3.jar /opt/softwore/sqoop/lib</span><br></pre></td></tr></table></figure>
<p>==3ã€<strong>é…ç½®ç¯å¢ƒå˜é‡</strong>==</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vim <span class="operator">/</span>etc<span class="operator">/</span>profile</span><br><span class="line">## SQOOP_HOME</span><br><span class="line">export SQOOP_HOME<span class="operator">=</span><span class="operator">/</span>opt<span class="operator">/</span>softwore<span class="operator">/</span>sqoop</span><br><span class="line">export PATH<span class="operator">=</span>$PATH:$SQOOP_HOME<span class="operator">/</span>bin</span><br><span class="line">source <span class="operator">/</span>etc<span class="operator">/</span>profile</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>==4ã€<strong>ä¿®æ”¹é…ç½® æ–‡ä»¶</strong>==</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cp sqoop-env-template.sh sqoop-env.sh</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹ä»¥ä¸‹å†…å®¹</span><br><span class="line">export HADOOP_COMMON_HOME=/opt/softwore/hadoop</span><br><span class="line">export HADOOP_MAPRED_HOME=/opt/softwore/hadoop</span><br><span class="line">export HIVE_HOME=/opt/softwore/hive</span><br></pre></td></tr></table></figure>
<p>==5ã€<strong>æµ‹è¯•ç¯å¢ƒ</strong>==</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqoop <span class="built_in">version</span></span><br></pre></td></tr></table></figure>
<p>==6ã€<strong>åˆ—å‡ºæ•°æ®åº“</strong>==</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqoop list<span class="operator">-</span>databases \</span><br><span class="line"><span class="comment">--connect jdbc:mysql://master:3306/ \</span></span><br><span class="line"><span class="comment">--username root --password 123456</span></span><br></pre></td></tr></table></figure>
<p>==7ã€<strong>æŸ¥è¯¢SQL</strong>==</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sqoop eval \</span><br><span class="line">--connect jdbc:mysql://master:3306/yyh \</span><br><span class="line">--username root --password 123456 \</span><br><span class="line">--query &#x27;select count(distinct(name)) from t1&#x27;</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">~/results/task3-1.txt</span></span><br></pre></td></tr></table></figure>
<p>==8ã€<strong>sqoopå¯¼å…¥</strong>==</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">MYSQLå¯¼å…¥åˆ°HDFS</span></span><br><span class="line">sqoop import \</span><br><span class="line">--connect jdbc:mysql://master:3306/yyh \</span><br><span class="line">--username root \</span><br><span class="line">--password 123456 \</span><br><span class="line">--table t1 \</span><br><span class="line">--fields-terminated-by &#x27;,&#x27; \</span><br><span class="line">--lines-terminated-by &#x27;\n&#x27; \</span><br><span class="line">--target-dir &#x27;/sqoop/t1&#x27; \</span><br><span class="line">-m 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">MYSQLå¯¼å…¥åˆ°Hive</span></span><br><span class="line">sqoop import \</span><br><span class="line">--connect jdbc:mysql://master:3306/yyh \</span><br><span class="line">--username root \</span><br><span class="line">--password 123456 \</span><br><span class="line">--table t1 \</span><br><span class="line">--fields-terminated-by &#x27;,&#x27; \</span><br><span class="line">--lines-terminated-by &#x27;\n&#x27; \</span><br><span class="line">--target-dir &#x27;/sqoop/t111&#x27; \</span><br><span class="line">--delete-target-dir \</span><br><span class="line">--hive-import \</span><br><span class="line">--hive-table &#x27;yyh.t111&#x27; \</span><br><span class="line">-m 1</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>==9ã€<strong>sqoopå¯¼å‡º</strong>==</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">HDFSå¯¼å‡ºåˆ°MYSQL</span></span><br><span class="line">sqoop export \</span><br><span class="line">--connect jdbc:mysql://master:3306/yyh \</span><br><span class="line">--username root \</span><br><span class="line">--password 123456 \</span><br><span class="line">--table t1 \</span><br><span class="line">--export-dir &#x27;/sqoop/t1/*&#x27; \</span><br><span class="line">--fields-terminated-by &#x27;,&#x27; \</span><br><span class="line">--lines-terminated-by &#x27;\n&#x27; \</span><br><span class="line">-m 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Hiveå¯¼å‡ºåˆ°MYSQL</span></span><br><span class="line">sqoop export \</span><br><span class="line">--connect jdbc:mysql://master:3306/yyh \</span><br><span class="line">--username root \</span><br><span class="line">--password 123456 \</span><br><span class="line">--table t111 \</span><br><span class="line">--export-dir &#x27;/user/hive/warehouse/yyh.db/t11/*&#x27; \</span><br><span class="line">-m 1</span><br></pre></td></tr></table></figure>
<p>==<strong>æŠ¥é”™</strong>==</p>
<ul>
<li>mapreduceå¯åŠ¨å¤±è´¥</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@master txt]# hadoop classpath</span><br><span class="line">/opt/softwore/hadoop/etc/hadoop:/opt/softwore/hadoop/share/hadoop/common/lib/*:/opt/softwore/hadoop/share/hadoop/common/*:/opt/softwore/hadoop/share/hadoop/hdfs:/opt/softwore/hadoop/share/hadoop/hdfs/lib/*:/opt/softwore/hadoop/share/hadoop/hdfs/*:/opt/softwore/hadoop/share/hadoop/mapreduce/*:/opt/softwore/hadoop/share/hadoop/yarn:/opt/softwore/hadoop/share/hadoop/yarn/lib/*:/opt/softwore/hadoop/share/hadoop/yarn/*</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹yarn-site.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.application.classpath<span class="tag">&lt;/<span class="name">name</span>&gt;</span>	     			<span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/softwore/hadoop/etc/hadoop:/opt/softwore/hadoop/share/hadoop/common/lib/*:/opt/softwore/hadoop/share/hadoop/common/*:/opt/softwore/hadoop/share/hadoop/hdfs:/opt/softwore/hadoop/share/hadoop/hdfs/lib/*:/opt/softwore/hadoop/share/hadoop/hdfs/*:/opt/softwore/hadoop/share/hadoop/mapreduce/*:/opt/softwore/hadoop/share/hadoop/yarn:/opt/softwore/hadoop/share/hadoop/yarn/lib/*:/opt/softwore/hadoop/share/hadoop/yarn/*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Sparkå®‰è£…">Sparkå®‰è£…</h2>
<p>å®‰è£…å’Œå¯åŠ¨ Spark ç»„ä»¶åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li>è§£å‹ Spark å®‰è£…åŒ…ï¼š åœ¨ master èŠ‚ç‚¹ä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤è§£å‹ Spark å®‰è£…åŒ…ï¼š</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf ~/hadoopæ­å»ºç›¸å…³å®‰è£…åŒ…/spark-2.4.6-bin-hadoop2.7.tgz</span><br></pre></td></tr></table></figure>
<ol>
<li>é…ç½® Spark ç¯å¢ƒå˜é‡ï¼š ç¼–è¾‘ <code>~/.bashrc</code> æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡é…ç½®ï¼š</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export SPARK_HOME=/path/to/spark-2.4.6-bin-hadoop2.7</span><br><span class="line">export PATH=$PATH:$SPARK_HOME/bin</span><br></pre></td></tr></table></figure>
<p>ç„¶åè¿è¡Œä»¥ä¸‹å‘½ä»¤ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure>
<ol>
<li>é…ç½® Spark ä¸»èŠ‚ç‚¹ï¼š åœ¨ Spark å®‰è£…ç›®å½•ä¸­çš„ <code>conf</code> æ–‡ä»¶å¤¹ä¸­ï¼Œå¤åˆ¶ <code>spark-env.sh.template</code> å¹¶å°†å…¶é‡å‘½åä¸º <code>spark-env.sh</code>ï¼š</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /path/to/spark-2.4.6-bin-hadoop2.7/conf</span><br><span class="line">cp spark-env.sh.template spark-env.sh</span><br></pre></td></tr></table></figure>
<p>ç¼–è¾‘ <code>spark-env.sh</code> æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹æ¥é…ç½® Spark ä¸»èŠ‚ç‚¹ï¼ˆmasterï¼‰ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export SPARK_MASTER_HOST=master_node_hostname</span><br><span class="line">export SPARK_MASTER_PORT=7077</span><br><span class="line">export SPARK_MASTER_WEBUI_PORT=8080</span><br></pre></td></tr></table></figure>
<p>å°† <code>master_node_hostname</code> æ›¿æ¢ä¸º master èŠ‚ç‚¹çš„ä¸»æœºåæˆ– IP åœ°å€ã€‚</p>
<ol>
<li>é…ç½® Spark å·¥ä½œèŠ‚ç‚¹ï¼š åœ¨ Spark å®‰è£…ç›®å½•ä¸­çš„ <code>conf</code> æ–‡ä»¶å¤¹ä¸­ï¼Œå¤åˆ¶ <code>slaves.template</code> å¹¶å°†å…¶é‡å‘½åä¸º <code>slaves</code>ï¼š</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /path/to/spark-2.4.6-bin-hadoop2.7/conf</span><br><span class="line">cp slaves.template slaves</span><br></pre></td></tr></table></figure>
<p>ç¼–è¾‘ <code>slaves</code> æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹æ¥é…ç½® Spark å·¥ä½œèŠ‚ç‚¹ï¼ˆworkerï¼‰ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node1</span><br><span class="line">node2</span><br></pre></td></tr></table></figure>
<p>å°† <code>node1</code> å’Œ <code>node2</code> æ›¿æ¢ä¸ºå®é™…çš„å·¥ä½œèŠ‚ç‚¹ä¸»æœºåæˆ– IP åœ°å€ã€‚</p>
<ol>
<li>å¯åŠ¨ Spark ä¸»èŠ‚ç‚¹å’Œå·¥ä½œèŠ‚ç‚¹ï¼š åœ¨ master èŠ‚ç‚¹ä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨ Spark ä¸»èŠ‚ç‚¹ï¼ˆMasterï¼‰ï¼š</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/path/to/spark-2.4.6-bin-hadoop2.7/sbin/start-master.sh</span><br></pre></td></tr></table></figure>
<p>ç„¶åï¼Œåœ¨æ¯ä¸ªå·¥ä½œèŠ‚ç‚¹ï¼ˆnode1 å’Œ node2ï¼‰ä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨ Spark å·¥ä½œèŠ‚ç‚¹ï¼ˆWorkerï¼‰ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/path/to/spark-2.4.6-bin-hadoop2.7/sbin/start-slave.sh spark://master_node_hostname:7077</span><br></pre></td></tr></table></figure>
<p>å°† <code>master_node_hostname</code> æ›¿æ¢ä¸ºå®é™…çš„ master èŠ‚ç‚¹ä¸»æœºåæˆ– IP åœ°å€ã€‚</p>
<ol>
<li>éªŒè¯ Spark å¯åŠ¨ï¼š åœ¨æµè§ˆå™¨ä¸­è®¿é—® Spark ä¸»èŠ‚ç‚¹çš„ Web UIï¼Œåœ°å€ä¸º <code>http://master_node_hostname:8080</code>ï¼Œç¡®ä¿ Spark ä¸»èŠ‚ç‚¹å’Œå·¥ä½œèŠ‚ç‚¹éƒ½å·²æˆåŠŸå¯åŠ¨ï¼Œå¹¶æŸ¥çœ‹é›†ç¾¤çš„çŠ¶æ€ã€‚</li>
</ol>
<p>å®Œæˆä¸Šè¿°æ­¥éª¤åï¼ŒSpark ç»„ä»¶å°†å®‰è£…åœ¨ master èŠ‚ç‚¹å’Œä¸¤ä¸ªå·¥ä½œèŠ‚ç‚¹ä¸Šï¼Œå¹¶ä¸” Spark é›†ç¾¤å·²ç»å¯åŠ¨ï¼ŒåŒ…å«ä¸€ä¸ªä¸»èŠ‚ç‚¹ï¼ˆMasterï¼‰å’Œä¸¤ä¸ªå·¥ä½œèŠ‚ç‚¹ï¼ˆWorkerï¼‰ã€‚ä½ å¯ä»¥é€šè¿‡ Web UI æ¥ç›‘æ§å’Œç®¡ç† Spark é›†ç¾¤ï¼Œå¹¶åœ¨ Spark Shell ä¸­æ‰§è¡Œ Spark ä»»åŠ¡ã€‚</p>
<p>==1ã€<strong>ä¿®æ”¹Hadoopé…ç½®æ–‡ä»¶yarn-site.xml</strong>==</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ˜¯å¦å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ£€æŸ¥æ¯ä¸ªä»»åŠ¡æ­£ä½¿ç”¨çš„ç‰©ç†å†…å­˜é‡ï¼Œå¦‚æœä»»åŠ¡è¶…å‡ºåˆ†é…å€¼ï¼Œåˆ™ç›´æ¥å°†å…¶æ€æ‰ï¼Œé»˜è®¤æ˜¯true --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.pmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--æ˜¯å¦å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ£€æŸ¥æ¯ä¸ªä»»åŠ¡æ­£ä½¿ç”¨çš„è™šæ‹Ÿå†…å­˜é‡ï¼Œå¦‚æœä»»åŠ¡è¶…å‡ºåˆ†é…å€¼ï¼Œåˆ™ç›´æ¥å°†å…¶æ€æ‰ï¼Œé»˜è®¤æ˜¯true--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.vmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>==2ã€<strong>è§£å‹å®‰è£…åŒ…ã€é…ç½®</strong>==</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">è§£å‹sparkï¼Œå¹¶é‡å‘½åä¸ºspark-yarn</span><br><span class="line">tar -zxvf spark-2.4.7-bin-hadoop2.7.tgz</span><br><span class="line">mv spark-2.4.7-bin-hadoop2.7 spark-yarn</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹spark-env.shæ–‡ä»¶ï¼Œæ·»åŠ javaç¯å¢ƒå’Œyarné…ç½®åœ°å€</span><br><span class="line">cp spark-env.sh.template spark-env.sh</span><br><span class="line">vim spark-env.sh</span><br><span class="line"></span><br><span class="line">æ·»åŠ å†…å®¹</span><br><span class="line">export JAVA_HOME=/opt/softwore/jdk8</span><br><span class="line">export HADOOP_HOME=/opt/softwore/hadoop</span><br><span class="line">export HADOOP_CONF_DIR=/opt/softwore/hadoop/etc/hadoop</span><br><span class="line">export LD_LIBRARY_PATH=/opt/softwore/hadoop/lib/native</span><br><span class="line">export SPARK_MASTER_IP=master</span><br><span class="line">export SPARK_LOCAL_DIRS=/opt/softwore/src/spark/tmp</span><br><span class="line">export SPARK_LOG_DIR=/opt/softwore/spark/logs</span><br><span class="line">export SPARK_MASTER_PORT=7077</span><br><span class="line">export SPARK_DRIVER_MEMORY=512M</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹slavesæ–‡ä»¶</span><br><span class="line">cp slaves.template slaves</span><br><span class="line">vim slaves</span><br><span class="line">node01</span><br><span class="line">node02</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹ç¯å¢ƒå˜é‡</span><br><span class="line">vim /etc/profile</span><br><span class="line"></span><br><span class="line">## SPARK_ENV</span><br><span class="line">export SPARK_HOME=/usr/local/spark-yarn</span><br><span class="line">export PATH=$PATH:$SPARK_HOME/bin:$SPARK_HOME/sbin</span><br><span class="line"></span><br><span class="line">åˆ·æ–°ï¼Œç”Ÿæ•ˆ</span><br><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>
<p>==3ã€<strong>å¯¼å…¥jaråŒ…</strong>==</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">cp</span> mysql-connector-java-<span class="number">5</span>.<span class="number">1</span>.<span class="number">47</span>.jar /opt/softwore/spark/jars</span><br><span class="line"><span class="attribute">cp</span> hive-common-<span class="number">2</span>.<span class="number">3</span>.<span class="number">1</span>.jar /opt/softwore/spark/jars</span><br></pre></td></tr></table></figure>
<p>==4ã€<strong>ä½¿ç”¨Hive</strong>==</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">spark-shell</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼€å¯å¤šè¡Œä»£ç æ¨¡å¼</span></span><br><span class="line">:paste</span><br><span class="line"></span><br><span class="line">saprk.sql(<span class="string">&quot;select * from yyh.t1&quot;</span>).show()</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…³é—­</span></span><br><span class="line">ctrl + <span class="type">D</span></span><br></pre></td></tr></table></figure>
<h2 id="Sparkä½¿ç”¨">Sparkä½¿ç”¨</h2>
<h4 id="çœèµ›æ ·å·ä¸€">çœèµ›æ ·å·ä¸€</h4>
<blockquote>
<p>ä»»åŠ¡6ï¼šSpark åˆ†å¸ƒå¼è®¡ç®—ï¼ˆ5åˆ†ï¼‰</p>
<p>6.1 è®¡ç®—ä¸é‡å¤çš„ç”µå½±æ•°é‡</p>
<p>6.2 è®¡ç®—ç”µå½±å¹³å‡è¯„åˆ†</p>
<p>6.3 è®¡ç®—ç”¨æˆ·åœ¨å¤œæ™šçš„è¯„åˆ†æ€»è®°å½•æ•°</p>
</blockquote>
<p>==<strong>å®ä¾‹åŒ–å¯¹è±¡</strong>==</p>
<h5 id="6-1-è®¡ç®—ä¸é‡å¤çš„ç”µå½±æ•°é‡">6.1 è®¡ç®—ä¸é‡å¤çš„ç”µå½±æ•°é‡</h5>
<blockquote>
<p>åœ¨masterèŠ‚ç‚¹ä¸Šæ“ä½œï¼Œè¯»å– hdfs ä¸Š/spark/movie_ratings.csvæ•°æ®ï¼Œå¯åŠ¨ spark è®¡ç®—ä¸é‡å¤çš„ç”µå½±ï¼ˆmovieIdï¼‰æ•°é‡ï¼Œå¹¶ä¿å­˜ç»“æœåˆ°~/results/task6-1.txtæ–‡ä»¶ä¸­ã€‚ï¼ˆ1åˆ†ï¼‰</p>
</blockquote>
<p><code>spark-shell</code>è¿˜æ˜¯å…ˆå¼€å¯å¤šè¡Œä»£ç ç¼–è¾‘æ¨¡å¼<code>:paste</code></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; :paste</span><br><span class="line"><span class="comment">// Entering paste mode (ctrl-D to finish)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> data = spark.read</span><br><span class="line">                .option(<span class="string">&quot;header&quot;</span>,<span class="string">&quot;true&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;inferSchema&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">                .format(<span class="string">&quot;csv&quot;</span>)</span><br><span class="line">                .load(<span class="string">&quot;hdfs:///spark/movie_ratings.csv&quot;</span>)</span><br><span class="line">                .createTempView(<span class="string">&quot;t1&quot;</span>)</span><br><span class="line">spark.sql(<span class="string">&quot;select count(distinct(movieId)) from t1&quot;</span>).show()</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> res1 = spark.sql(<span class="string">&quot;select count(distinct(movieId)) from t1&quot;</span>)</span><br><span class="line"><span class="type">Seq</span>(res1.first().toString()).toDF().write.mode(<span class="string">&quot;overwrite&quot;</span>).text(<span class="string">&quot;file:///root/results/task6-2.txt&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Exiting paste mode, now interpreting.</span></span><br><span class="line"></span><br><span class="line">+-----------------------+                                                       </span><br><span class="line">|count(<span class="type">DISTINCT</span> movieId)|</span><br><span class="line">+-----------------------+</span><br><span class="line">|                  <span class="number">14026</span>|</span><br><span class="line">+-----------------------+</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> data: <span class="type">Unit</span> = ()</span><br><span class="line"><span class="keyword">val</span> res1: org.apache.spark.sql.<span class="type">DataFrame</span> = [count(<span class="type">DISTINCT</span> movieId): bigint]</span><br></pre></td></tr></table></figure>
<p>ä¿å­˜æ–‡ä»¶çš„æ—¶å€™é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œå› ä¸ºå‰é¢æˆ‘æ˜¯è®¾ç½®äº†<code>.format(&quot;inferSchema&quot;, &quot;true&quot;)</code>sparkè‡ªåŠ¨è¯†åˆ«å­—æ®µç±»å‹ï¼Œæ‰€ä»¥æœ‰çš„æ•°æ®æ ¼å¼ä¸º<code>Bigint</code>,ä½†æ˜¯å­˜æ–‡ä»¶æ—¶å€™sparkä¸æ”¯æŒç›´æ¥å°†<code>Bigint</code>ç±»å‹è½¬æ¢ä¸ºæ–‡æœ¬æ ¼å¼ï¼Œè¿™é‡Œæƒ³äº†æƒ³åªæ˜¯è¾“å‡ºä¸€ä¸ªçº¯æ–‡æœ¬ç”¨ä¸ç€è¿™ä¹ˆéº»çƒ¦æˆ‘ç›´æ¥å°±å¼ºè½¬äº†ï¼Œä½†æ˜¯è¿™æ ·æ˜¯é”™çš„ä½ å¼ºè½¬çš„åªæ˜¯sqlè¯­å¥ï¼Œæ‰€ä»¥è¿˜æ˜¯éœ€è¦éº»çƒ¦ä¸€ç‚¹è·å–<code>first()</code>å…¶å®æ›´å¥½çš„æ–¹å¼æ˜¯å°†<code>Bigint</code>ç±»å‹è½¬æˆStringï¼Œç„¶åå­˜åˆ°ä¸€ä¸ªSeqä¸­å†è½¬æˆ<code>dataframe</code>æ ¼å¼</p>
<p>è¿˜æœ‰ä¸€ç‚¹å°±æ˜¯ä¿å­˜åˆ°æœ¬åœ°æ˜¯<code>file:///</code></p>
<p><code>Seq</code>æä¾›äº†è®¸å¤šå…¶ä»–çš„æ“ä½œæ–¹æ³•ï¼Œå¦‚<code>head</code>ã€<code>tail</code>ã€<code>isEmpty</code>ã€<code>distinct</code>ç­‰</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>Seq</code>æ˜¯ä¸å¯å˜çš„ï¼Œè¿™æ„å‘³ç€å®ƒçš„å…ƒç´ æ˜¯ä¸å¯å˜çš„ï¼Œä¸€æ—¦åˆ›å»ºï¼Œå°±ä¸èƒ½ä¿®æ”¹ã€‚å¦‚æœä½ éœ€è¦å¯å˜çš„åºåˆ—ï¼Œå¯ä»¥ä½¿ç”¨<code>mutable.Seq</code>ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> from_unixtime(<span class="number">1112484727</span>, <span class="string">&#x27;yyyy-MM-dd HH:mm:ss&#x27;</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> data1_1 = spark.sql(<span class="string">&quot;select cast(count(distinct(movieId)) as string) as number from t1&quot;</span>) data1_1.write.option(<span class="string">&quot;header&quot;</span>,<span class="string">&quot;false&quot;</span>).format(<span class="string">&quot;text&quot;</span>).mode(<span class="string">&quot;overwrite&quot;</span>).save(<span class="string">&quot;file:///root/spark/s1.txt&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="6-2-è®¡ç®—ç”µå½±å¹³å‡è¯„åˆ†">6.2  è®¡ç®—ç”µå½±å¹³å‡è¯„åˆ†</h5>
<blockquote>
<p>åœ¨masterèŠ‚ç‚¹ä¸Šæ“ä½œï¼Œè¯»å– hdfs ä¸Š/spark/movie_ratings.csvæ•°æ®ï¼Œè¿ç”¨ spark è®¡ç®—ç”µå½±å¹³å‡è¯„åˆ†ï¼Œä¿ç•™ä¸¤ä½å°æ•°ï¼Œå¹¶ä¿å­˜ç»“æœåˆ°~/results/task6-2.txtæ–‡ä»¶ä¸­ã€‚(å¹³å‡è¯„åˆ†=æ€»è¯„åˆ†æ•°/æ€»è¯„åˆ†è®°å½•æ•°ï¼‰ï¼ˆ1åˆ†ï¼‰</p>
</blockquote>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> res2 = spark.sql(<span class="string">&quot;select round(avg(rating),2) as avg_rating from t1&quot;</span>)</span><br><span class="line"><span class="type">Seq</span>(res2.first().toString()).toDF().write.mode(<span class="string">&quot;overwrite&quot;</span>).text(<span class="string">&quot;file:///root/results/task6-2.txt&quot;</span>)</span><br></pre></td></tr></table></figure>
<h5 id="6-3-è®¡ç®—ç”¨æˆ·åœ¨å¤œæ™šçš„è¯„åˆ†æ€»è®°å½•æ•°">6.3  è®¡ç®—ç”¨æˆ·åœ¨å¤œæ™šçš„è¯„åˆ†æ€»è®°å½•æ•°</h5>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 6.3 è®¡ç®—ç”¨æˆ·åœ¨å¤œæ™šçš„è¯„åˆ†æ€»è®°å½•æ•°</span></span><br><span class="line"><span class="comment">     * åœ¨masterèŠ‚ç‚¹ä¸Šæ“ä½œï¼Œè¯»å– hdfs ä¸Š/spark/movie_ratings.csvæ•°æ®ï¼Œ</span></span><br><span class="line"><span class="comment">     * æŒ‰ç…§ä»¥ä¸‹è¦æ±‚æŠŠæ¯å¤©çš„è¯„åˆ†æ—¶é—´å­—æ®µåˆ’åˆ†ä¸º morningã€lunchã€afternoonã€eveningã€night äº”ä¸ªæ—¶é—´æ®µï¼Œ</span></span><br><span class="line"><span class="comment">     * å¹¶è¿ç”¨ spark è®¡ç®—ç”¨æˆ·åœ¨å¤œæ™šï¼ˆeveningï¼‰çš„è¯„åˆ†æ€»è®°å½•æ•°ï¼Œå¹¶ä¿å­˜ç»“æœåˆ°~/results/task6-3.txtæ–‡ä»¶ä¸­ã€‚ï¼ˆ3åˆ†ï¼‰</span></span><br><span class="line"><span class="comment">     * è¯„åˆ†æ—¶é—´æˆ³å­—æ®µåˆ†ç±»ï¼ˆä»¥å°æ—¶ä¸ºå•ä½ï¼‰ï¼š</span></span><br><span class="line"><span class="comment">     * â€¢	morningï¼š7~12ï¼ˆåŒ…å«7ç‚¹ï¼Œä¸å«12ç‚¹ï¼‰</span></span><br><span class="line"><span class="comment">     * â€¢	lunchï¼š12~14ï¼ˆåŒ…å«12ç‚¹ï¼Œä¸å«14ç‚¹ï¼‰</span></span><br><span class="line"><span class="comment">     * â€¢	afternoonï¼š14~18ï¼ˆåŒ…å«14ç‚¹ï¼Œä¸å«18ç‚¹ï¼‰</span></span><br><span class="line"><span class="comment">     * â€¢	eveningï¼š18~24ï¼ˆåŒ…å«18ç‚¹ï¼Œä¸å«24ç‚¹ï¼‰</span></span><br><span class="line"><span class="comment">     * â€¢	nightï¼š0~7ï¼ˆåŒ…å«0ç‚¹ï¼Œä¸å«7ç‚¹ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> data = spark.read</span><br><span class="line">      .option(<span class="string">&quot;header&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">      .option(<span class="string">&quot;inferSchema&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">      .csv(<span class="string">&quot;C:\\Users\\beihai\\Desktop\\competition\\movie_ratings.csv&quot;</span>)</span><br><span class="line">      .createTempView(<span class="string">&quot;view1&quot;</span>)</span><br><span class="line"></span><br><span class="line">    spark.sql(</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |with t1 as (</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |       userId,movieId,rating,hour(from_unixtime(timestamp, &#x27;yyyy-MM-dd HH:mm:ss&#x27;)) as hour_time</span></span><br><span class="line"><span class="string">        |from</span></span><br><span class="line"><span class="string">        |       view1</span></span><br><span class="line"><span class="string">        |),</span></span><br><span class="line"><span class="string">        |t2 as (</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |       userId,rating,</span></span><br><span class="line"><span class="string">        |case</span></span><br><span class="line"><span class="string">        |       when hour_time &gt;= 7 and hour_time &lt; 12 then &#x27;morning&#x27;</span></span><br><span class="line"><span class="string">        |       when hour_time &gt;= 12 and hour_time &lt; 14 then &#x27;lunch&#x27;</span></span><br><span class="line"><span class="string">        |       when hour_time &gt;= 14 and hour_time &lt; 18 then &#x27;afternoon&#x27;</span></span><br><span class="line"><span class="string">        |       when hour_time &gt;= 18 and hour_time &lt; 24 then &#x27;evening&#x27;</span></span><br><span class="line"><span class="string">        |       else &#x27;night&#x27;</span></span><br><span class="line"><span class="string">        |end as evening_rating</span></span><br><span class="line"><span class="string">        |from t1</span></span><br><span class="line"><span class="string">        |)</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |userId, sum(rating) as rating</span></span><br><span class="line"><span class="string">        |from t2</span></span><br><span class="line"><span class="string">        |where evening_rating = &#x27;evening&#x27;</span></span><br><span class="line"><span class="string">        |group by userId</span></span><br><span class="line"><span class="string">        |order by userId</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin).show()</span><br><span class="line"></span><br><span class="line">    spark.sql(</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |       userId,sum(rating) as evening_ratings</span></span><br><span class="line"><span class="string">        |from view1</span></span><br><span class="line"><span class="string">        |where</span></span><br><span class="line"><span class="string">        |       hour(from_unixtime(timestamp,&#x27;yyyy-MM-dd HH:mm:ss&#x27;)) &gt;= 18 and hour(from_unixtime(timestamp,&#x27;yyyy-MM-dd HH:mm:ss&#x27;)) &lt; 24</span></span><br><span class="line"><span class="string">        |group by userId</span></span><br><span class="line"><span class="string">        |order by userId</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin).show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.functions._</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯»å– movie_ratings.csv æ•°æ®</span></span><br><span class="line"><span class="keyword">val</span> data = spark.read</span><br><span class="line">  .option(<span class="string">&quot;header&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">  .option(<span class="string">&quot;inferSchema&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">  .csv(<span class="string">&quot;hdfs:///spark/movie_ratings.csv&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†æ—¶é—´æˆ³å­—æ®µè½¬æ¢ä¸ºæ—¶é—´ç±»å‹</span></span><br><span class="line"><span class="keyword">val</span> formattedData = data.withColumn(<span class="string">&quot;timestamp&quot;</span>, to_timestamp(col(<span class="string">&quot;timestamp&quot;</span>), <span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ æ—¶é—´æ®µåˆ—</span></span><br><span class="line"><span class="keyword">val</span> categorizedData = formattedData.withColumn(<span class="string">&quot;time_period&quot;</span>, when(hour(col(<span class="string">&quot;timestamp&quot;</span>)).between(<span class="number">7</span>, <span class="number">11</span>), <span class="string">&quot;morning&quot;</span>)</span><br><span class="line">  .when(hour(col(<span class="string">&quot;timestamp&quot;</span>)).between(<span class="number">12</span>, <span class="number">13</span>), <span class="string">&quot;lunch&quot;</span>)</span><br><span class="line">  .when(hour(col(<span class="string">&quot;timestamp&quot;</span>)).between(<span class="number">14</span>, <span class="number">17</span>), <span class="string">&quot;afternoon&quot;</span>)</span><br><span class="line">  .when(hour(col(<span class="string">&quot;timestamp&quot;</span>)).between(<span class="number">18</span>, <span class="number">23</span>), <span class="string">&quot;evening&quot;</span>)</span><br><span class="line">  .otherwise(<span class="string">&quot;night&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿‡æ»¤å‡ºå¤œæ™šæ—¶é—´æ®µçš„æ•°æ®å¹¶è®¡ç®—è¯„åˆ†æ€»è®°å½•æ•°</span></span><br><span class="line"><span class="keyword">val</span> eveningCount = categorizedData.filter(col(<span class="string">&quot;time_period&quot;</span>) === <span class="string">&quot;evening&quot;</span>).count()</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†ç»“æœä¿å­˜åˆ°æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">val</span> outputPath = <span class="string">&quot;/home/ec2-user/results/task6-3.txt&quot;</span></span><br><span class="line"><span class="keyword">val</span> result = <span class="string">s&quot;Evening rating count: <span class="subst">$eveningCount</span>&quot;</span></span><br><span class="line">spark.sparkContext.parallelize(<span class="type">Seq</span>(result)).saveAsTextFile(outputPath)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">scala&gt; spark.sql(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">     | select</span></span><br><span class="line"><span class="string">     |      userId,count(*) as countt</span></span><br><span class="line"><span class="string">     | from df1</span></span><br><span class="line"><span class="string">     | where hour(from_unixtime(timestamp,&#x27;yyyy-MM-dd HH:mm:ss&#x27;)) &gt;= 18 and</span></span><br><span class="line"><span class="string">     | hour(from_unixtime(timestamp,&#x27;yyyy-MM-dd HH:mm:ss&#x27;)) &lt; 24</span></span><br><span class="line"><span class="string">     | group by userId</span></span><br><span class="line"><span class="string">     | &quot;&quot;&quot;</span>).show()</span><br><span class="line">+------+------+                                                                 </span><br><span class="line">|userId|countt|</span><br><span class="line">+------+------+</span><br><span class="line">|   <span class="number">148</span>|   <span class="number">128</span>|</span><br><span class="line">|   <span class="number">463</span>|    <span class="number">79</span>|</span><br><span class="line">|   <span class="number">471</span>|    <span class="number">31</span>|</span><br><span class="line">|   <span class="number">833</span>|     <span class="number">3</span>|</span><br><span class="line">|  <span class="number">1088</span>|    <span class="number">60</span>|</span><br><span class="line">|  <span class="number">1342</span>|    <span class="number">25</span>|</span><br><span class="line">|  <span class="number">1591</span>|     <span class="number">4</span>|</span><br><span class="line">|  <span class="number">1959</span>|    <span class="number">74</span>|</span><br><span class="line">|  <span class="number">2122</span>|    <span class="number">46</span>|</span><br><span class="line">|   <span class="number">392</span>|    <span class="number">21</span>|</span><br><span class="line">|   <span class="number">540</span>|    <span class="number">10</span>|</span><br><span class="line">|   <span class="number">737</span>|    <span class="number">19</span>|</span><br><span class="line">|   <span class="number">858</span>|    <span class="number">62</span>|</span><br><span class="line">|  <span class="number">1084</span>|    <span class="number">94</span>|</span><br><span class="line">|  <span class="number">1127</span>|    <span class="number">82</span>|</span><br><span class="line">|  <span class="number">1896</span>|   <span class="number">116</span>|</span><br><span class="line">|  <span class="number">1143</span>|    <span class="number">70</span>|</span><br><span class="line">|  <span class="number">1270</span>|    <span class="number">78</span>|</span><br><span class="line">|  <span class="number">1322</span>|   <span class="number">208</span>|</span><br><span class="line">|  <span class="number">1339</span>|   <span class="number">385</span>|</span><br><span class="line">+------+------+</span><br><span class="line">only showing top <span class="number">20</span> rows</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="Flumeå®‰è£…ä¸ä½¿ç”¨">Flumeå®‰è£…ä¸ä½¿ç”¨</h2>
<p>==1ã€<strong>ä¸Šä¼ å®‰è£…åŒ…ï¼Œè§£å‹é…ç½®</strong>==</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">tar <span class="operator">-</span>zxvf apache<span class="operator">-</span>flume<span class="number">-1.9</span><span class="number">.0</span><span class="operator">-</span>bin.tar.gz</span><br><span class="line">mv apache<span class="operator">-</span>flume<span class="number">-1.8</span><span class="number">.0</span><span class="operator">-</span>bin flume</span><br><span class="line">ä¿®æ”¹é…ç½®æ–‡ä»¶</span><br><span class="line">cp flume<span class="operator">-</span>env.sh.template flume<span class="operator">-</span>env.sh</span><br><span class="line">vim flume<span class="operator">-</span>env.sh</span><br><span class="line">export JAVA_HOME<span class="operator">=</span><span class="operator">/</span>usr<span class="operator">/</span><span class="keyword">local</span><span class="operator">/</span>src<span class="operator">/</span>jdk</span><br><span class="line">é…ç½®ç¯å¢ƒå˜é‡</span><br><span class="line">vim <span class="operator">/</span>etc<span class="operator">/</span>profile</span><br><span class="line"></span><br><span class="line">## FLUME_HOME</span><br><span class="line">export FLUME_HOME<span class="operator">=</span><span class="operator">/</span>usr<span class="operator">/</span><span class="keyword">local</span><span class="operator">/</span>flume</span><br><span class="line">export PATH<span class="operator">=</span>$PATH:$FLUME_HOME<span class="operator">/</span>bin</span><br><span class="line">æµ‹è¯• Flume ç¯å¢ƒé…ç½®</span><br><span class="line">flume<span class="operator">-</span>ng version</span><br></pre></td></tr></table></figure>
<p>==2ã€<strong>Flume å…¥é—¨æ¡ˆä¾‹</strong>==</p>
<ul>
<li>
<p>é‡‡é›†éœ€æ±‚ï¼šç›‘æ§æœ¬åœ°æŒ‡å®šç«¯å£ï¼ˆ44444)ï¼Œé‡‡é›†æ•°æ®åˆ°æ§åˆ¶å°æ—¥å¿—æ˜¾ç¤º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># example.conf</span><br><span class="line"></span><br><span class="line"># å®šä¹‰Agentçš„åç§°ã€Sourceã€Channelã€Sinkçš„åç§°</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1</span><br><span class="line">a1.channels = c1</span><br><span class="line"></span><br><span class="line"># é…ç½® Source ç»„ä»¶å±æ€§</span><br><span class="line">a1.sources.r1.type = netcat</span><br><span class="line">a1.sources.r1.bind = localhost</span><br><span class="line">a1.sources.r1.port = 44444</span><br><span class="line"></span><br><span class="line"># é…ç½® Channel ç»„ä»¶å±æ€§</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line"># å†…å­˜æœ€å¤§å­˜å‚¨çš„ event æ•°é‡</span><br><span class="line">a1.channels.c1.capacity = 10000</span><br><span class="line"># æ¯æ¬¡æœ€å¤§ä»sourceä¸­æ‹¿åˆ°sinkä¸­çš„eventæ•°é‡</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line"># é…ç½® Sink ç»„ä»¶å±æ€§</span><br><span class="line">a1.sinks.k1.type = logger</span><br><span class="line"></span><br><span class="line"># å°†æºå’Œæ¥æ”¶å™¨ç»‘å®šåˆ°é€šé“</span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line">a1.sinks.k1.channel = c1</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">flume<span class="operator">-</span>ng agent <span class="comment">--name a1 --conf $FLUME_HOME/conf --conf-file $FLUME_HOME/conf/example.conf</span></span><br><span class="line"><span class="operator">-</span>Dflume.root.logger<span class="operator">=</span>INFO,console</span><br><span class="line"></span><br><span class="line"><span class="operator">-</span>n <span class="operator">-</span>c <span class="operator">-</span>f </span><br></pre></td></tr></table></figure>
<p>æœ¬åœ°ç›‘æ§éœ€è¦å®‰è£…</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc localhost <span class="number">44444</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>ç›‘æ§æŒ‡å®šç›®å½•é‡‡é›†æ•°æ®ä¿å­˜åˆ°HDFS</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">a1è¡¨ç¤ºä»£ç†åç§°</span></span><br><span class="line">a1.sources=s1</span><br><span class="line">a1.sinks=k1</span><br><span class="line">a1.channels=c1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">é…ç½®source1  ç›‘æ§ç›®å½•æ˜¯å¦æœ‰æ–‡ä»¶æ•°æ®ç”Ÿæˆ</span></span><br><span class="line">a1.sources.s1.type=spooldir</span><br><span class="line">a1.sources.s1.spoolDir=/opt/datas/flume/TestDir</span><br><span class="line">a1.sources.s1.channels=c1</span><br><span class="line">a1.sources.s1.fileHeader = false</span><br><span class="line">a1.sources.s1.interceptors = i1</span><br><span class="line">a1.sources.s1.interceptors.i1.type = timestamp</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">é…ç½®sink1  å°†æ£€æµ‹åˆ°çš„æ•°æ®sinkåˆ°hdfsä¸Š</span></span><br><span class="line">a1.sinks.k1.type=hdfs</span><br><span class="line">a1.sinks.k1.hdfs.path=hdfs://bigdata.ibeifeng.com:8020/flume</span><br><span class="line">a1.sinks.k1.hdfs.fileType=DataStream</span><br><span class="line">a1.sinks.k1.hdfs.writeFormat=TEXT</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">600såhdfsä¸Šæ–‡ä»¶æ‰æ²¡æœ‰tmpï¼Œå¦åˆ™æœ‰ï¼Œæœ‰tmpåˆ™ä¸èƒ½çœ‹</span></span><br><span class="line">a1.sinks.k1.hdfs.rollInterval=60</span><br><span class="line">a1.sinks.k1.channel=c1</span><br><span class="line">a1.sinks.k1.hdfs.filePrefix=%Y-%m-%d</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">é€šé“æ˜¯ä»¥å†…å­˜æ–¹å¼å­˜å‚¨</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">é…ç½®channel1</span></span><br><span class="line">a1.channels.c1.type=memory</span><br><span class="line">a1.channels.c1.capacity=10000</span><br><span class="line">a1.channels.c1.transactionCapacity=100</span><br><span class="line"></span><br><span class="line">a1.sources.r1.channels=c1</span><br><span class="line">a1.sinks.k1.channel=c1</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>ç›‘æ§æŒ‡å®šæ–‡ä»¶é‡‡é›†æ•°æ®ä¿å­˜åˆ°HDFS</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a1<span class="selector-class">.sources</span><span class="selector-class">.r1</span>.type=exec</span><br><span class="line">a1<span class="selector-class">.sources</span><span class="selector-class">.r1</span>.command=tail -F /opt/data/t1<span class="selector-class">.txt</span></span><br><span class="line"></span><br><span class="line">a1<span class="selector-class">.sinks</span><span class="selector-class">.k1</span><span class="selector-class">.hdfs</span>.path= hdfs:<span class="comment">//master:8020/flume/%Y-%m-%d/%H</span></span><br><span class="line">a1<span class="selector-class">.sinks</span><span class="selector-class">.k1</span><span class="selector-class">.hdfs</span><span class="selector-class">.roundUnit</span> = hour</span><br><span class="line">a1<span class="selector-class">.sinks</span><span class="selector-class">.k1</span><span class="selector-class">.hdfs</span><span class="selector-class">.useLocalTimeStamp</span> = true</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Namenode ç«¯å£:</span><br><span class="line"><span class="number">2.</span>xç«¯å£	<span class="number">3.</span>xç«¯å£	name	<span class="keyword">desc</span></span><br><span class="line"><span class="number">50470</span>	<span class="number">9871</span>	dfs.namenode.https<span class="operator">-</span>address	The namenode secure http server address <span class="keyword">and</span> port.</span><br><span class="line"><span class="number">50070</span>	<span class="number">9870</span>	dfs.namenode.http<span class="operator">-</span>address	The address <span class="keyword">and</span> the base port <span class="keyword">where</span> the dfs namenode web ui will listen on.</span><br><span class="line"><span class="number">8020</span>	<span class="number">9820</span>	fs.defaultFS	æŒ‡å®šHDFSè¿è¡Œæ—¶nameNodeåœ°å€</span><br><span class="line">Secondary NN ç«¯å£:</span><br><span class="line"><span class="number">2.</span>xç«¯å£	<span class="number">3.</span>xç«¯å£	name	<span class="keyword">desc</span></span><br><span class="line"><span class="number">50091</span>	<span class="number">9869</span>	dfs.namenode.secondary.https<span class="operator">-</span>address	The secondary namenode HTTPS server address <span class="keyword">and</span> port</span><br><span class="line"><span class="number">50090</span>	<span class="number">9868</span>	dfs.namenode.secondary.http<span class="operator">-</span>address	The secondary namenode HTTPS server address <span class="keyword">and</span> port</span><br><span class="line">Datanode ç«¯å£:</span><br><span class="line"><span class="number">2.</span>xç«¯å£	<span class="number">3.</span>xç«¯å£	name	<span class="keyword">desc</span></span><br><span class="line"><span class="number">50020</span>	<span class="number">9867</span>	dfs.datanode.ipc.address	The datanode ipc server address <span class="keyword">and</span> port.</span><br><span class="line"><span class="number">50010</span>	<span class="number">9866</span>	dfs.datanode.address	The datanode server address <span class="keyword">and</span> port <span class="keyword">for</span> data transfer.</span><br><span class="line"><span class="number">50475</span>	<span class="number">9865</span>	dfs.datanode.https.address	The datanode secure http server address <span class="keyword">and</span> port</span><br><span class="line"><span class="number">50075</span>	<span class="number">9864</span>	dfs.datanode.http.address	The datanode http server address <span class="keyword">and</span> por</span><br><span class="line">Yarn ç«¯å£</span><br><span class="line"><span class="number">2.</span>xç«¯å£	<span class="number">3.</span>xç«¯å£	name	<span class="keyword">desc</span></span><br><span class="line"><span class="number">8088</span>	<span class="number">8088</span>	yarn.resourcemanager.webapp.address	httpæœåŠ¡ç«¯å£</span><br></pre></td></tr></table></figure>
<h2 id="Linuxæƒé™">Linuxæƒé™</h2>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_63992711/article/details/127042653">https://blog.csdn.net/qq_63992711/article/details/127042653</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rwx rw- r-- è¿™å°±æ˜¯ 111 110 100 æœ€ç»ˆå³ 764 æƒé™ã€‚</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹file.txtæ–‡ä»¶çš„æƒé™åˆ†é…è®¾ç½®ä¸º rwx rw- r-- å°±å¯ä»¥æ“ä½œä¸º chmod 764 file.txt</span><br></pre></td></tr></table></figure>
<h4 id=""></h4>
<h1>æ¨¡å—Bï¼šæ•°æ®åˆ†æ(30åˆ†)</h1>
<blockquote>
<p>èŠ±äº†ä¸¤å¤©æŠŠçœèµ›æ ·é¢˜ä¸€åšäº†ä¸€éï¼Œæ„Ÿè§‰è¿˜ä¸é”™ï¼Œéš¾ç‚¹å°±æ˜¯åœ¨å‰æœŸçš„æ•°æ®çš„å¤„ç†ä¸Šï¼Œå¯¹äºæ‰€å¤„æ•°æ®çš„æ ¼å¼è¦æœ‰åˆ†è¾¨ï¼Œæ˜¯å¯¹åˆ—å¤„ç†ï¼Œè¿˜æ˜¯å¯¹è¡¨å¤„ç†ã€‚å¦å¤–å¯¹æ•°æ®å¼‚å¸¸å€¼å’Œç©ºå€¼çš„å¤„ç†æ—¶å€™ä¼šå‡ºç°é—®é¢˜ï¼Œå°±å¯ä»¥ç”¨æ›¿æ¢çš„æ–¹å¼,fillnaå¤„ç†çš„æ—¶å€™è¦æ³¨æ„æ›¿æ¢æˆæ•°å€¼ç±»å‹çš„æ—¶å€™ï¼Œéœ€è¦å°†æºæ•°æ®çš„æ ¼å¼astypeä¸ºæ•°å€¼ç±»å‹ã€‚å¯¹äºç”»å›¾è¿™é‡Œï¼Œå…¶å®è¿˜æ˜¯å¯¹æ•°æ®è¿›è¡Œå¤„ç†ï¼Œéš¾ç‚¹å°±æ˜¯å¯¹äºè½´å¤„ç†å’Œå€¼å¤„ç†ï¼Œå¯¹äºx,yæœ€å¥½è¿˜æ˜¯zipä¸€ä¸‹æˆ–è€…enumerateã€‚è¿™ä¸€æ¨¡å—ç»ƒçš„å°±æ˜¯å¯¹æ•°æ®çš„æ•æ„Ÿæ€§ï¼Œè¿˜æ˜¯å¾—å¤šåˆ·ç‚¹ç®—æ³•é¢˜ç»ƒæ€ç»´</p>
</blockquote>
<h2 id="çœèµ›æ ·å·ä¸€ï¼šæ¨¡å—B">çœèµ›æ ·å·ä¸€ï¼šæ¨¡å—B</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾ï¼ŒSimHeiæ˜¯é»‘ä½“çš„è‹±æ–‡åç§°</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]</span><br><span class="line"><span class="comment"># è§£å†³ç¬¦å·æ˜¾ç¤ºä¸ºæ–¹å—çš„é—®é¢˜</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span></span><br></pre></td></tr></table></figure>
<h3 id="ä»»åŠ¡1ï¼šæ•°æ®è¯»å–ï¼ˆ1åˆ†ï¼‰">ä»»åŠ¡1ï¼šæ•°æ®è¯»å–ï¼ˆ1åˆ†ï¼‰</h3>
<blockquote>
<p>è¿™é‡Œä»»åŠ¡ä¹¦è¯´ç€æ˜¯åªè¯»å–ä¸€ä¸ªæ–‡ä»¶ï¼Œåˆ°æ¯”èµ›å¾ˆå¯èƒ½å°±æ˜¯è¯»å–ä¸¤å¼ è¡¨è¿›è¡Œåˆå¹¶</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">ä»»åŠ¡1ï¼šæ•°æ®è¯»å–ï¼ˆ1åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢ è½½å…¥ movies.csv æ–‡ä»¶ï¼Œæ•°æ®è·¯å¾„ä¸º ../data/movies.csv â€¢ ç»“æœä»¥å˜é‡dataä¿å­˜</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">data1 = pd.read_csv(<span class="string">&#x27;tmdb_5000_movies.csv&#x27;</span>)</span><br><span class="line">data2 = pd.read_csv(<span class="string">&#x27;tmdb_5000_credits.csv&#x27;</span>)</span><br><span class="line"><span class="comment"># åˆå¹¶è¡¨</span></span><br><span class="line">data = data1.merge(data2,how=<span class="string">&#x27;left&#x27;</span>, left_on=<span class="string">&#x27;id&#x27;</span>, right_on=<span class="string">&#x27;movie_id&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œåˆå¹¶å®Œæˆä¹‹åå¯èƒ½ä¼šæœ‰é‡å¤çš„åˆ—ï¼Œpythonä¼šè‡ªåŠ¨è¯†åˆ«ç„¶åæ·»åŠ _x,_yè¿™ç§çš„å­—æ®µï¼Œæ¯”èµ›çš„æ—¶å€™è¦çœ‹æ¸…æ¥šï¼Œè¿™é‡Œå¯ä»¥è‡ªå®šä¹‰åˆ é™¤å’Œé‡å‘½å</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data.rename(&#123;<span class="string">&#x27;title_x&#x27;</span>:t1,<span class="string">&#x27;title_y&#x27;</span>:t2&#125;,inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># åˆ é™¤æœ‰å¤šç§æ–¹å¼</span></span><br><span class="line"><span class="keyword">del</span> data[<span class="string">&#x27;title_x&#x27;</span>]</span><br><span class="line">data.drop(columns=[<span class="string">&#x27;title_x&#x27;</span>,<span class="string">&#x27;title_y&#x27;</span>])</span><br></pre></td></tr></table></figure>
<p>åˆå¹¶å®Œè¡¨ä¹‹åå¯ä»¥é‡ç½®ç´¢å¼•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = data.reset_index(drop=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#data.index += 1</span></span><br></pre></td></tr></table></figure>
<p>åšå®Œè¿™ä¸€éƒ¨åˆ†ä¹‹åå¯ä»¥ä¿å­˜ä¸€äº›é˜²æ­¢åæœŸç”¨åˆ°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.to_csv(<span class="string">&#x27;movie.csv&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="ä»»åŠ¡2ï¼šæ•°æ®å¤„ç†ï¼ˆ9åˆ†ï¼‰">ä»»åŠ¡2ï¼šæ•°æ®å¤„ç†ï¼ˆ9åˆ†ï¼‰</h3>
<h4 id="ä»»åŠ¡2-1ï¼ˆ1åˆ†ï¼‰">ä»»åŠ¡2-1ï¼ˆ1åˆ†ï¼‰</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">åˆ é™¤æŒ‡å®šå­—æ®µï¼Œå…·ä½“è¦æ±‚å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="string">â€¢	åˆ é™¤homepage, original_title, overview, spoken_languages, status, tagline, movie_idå­—æ®µ</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">data.drop(columns=[<span class="string">&#x27;homepage&#x27;</span>, <span class="string">&#x27;original_title&#x27;</span>, <span class="string">&#x27;overview&#x27;</span>,</span><br><span class="line">                   <span class="string">&#x27;spoken_languages&#x27;</span>, <span class="string">&#x27;status&#x27;</span>, <span class="string">&#x27;tagline&#x27;</span>, <span class="string">&#x27;movie_id&#x27;</span>],inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<h4 id="ä»»åŠ¡2-2ï¼ˆ1åˆ†ï¼‰">ä»»åŠ¡2-2ï¼ˆ1åˆ†ï¼‰</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">å¢åŠ profitå­—æ®µï¼Œè¯¥å­—æ®µä¸ºæ¯éƒ¨ç”µå½±çš„æ”¶ç›Šï¼Œå…·ä½“è¦æ±‚å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="string">â€¢	è®¡ç®—æ¯éƒ¨ç”µå½±çš„æ”¶ç›Šï¼Œæ”¶ç›Š=ç”µå½±ç¥¨æˆ¿-ç”µå½±é¢„ç®—</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">data.loc[:,<span class="string">&#x27;profit&#x27;</span>] = data[<span class="string">&#x27;revenue&#x27;</span>] - data[<span class="string">&#x27;budget&#x27;</span>]</span><br></pre></td></tr></table></figure>
<h4 id="ä»»åŠ¡2-4ï¼ˆ1åˆ†ï¼‰">ä»»åŠ¡2-4ï¼ˆ1åˆ†ï¼‰</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">å¤„ç†runtimeå­—æ®µçš„ç¼ºå¤±å€¼ï¼Œè¯¥å­—æ®µæœ‰ä¸¤ä¸ªç¼ºå¤±å€¼ï¼Œå…·ä½“è¦æ±‚å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="string">â€¢	å°†idä¸º370980çš„ç¼ºå¤±å€¼å¡«å……ä¸º98</span></span><br><span class="line"><span class="string">â€¢	å°†idä¸º459488çš„ç¼ºå¤±å€¼å¡«å……ä¸º81</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># å…ˆæŸ¥çœ‹æ•°æ®ç±»å‹</span></span><br><span class="line">data[<span class="string">&#x27;runtime&#x27;</span>].dtype</span><br><span class="line"><span class="comment"># å¦‚æœä¸æ˜¯æ•°å€¼ç±»å‹å°±æ”¹æˆæ•°å€¼ç±»å‹</span></span><br><span class="line">data[<span class="string">&#x27;runtime&#x27;</span>] = data[<span class="string">&#x27;runtime&#x27;</span>].astype(<span class="built_in">float</span>)</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç©ºå€¼</span></span><br><span class="line">data[data[<span class="string">&#x27;runtime&#x27;</span>].isnull()]</span><br><span class="line"><span class="comment"># æŸ¥çœ‹éç©ºå€¼</span></span><br><span class="line">data[~data[<span class="string">&#x27;runtime&#x27;</span>].isnull()]</span><br><span class="line"><span class="comment">#å¡«å……</span></span><br><span class="line">data.loc[(data[<span class="string">&#x27;runtime&#x27;</span>].isnull()) &amp; (data[<span class="string">&#x27;id&#x27;</span>] == <span class="number">370980</span>),<span class="string">&#x27;runtime&#x27;</span>] = <span class="number">98</span></span><br><span class="line">data.loc[(data[<span class="string">&#x27;runtime&#x27;</span>].isnull()) &amp; (data[<span class="string">&#x27;id&#x27;</span>] == <span class="number">459488</span>),<span class="string">&#x27;runtime&#x27;</span>] = <span class="number">81</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œé‡åˆ°äº›é—®é¢˜è¿˜æ²¡è§£å†³ï¼Œå°±æ˜¯å¯¹äºç¼ºå¤±å€¼å¤„ç†æˆ‘æ˜¯ç”¨<code>fillna</code>å‡½æ•°ï¼Œå¹¶ä¸”åœ¨æ ¼å¼æ­£ç¡®çš„æƒ…å†µä¸‹ï¼Œinplace=Trueä¸ç”Ÿæ•ˆï¼ŒæŸ¥äº†æŸ¥ç™¾åº¦æ˜¯å› ä¸ºé“¾å¼åŸå› ï¼Œå¤šæ¬¡è°ƒç”¨äº†æŒ‡å®šçš„idï¼Œé‚£å°±éº»çƒ¦ç‚¹ç›´æ¥å¯¹åŸå§‹æ•°æ®è¿›è¡Œæ›¿æ¢ã€‚</p>
<p>å¦‚æœå¡«å……çš„æ—¶å€™æŠ¥é”™å¯èƒ½æ˜¯ç´¢å¼•çš„é—®é¢˜å»é‡æ–°æä¸€ä¸‹ç´¢å¼•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.reset_index(drop=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<h4 id="ä»»åŠ¡2-5ï¼ˆ2åˆ†ï¼‰">ä»»åŠ¡2-5ï¼ˆ2åˆ†ï¼‰</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">åˆ†åˆ«å¯¹genres, keywords, production_companies, production_countrieså­—æ®µè¿›è¡Œå¤„ç†ï¼Œå…·ä½“è¦æ±‚å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="string">â€¢	æ¯ä¸ªå­—æ®µåªä¿ç•™è¯¥å­—æ®µå†…å®¹ä¸­nameé”®å€¼å¯¹åº”çš„valueå€¼ï¼Œå¹¶ä»¥|åˆ†éš”</span></span><br><span class="line"><span class="string">æç¤ºï¼šä¾‹å¦‚[&#123;&quot;id&quot;: 28, &quot;name&quot;: &quot;Action&quot;&#125;, &#123;&quot;id&quot;: 12, &quot;name&quot;: &quot;Adventure&quot;&#125;, &#123;&quot;id&quot;: 14, &quot;name&quot;: &quot;Fantasy&quot;&#125;, &#123;&quot;id&quot;: 878, &quot;name&quot;: &quot;Science Fiction&quot;&#125;]ï¼Œå¤„ç†åå˜ä¸ºAction|Adventure|Fantasy|Science Fiction</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># è¿™é‡Œéœ€è¦å¯¼å…¥json</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†å­—ç¬¦ä¸²è£…æˆå­—å…¸åˆ—è¡¨ç±»å‹</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">task2_5</span>(<span class="params">datas</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(datas, <span class="built_in">str</span>):</span><br><span class="line">        datas = json.loads(datas)</span><br><span class="line">    names = [i[<span class="string">&#x27;name&#x27;</span>] <span class="keyword">for</span> i <span class="keyword">in</span> datas]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;|&#x27;</span>.join(names)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è°ƒç”¨</span></span><br><span class="line">data[<span class="string">&#x27;genres&#x27;</span>] = data[<span class="string">&#x27;genres&#x27;</span>].apply(task2_5)</span><br><span class="line">data[<span class="string">&#x27;keywords&#x27;</span>] = data[<span class="string">&#x27;keywords&#x27;</span>].apply(task2_5)</span><br><span class="line">data[<span class="string">&#x27;production_companies&#x27;</span>] = data[<span class="string">&#x27;production_companies&#x27;</span>].apply(task2_5)</span><br><span class="line">data[<span class="string">&#x27;production_countries&#x27;</span>] = data[<span class="string">&#x27;production_countries&#x27;</span>].apply(task2_5)</span><br></pre></td></tr></table></figure>
<h4 id="ä»»åŠ¡2-6ï¼ˆ2åˆ†ï¼‰">ä»»åŠ¡2-6ï¼ˆ2åˆ†ï¼‰</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">å¯¹crewå­—æ®µè¿›è¡Œå¤„ç†ï¼Œå…·ä½“è¦æ±‚å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="string">â€¢	åªä¿ç•™å¯¼æ¼”çš„åå­—ï¼Œå¹¶ä»¥|åˆ†éš”</span></span><br><span class="line"><span class="string">â€¢	å°†crewå­—æ®µåˆ—åæ”¹ä¸ºdirector</span></span><br><span class="line"><span class="string">æç¤ºï¼šå¯¼æ¼”çš„jobä¸ºDirector</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">task2_6</span>(<span class="params">datas</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(datas, <span class="built_in">str</span>):</span><br><span class="line">        datas = json.loads(datas)</span><br><span class="line">    names = [i[<span class="string">&#x27;name&#x27;</span>] <span class="keyword">for</span> i <span class="keyword">in</span> datas <span class="keyword">if</span> i[<span class="string">&#x27;job&#x27;</span>] == <span class="string">&#x27;Director&#x27;</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;|&#x27;</span>.join(names)</span><br><span class="line">data[<span class="string">&#x27;crew&#x27;</span>] = data[<span class="string">&#x27;crew&#x27;</span>].apply(task2_6)</span><br><span class="line">data.rename(columns=&#123;<span class="string">&#x27;crew&#x27;</span>:<span class="string">&#x27;director&#x27;</span>&#125;,inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>æœ€åä¿å­˜</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.to_csv(<span class="string">&#x27;movie2.csv&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="ä»»åŠ¡3ï¼šæ•°æ®å¯è§†åŒ–ï¼ˆ20åˆ†ï¼‰">ä»»åŠ¡3ï¼šæ•°æ®å¯è§†åŒ–ï¼ˆ20åˆ†ï¼‰</h3>
<h4 id="ä»»åŠ¡3-1ï¼ˆ2åˆ†ï¼‰">ä»»åŠ¡3-1ï¼ˆ2åˆ†ï¼‰</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">å¯¹ç”µå½±çš„å…³é”®è¯åˆ¶ä½œè¯äº‘å›¾</span></span><br><span class="line"><span class="string">â€¢	æˆåŠŸåˆ¶ä½œè¯äº‘å›¾ï¼ˆ1åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	è¯äº‘å›¾å›¾å½¢ä¸ºvideoï¼ˆ1åˆ†ï¼‰</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># è¿™é‡Œå¯ä»¥å¯¼å…¥jiebaè¿›è¡Œåˆ†è¯,PILè¿›è¡Œimgè·å–</span></span><br><span class="line"><span class="comment"># import jieba</span></span><br><span class="line"><span class="keyword">from</span> wordcloud <span class="keyword">import</span> WordCloud</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> colors</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">keywords_res = keywords.<span class="built_in">str</span>.split(<span class="string">&#x27;|&#x27;</span>).explode().unique()</span><br><span class="line">key_res = <span class="string">&#x27; &#x27;</span>.join(keywords_res)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®ç‰ˆå›¾å£ç½©</span></span><br><span class="line">video_mask = np.array(Image.<span class="built_in">open</span>(<span class="string">&#x27;./img/map.jpg&#x27;</span>))</span><br><span class="line">color_list = [<span class="string">&#x27;black&#x27;</span>,<span class="string">&#x27;red&#x27;</span>,<span class="string">&#x27;orange&#x27;</span>]</span><br><span class="line">colormap = colors.ListedColormap(color_list)</span><br><span class="line"></span><br><span class="line">wordclound = WordCloud(</span><br><span class="line">    mask = video_mask,</span><br><span class="line">    background_color=<span class="string">&#x27;white&#x27;</span>,</span><br><span class="line">    colormap=colormap</span><br><span class="line">).generate(key_res)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>,<span class="number">5</span>))</span><br><span class="line">plt.imshow(wordclound, interpolation=<span class="string">&#x27;bilinear&#x27;</span>)</span><br><span class="line">plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.savefig(<span class="string">&#x27;wordcloud_map.png&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>è¯äº‘å›¾ç»˜åˆ¶è¦æ³¨æ„å‡ ä¸ªé—®é¢˜ï¼Œæœ€ç»ˆgenreate_from_textä¸€å®šæ˜¯ä»¥ç©ºæ ¼éš”å¼€çš„æ–‡æœ¬æ–‡å­—ï¼Œå¦‚æœæ¯”èµ›çš„æ—¶å€™æä¾›äº†jiebaåŒ…å°±å¯ä»¥</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">è¿™é‡Œtextæ˜¯ä¸€ç»´çš„åˆ—è¡¨æ ¼å¼</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">cut = jieba.cut(text)</span><br><span class="line">string = <span class="string">&#x27; &#x27;</span>.join(cut)</span><br></pre></td></tr></table></figure>
<p>å¦‚æœéœ€è¦è‡ªåŠ¨åŒ–ä¿å­˜nå¼ å›¾ç‰‡å¯ä»¥ä½¿ç”¨éšæœºæ•°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ranInt = random.randint(<span class="number">1</span>,<span class="number">1000000</span>)</span><br><span class="line"></span><br><span class="line">plt.savefig(<span class="string">f&#x27;./static/cloud/<span class="subst">&#123;ranInt&#125;</span>.png&#x27;</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="string">f&#x27;./static/cloud/<span class="subst">&#123;ranInt&#125;</span>.png&#x27;</span></span><br></pre></td></tr></table></figure>
<h4 id="ä»»åŠ¡3-2ï¼ˆ2åˆ†ï¼‰">ä»»åŠ¡3-2ï¼ˆ2åˆ†ï¼‰</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">åˆ¶ä½œç”µå½±çš„æ—¶é•¿é¢‘ç‡åˆ†å¸ƒç›´æ–¹å›¾</span></span><br><span class="line"><span class="string">â€¢	ç›´æ–¹å›¾å›¾å½¢ç±»å‹æ­£ç¡®ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	ç›´æ–¹å›¾é¢œè‰²ä¸ºè“è‰²ï¼Œé€æ˜åº¦ä¸º 0.5ï¼Œæ¡†çº¿ä¸ºé»‘è‰²ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	æ¦‚ç‡å¯†åº¦æ›²çº¿ä»¥è™šçº¿è¡¨ç¤ºï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	Xè½´å’ŒYè½´æ ‡ç­¾æ­£ç¡®ï¼Œå·¦è½´ä¸ºç›´æ–¹å›¾Yè½´ï¼Œå³ä¾§ä¸ºæ¦‚ç‡å¯†åº¦æ›²çº¿è½´ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"># ç»˜åˆ¶ç›´æ–¹å›¾</span></span><br><span class="line"><span class="string">n, bins, patches = plt.hist(runtimes, bins=20, color=&#x27;skyblue&#x27;, alpha=0.5, edgecolor=&#x27;black&#x27;, density=True)			# è¿™é‡Œçš„density=Trueæ˜¯æ˜¾ç¤ºé¢‘ç‡ï¼ŒFalseæ˜¯é¢‘æ•°</span></span><br><span class="line"><span class="string"># è®¡ç®—ç»„è·</span></span><br><span class="line"><span class="string">bin_width = bins[1] - bins[0]</span></span><br><span class="line"><span class="string"># è®¡ç®—é¢‘ç‡/ç»„è·</span></span><br><span class="line"><span class="string">frequency = n / bin_width</span></span><br><span class="line"><span class="string"># è®¡ç®—é¢‘ç‡å¯†åº¦</span></span><br><span class="line"><span class="string">total_count = len(runtimes)</span></span><br><span class="line"><span class="string">density = frequency / total_count</span></span><br><span class="line"><span class="string"># è®¡ç®—é¢‘ç‡å¯†åº¦</span></span><br><span class="line"><span class="string"># freq_density = n / (len(runtimes) * bin_width)</span></span><br><span class="line"><span class="string"># æ‰“å°é¢‘ç‡/ç»„è·å’Œé¢‘ç‡å¯†åº¦</span></span><br><span class="line"><span class="string">print(&quot;é¢‘ç‡/ç»„è·:&quot;, frequency)</span></span><br><span class="line"><span class="string">print(&quot;é¢‘ç‡å¯†åº¦1:&quot;, density)</span></span><br><span class="line"><span class="string">print(&quot;é¢‘ç‡å¯†åº¦2:&quot;, freq_density)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">runtimes = data[<span class="string">&#x27;runtime&#x27;</span>]</span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">6</span>), dpi=<span class="number">120</span>)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">&#x27;ç”µå½±æ—¶é•¿é¢‘ç‡åˆ†å¸ƒç›´æ–¹å›¾&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;ç”µå½±æ—¶é•¿&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;é¢‘ç‡/ç»„è·&#x27;</span>)</span><br><span class="line"></span><br><span class="line">n,  bins, p = plt.hist(runtime,bins=<span class="number">32</span>, color=<span class="string">&#x27;skyblue&#x27;</span>, alpha=<span class="number">0.5</span>, density=<span class="literal">True</span>, edgecolor=<span class="string">&#x27;black&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ax2 = plt.twinx()</span><br><span class="line">ax2.set_ylabel(<span class="string">&#x27;é¢‘ç‡å¯†åº¦&#x27;</span>)</span><br><span class="line">ax2.plot(bins[:-<span class="number">1</span>],n, linestyle=<span class="string">&#x27;--&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ å›¾ä¾‹</span></span><br><span class="line">ax2.legend([<span class="string">&#x27;é¢‘ç‡å¯†åº¦&#x27;</span>], loc=<span class="string">&#x27;upper right&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºå›¾å½¢</span></span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>åˆ†åŒ–å­å›¾ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">n, bins, patches = plt.hist(runtimes, bins=<span class="number">20</span>, color=<span class="string">&#x27;blue&#x27;</span>, alpha=<span class="number">0.5</span>, edgecolor=<span class="string">&#x27;black&#x27;</span>)</span><br><span class="line">bin_width = bins[<span class="number">1</span>] - bins[<span class="number">0</span>]</span><br><span class="line">freq_density = n / (<span class="built_in">len</span>(runtimes) * bin_width)</span><br><span class="line">fig, ax1 = plt.subplots()</span><br><span class="line">ax2 = ax1.twinx()</span><br><span class="line">ax2.plot(bins[:-<span class="number">1</span>], freq_density, linestyle=<span class="string">&#x27;--&#x27;</span>, color=<span class="string">&#x27;red&#x27;</span>)</span><br><span class="line">ax1.set_xlabel(<span class="string">&#x27;ç”µå½±æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰&#x27;</span>)</span><br><span class="line">ax1.set_ylabel(<span class="string">&#x27;é¢‘ç‡/ç»„è·&#x27;</span>)</span><br><span class="line">ax2.set_ylabel(<span class="string">&#x27;é¢‘ç‡å¯†åº¦&#x27;</span>)</span><br><span class="line">ax2.legend([<span class="string">&#x27;é¢‘ç‡å¯†åº¦&#x27;</span>], loc=<span class="string">&#x27;upper right&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="ä»»åŠ¡3-3ï¼ˆ2åˆ†ï¼‰">ä»»åŠ¡3-3ï¼ˆ2åˆ†ï¼‰</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">åˆ¶ä½œç”µå½±äº§åœ°åˆ†å¸ƒç«ç‘°å›¾</span></span><br><span class="line"><span class="string">â€¢	ç»Ÿè®¡ä¸åŒäº§åœ°çš„ç”µå½±æ•°é‡ï¼Œç”µå½±æ•°é‡ä½äºå‰äº”çš„äº§åœ°ï¼Œå…¨éƒ¨å½’ä¸ºothers</span></span><br><span class="line"><span class="string">â€¢	æˆåŠŸåˆ¶ä½œç«ç‘°å›¾ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	æ ‡é¢˜ä¸ºç”µå½±äº§åœ°åˆ†å¸ƒï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	æ ‡ç­¾æ•°å€¼æ­£ç¡®ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	æ ‡ç­¾ä¸ºå›½å®¶ï¼šç™¾åˆ†æ¯”ï¼Œç™¾åˆ†æ¯”ä¿ç•™ä¸¤ä½å°æ•°ï¼Œä¾‹å¦‚ï¼šCanada: 2.53%ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">Canada: 2.53%ï¼Œæ­¤æ•°æ®ä¸ºè™šæ„çš„ï¼ŒçœŸå®æ•°å€¼éœ€è¦è‡ªè¡Œè®¡ç®—</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">task3_3 = data[<span class="string">&#x27;production_countries&#x27;</span>].<span class="built_in">str</span>.split(<span class="string">&#x27;|&#x27;</span>).apply(np.unique).explode()</span><br><span class="line">task3_3 = task3_3.value_counts()</span><br><span class="line">top5 = task3_3.head(<span class="number">5</span>)</span><br><span class="line">other = task3_3[~task3_3.index.isin(top5.index)]</span><br><span class="line">other = pd.Series(other.<span class="built_in">sum</span>(), index=[<span class="string">&#x27;other&#x27;</span>])</span><br><span class="line">task3_3_1 = top5.append(other)</span><br><span class="line"></span><br><span class="line">x = task3_3_1.index</span><br><span class="line">y = (task3_3_1 / task3_3_1.<span class="built_in">sum</span>() * <span class="number">100</span>).<span class="built_in">round</span>(<span class="number">2</span>).values</span><br><span class="line"></span><br><span class="line">res = [[a,<span class="built_in">float</span>(b)] <span class="keyword">for</span> a,b <span class="keyword">in</span> <span class="built_in">zip</span>(x,y)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pyecharts <span class="keyword">import</span> options</span><br><span class="line"><span class="keyword">from</span> pyecharts.charts <span class="keyword">import</span> Pie</span><br><span class="line"></span><br><span class="line">c = (</span><br><span class="line">    Pie()</span><br><span class="line">    .add(</span><br><span class="line">        series_name=<span class="string">&quot;&quot;</span>,</span><br><span class="line">        data_pair=res,</span><br><span class="line">        radius=[<span class="string">&#x27;30%&#x27;</span>,<span class="string">&#x27;50%&#x27;</span>],</span><br><span class="line">        start_angle=<span class="number">21</span>,</span><br><span class="line">        rosetype=<span class="literal">True</span>,</span><br><span class="line">        label_opts=options.LabelOpts(is_show=<span class="literal">True</span>,formatter=<span class="string">&#x27;&#123;b&#125;:&#123;d&#125;%&#x27;</span>)</span><br><span class="line">    )</span><br><span class="line">    .set_global_opts(</span><br><span class="line">        title_opts=options.TitleOpts(is_show=<span class="literal">True</span>, title=<span class="string">&#x27;ç”µå½±äº§åœ°åˆ†å¸ƒ&#x27;</span>)</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">c.render_notebook()</span><br></pre></td></tr></table></figure>
<p>isinçš„åå‡½æ•°æ˜¯<code>~</code> ï¼Œisinæ˜¯ä¸€ä¸ªéå¸¸å¥½ç”¨çš„åˆ¤æ–­å­˜åœ¨ä¸å¦çš„å‡½æ•°ï¼Œå¤šç”¨åæ­£æ€ç»´æ¥åšï¼Œæ¯”æ­£å‘èŠ‚çœè®¸å¤šä»£ç é‡</p>
<h4 id="ä»»åŠ¡3-4ï¼ˆ2åˆ†ï¼‰">ä»»åŠ¡3-4ï¼ˆ2åˆ†ï¼‰</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">ç»Ÿè®¡ç¥¨æˆ¿å‡å€¼Top10çš„å¯¼æ¼”ï¼Œå¹¶ä»¥æ¡å½¢å›¾å±•ç¤º</span></span><br><span class="line"><span class="string">â€¢	ç¥¨æˆ¿å‡å€¼ä»¥æ•´æ•°è¡¨ç¤ºï¼Œå››èˆäº”å…¥</span></span><br><span class="line"><span class="string">â€¢	æ ‡é¢˜ä¸ºç¥¨æˆ¿æ’åTop10çš„å¯¼æ¼”ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	æ ‡ç­¾æ•°å€¼æ­£ç¡®ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	æ ‡ç­¾ä½ç½®æ”¾ç½®å³ä¾§ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	çºµåæ ‡å¯¼æ¼”åå­—æ˜¾ç¤ºå®Œå…¨ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">task3_4 = data[[<span class="string">&#x27;director&#x27;</span>,<span class="string">&#x27;revenue&#x27;</span>]].groupby(<span class="string">&#x27;director&#x27;</span>).agg(&#123;<span class="string">&#x27;revenue&#x27;</span>:<span class="string">&#x27;mean&#x27;</span>&#125;).astype(<span class="string">&#x27;int64&#x27;</span>).sort_values(by=<span class="string">&#x27;revenue&#x27;</span>).tail(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">x = task3_4.index</span><br><span class="line">y = task3_4.values.flatten()</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">6</span>), dpi=<span class="number">120</span>)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">&#x27;ç¥¨æˆ¿æ’åTop10çš„å¯¼æ¼”&#x27;</span>, loc=<span class="string">&#x27;left&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.xlim(<span class="number">0</span>, <span class="number">1500000000</span>)</span><br><span class="line">plt.xticks(np.arange(<span class="number">0</span>, <span class="number">1700000000</span>, <span class="number">300000000</span>))</span><br><span class="line"></span><br><span class="line">plt.gca().spines[<span class="string">&#x27;right&#x27;</span>].set_visible(<span class="literal">False</span>)</span><br><span class="line">plt.gca().spines[<span class="string">&#x27;top&#x27;</span>].set_visible(<span class="literal">False</span>)</span><br><span class="line">plt.barh(x, y, color=<span class="string">&#x27;red&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<h4 id="ä»»åŠ¡3-5ï¼ˆ2åˆ†ï¼‰">ä»»åŠ¡3-5ï¼ˆ2åˆ†ï¼‰</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">åˆ†æåŸåˆ›ç”µå½±ä¸æ”¹ç¼–ç”µå½±åœ¨æ”¶ç›Šã€ç¥¨æˆ¿ã€é¢„ç®—æ–¹é¢çš„è¡¨ç°ï¼Œä»¥æ—‹é£å›¾å±•ç¤ºï¼š</span></span><br><span class="line"><span class="string">â€¢	æˆåŠŸåˆ¶ä½œæ—‹é£å›¾ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	æ—‹é£å›¾æ ‡ç­¾æ•°å€¼æ­£ç¡®ï¼Œä»¥ä¸‡ä¸ºå•ä½ï¼Œå–æ•´æ•°ï¼ˆå››èˆäº”å…¥ï¼‰ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	æ ‡é¢˜ä¸ºåŸåˆ›ç”µå½±ä¸æ”¹ç¼–ç”µå½±å¯¹æ¯”å›¾ï¼ˆä¸‡ï¼‰ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	æ·»åŠ å›¾ä¾‹ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span></span><br><span class="line">x1 = np.array([<span class="number">47</span>, <span class="number">23</span>, <span class="number">21</span>, <span class="number">19</span>,  <span class="number">7</span>])</span><br><span class="line">x2 = np.array([<span class="number">17</span>, <span class="number">33</span>, <span class="number">11</span>, <span class="number">2</span>,  <span class="number">17</span>])</span><br><span class="line">y = np.arange(<span class="number">5</span>)</span><br><span class="line">labels=[<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;ç‰¹å¾1&#x27;</span>,<span class="string">&#x27;ç‰¹å¾2&#x27;</span>,<span class="string">&#x27;ç‰¹å¾ä¸‰&#x27;</span>,<span class="string">&#x27;ç‰¹å¾å››&#x27;</span>,<span class="string">&#x27;ç‰¹å¾äº”&#x27;</span>]</span><br><span class="line"><span class="comment"># fig, ax1 = plt.subplots()</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">12</span>,<span class="number">8</span>))</span><br><span class="line">ax1 = fig.add_subplot()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ax2 = ax1.twinx()</span></span><br><span class="line"><span class="comment">#plot</span></span><br><span class="line">ax1.barh(y, x1,<span class="number">0.8</span>,color =<span class="string">&#x27;r&#x27;</span>, label=<span class="string">&#x27;æ”¹å˜&#x27;</span>)</span><br><span class="line">ax1.barh(y, -x2,<span class="number">0.8</span>,color =<span class="string">&#x27;k&#x27;</span>, label=<span class="string">&#x27;è¿œç¨‹&#x27;</span>)</span><br><span class="line">ax1.set_yticklabels(labels,fontsize=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">ax1.set_xlim(-<span class="number">60</span>,<span class="number">60</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#setting</span></span><br><span class="line">ax1.set_xlabel(<span class="string">&#x27;ç«å“åˆ†æ&#x27;</span>,color=<span class="string">&#x27;k&#x27;</span>,fontsize=<span class="number">16</span>)</span><br><span class="line"><span class="comment"># ax1.set_ylabel(&#x27;ç«å“åˆ†æ&#x27;, color=&#x27;k&#x27;,fontsize=16)</span></span><br><span class="line"></span><br><span class="line">plt.legend()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> a,b <span class="keyword">in</span> <span class="built_in">zip</span>(x1,y):</span><br><span class="line">    plt.text(a+<span class="number">5</span>, b, <span class="string">&#x27;%0.00f&#x27;</span> % a, ha=<span class="string">&#x27;center&#x27;</span>, va= <span class="string">&#x27;center&#x27;</span>,fontsize=<span class="number">16</span>,color=<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> a,b <span class="keyword">in</span> <span class="built_in">zip</span>(x2,y):</span><br><span class="line">    plt.text(-a-<span class="number">5</span>, b, <span class="string">&#x27;%0.00f&#x27;</span> % a, ha=<span class="string">&#x27;center&#x27;</span>, va= <span class="string">&#x27;center&#x27;</span>,fontsize=<span class="number">16</span>,color=<span class="string">&#x27;k&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<h4 id="ä»»åŠ¡3-6ï¼ˆ2åˆ†ï¼‰">ä»»åŠ¡3-6ï¼ˆ2åˆ†ï¼‰</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">ç»Ÿè®¡å„ç§ç”µå½±ç±»å‹æ‰€å çš„æ¯”ä¾‹ï¼Œä»¥é¥¼å›¾å±•ç¤º</span></span><br><span class="line"><span class="string">â€¢	è®¾ç½®otherç±»ï¼Œå½“ç”µå½±ç±»å‹æ‰€å æ¯”ä¾‹å°äº%1æ—¶ï¼Œå…¨éƒ¨å½’åˆ°otherç±»ä¸­ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	æ‰€å æ¯”ä¾‹å°äºæˆ–ç­‰äº%2æ—¶ï¼Œå¯¹åº”çš„é¥¼çŠ¶å›¾å¾€å¤–çªå‡ºä¸€æˆªï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	æ•°å€¼æ­£ç¡®ï¼Œç™¾åˆ†æ¯”ä¿ç•™ä¸€ä½å°æ•°ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	æ ‡é¢˜ä¸ºå„ç§ç”µå½±ç±»å‹æ‰€å çš„æ¯”ä¾‹ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">task3_6 = data[<span class="string">&#x27;genres&#x27;</span>].<span class="built_in">str</span>.split(<span class="string">&#x27;|&#x27;</span>).apply(np.unique).explode()</span><br><span class="line">task3_6 = task3_6[task3_6.apply(<span class="keyword">lambda</span> x : <span class="built_in">len</span>(x) &gt; <span class="number">0</span>)].reset_index(drop=<span class="literal">True</span>).value_counts()</span><br><span class="line"></span><br><span class="line">task3_6_1 = (task3_6 / task3_6.<span class="built_in">sum</span>() * <span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">other = task3_6_1[task3_6_1 &lt; <span class="number">1</span>].<span class="built_in">sum</span>().<span class="built_in">round</span>(<span class="number">1</span>)</span><br><span class="line">other = pd.Series(other, index=[<span class="string">&#x27;other&#x27;</span>])</span><br><span class="line"></span><br><span class="line">res = task3_6_1[task3_6_1 &gt; <span class="number">1</span>].<span class="built_in">round</span>(<span class="number">1</span>).append(other)</span><br><span class="line">x = res.index</span><br><span class="line">y = res.values</span><br><span class="line">explode = [<span class="number">0.1</span> <span class="keyword">if</span> i &lt;= <span class="number">2</span> <span class="keyword">else</span> <span class="number">0.02</span> <span class="keyword">for</span> i <span class="keyword">in</span> y]</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>,<span class="number">6</span>),dpi=<span class="number">120</span>)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">&#x27;å„ç§ç”µå½±ç±»å‹æ‰€å çš„æ¯”ä¾‹&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.pie(y,labels=x,explode=explode, autopct=<span class="string">&#x27;%.1f%%&#x27;</span>, startangle=<span class="number">50</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<h4 id="ä»»åŠ¡3-7ï¼ˆ2åˆ†ï¼‰">ä»»åŠ¡3-7ï¼ˆ2åˆ†ï¼‰</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">ä»»åŠ¡3-7ï¼ˆ2åˆ†ï¼‰</span></span><br><span class="line"><span class="string">ç»Ÿè®¡ç”µå½±é£æ ¼ï¼ˆç±»å‹ï¼‰Top5éšæ—¶é—´ï¼ˆ1980å¹´è‡³ä»Šï¼‰çš„å˜åŒ–è¶‹åŠ¿ï¼Œä»¥æŠ˜çº¿å›¾å±•ç¤º</span></span><br><span class="line"><span class="string">â€¢	æŠ˜çº¿å›¾è®¾ç½®ä¸ºé¡ºæ»‘æ¨¡å¼ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	æ ‡é¢˜å’Œå›¾ä¾‹ä¸èƒ½é‡å ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	æ•°æ®èµ·ç‚¹å’Œçºµåæ ‡æ²¡æœ‰é—´éš™ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	ä¸ºæœ€å¤§å€¼åšæ ‡è®°ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">task3_7 = data[[<span class="string">&#x27;genres&#x27;</span>,<span class="string">&#x27;year&#x27;</span>]]</span><br><span class="line">task3_7 = task3_7[task3_7[<span class="string">&#x27;genres&#x27;</span>].apply(<span class="keyword">lambda</span> x:<span class="built_in">len</span>(x) &gt; <span class="number">0</span>)].reset_index(drop=<span class="literal">True</span>)</span><br><span class="line">task3_7[<span class="string">&#x27;genres&#x27;</span>] = task3_7[<span class="string">&#x27;genres&#x27;</span>].<span class="built_in">str</span>.split(<span class="string">&#x27;|&#x27;</span>).apply(np.unique)</span><br><span class="line"></span><br><span class="line">top5_index= task3_7[<span class="string">&#x27;genres&#x27;</span>].explode().value_counts().nlargest(<span class="number">5</span>).index</span><br><span class="line"></span><br><span class="line">task3_7_1 = task3_7.explode(column=[<span class="string">&#x27;genres&#x27;</span>])</span><br><span class="line">task3_7_1[<span class="string">&#x27;number&#x27;</span>] = <span class="number">1</span></span><br><span class="line">task3_7_1 = task3_7_1[task3_7_1[<span class="string">&#x27;genres&#x27;</span>].isin(top5_index)]</span><br><span class="line"></span><br><span class="line">task3_7_2 = task3_7_1.pivot_table(index=[<span class="string">&#x27;year&#x27;</span>], columns=[<span class="string">&#x27;genres&#x27;</span>],values=[<span class="string">&#x27;number&#x27;</span>],aggfunc=<span class="string">&#x27;sum&#x27;</span>)</span><br><span class="line"></span><br><span class="line">x = task3_7_2.index</span><br><span class="line"></span><br><span class="line">y1 = task3_7_2[<span class="string">&#x27;number&#x27;</span>][<span class="string">&#x27;Action&#x27;</span>]</span><br><span class="line">y2 = task3_7_2[<span class="string">&#x27;number&#x27;</span>][<span class="string">&#x27;Comedy&#x27;</span>]</span><br><span class="line">y3 = task3_7_2[<span class="string">&#x27;number&#x27;</span>][<span class="string">&#x27;Drama&#x27;</span>]</span><br><span class="line">y4 = task3_7_2[<span class="string">&#x27;number&#x27;</span>][<span class="string">&#x27;Romance&#x27;</span>]</span><br><span class="line">y5 = task3_7_2[<span class="string">&#x27;number&#x27;</span>][<span class="string">&#x27;Thriller&#x27;</span>]</span><br><span class="line"></span><br><span class="line">y1.fillna(<span class="number">0</span>,inplace=<span class="literal">True</span>)</span><br><span class="line">y2.fillna(<span class="number">0</span>,inplace=<span class="literal">True</span>)</span><br><span class="line">y3.fillna(<span class="number">0</span>,inplace=<span class="literal">True</span>)</span><br><span class="line">y4.fillna(<span class="number">0</span>,inplace=<span class="literal">True</span>)</span><br><span class="line">y5.fillna(<span class="number">0</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">max_id = y3.idxmax()</span><br><span class="line">max_value = <span class="built_in">int</span>(y3.<span class="built_in">max</span>())</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> scipy.interpolate <span class="keyword">import</span> make_interp_spline</span><br><span class="line"></span><br><span class="line">x_smooth = np.linspace(<span class="built_in">int</span>(x.<span class="built_in">min</span>()), <span class="built_in">int</span>(x.<span class="built_in">max</span>()), <span class="number">400</span>)</span><br><span class="line">y1_smooth = make_interp_spline(x,y1)(x_smooth)</span><br><span class="line">y2_smooth = make_interp_spline(x,y2)(x_smooth)</span><br><span class="line">y3_smooth = make_interp_spline(x,y3)(x_smooth)</span><br><span class="line">y4_smooth = make_interp_spline(x,y4)(x_smooth)</span><br><span class="line">y5_smooth = make_interp_spline(x,y5)(x_smooth)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>,<span class="number">6</span>),dpi=<span class="number">120</span>)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">&#x27;ç”µå½±é£æ ¼ï¼ˆç±»å‹ï¼‰Top5éšæ—¶é—´ï¼ˆ1980å¹´è‡³ä»Šï¼‰çš„å˜åŒ–è¶‹åŠ¿&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.ylim(<span class="number">0</span>,<span class="number">150</span>)</span><br><span class="line">plt.yticks(np.arange(<span class="number">0</span>,<span class="number">180</span>,<span class="number">30</span>))</span><br><span class="line">plt.xlim(<span class="number">1980</span>,<span class="number">2017</span>)</span><br><span class="line">plt.xticks(np.arange(<span class="number">1980</span>,<span class="number">2018</span>,<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">plt.plot(x_smooth,y1_smooth)</span><br><span class="line">plt.plot(x_smooth,y2_smooth)</span><br><span class="line">plt.plot(x_smooth,y3_smooth)</span><br><span class="line">plt.plot(x_smooth,y4_smooth)</span><br><span class="line">plt.plot(x_smooth,y5_smooth)</span><br><span class="line"></span><br><span class="line">plt.text(max_id,max_value+<span class="number">5</span>,max_value, va=<span class="string">&#x27;bottom&#x27;</span>, ha=<span class="string">&#x27;center&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<h4 id="ä»»åŠ¡3-8ï¼ˆ2åˆ†ï¼‰">ä»»åŠ¡3-8ï¼ˆ2åˆ†ï¼‰</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">ç»Ÿè®¡ä¸åŒé£æ ¼ï¼ˆç±»å‹ï¼‰ç”µå½±çš„æ”¶ç›Šèƒ½åŠ›ï¼Œä»¥æ¡å½¢å›¾å’ŒæŠ˜çº¿å›¾æ··åˆå±•ç¤º</span></span><br><span class="line"><span class="string">â€¢	æ¡å½¢å›¾ä¸ºä¸åŒç”µå½±ç±»å‹çš„æ”¶ç›Šæ€»å’Œï¼Œä»¥åƒäº¿ä¸ºå•ä½ï¼Œä¿ç•™ä¸¤ä½å°æ•°ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	æŠ˜çº¿å›¾ä¸ºä¸åŒç”µå½±ç±»å‹çš„æ”¶ç›Šç‡ï¼Œæ”¶ç›Šç‡=æ”¶ç›Š/é¢„ç®—ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	æ¡å½¢å›¾æ ‡ç­¾æ•°å€¼æ­£ç¡®ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	æŠ˜çº¿å›¾ä¸æ˜¾ç¤ºæ ‡ç­¾æ•°å€¼ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">task3_8 = data[[<span class="string">&#x27;genres&#x27;</span>,<span class="string">&#x27;profit&#x27;</span>,<span class="string">&#x27;budget&#x27;</span>]]</span><br><span class="line">task3_8 = task3_8[task3_8[<span class="string">&#x27;genres&#x27;</span>].apply(<span class="keyword">lambda</span> x : <span class="built_in">len</span>(x) &gt; <span class="number">0</span>)].reset_index(drop=<span class="literal">True</span>)</span><br><span class="line">task3_8[<span class="string">&#x27;genres&#x27;</span>] = task3_8[<span class="string">&#x27;genres&#x27;</span>].<span class="built_in">str</span>.split(<span class="string">&#x27;|&#x27;</span>)</span><br><span class="line"></span><br><span class="line">task3_8_1 = task3_8.explode(column=<span class="string">&#x27;genres&#x27;</span>).groupby(<span class="string">&#x27;genres&#x27;</span>).agg(<span class="string">&#x27;sum&#x27;</span>)</span><br><span class="line">task3_8_1[<span class="string">&#x27;pre&#x27;</span>] = (task3_8_1[<span class="string">&#x27;profit&#x27;</span>] / task3_8_1[<span class="string">&#x27;budget&#x27;</span>] * <span class="number">100</span>)</span><br><span class="line">task3_8_1[<span class="string">&#x27;profit&#x27;</span>] = (task3_8_1[<span class="string">&#x27;profit&#x27;</span>] / <span class="number">100000000000</span>).<span class="built_in">round</span>(<span class="number">2</span>)</span><br><span class="line">task3_8_1 = task3_8_1.sort_values(by=<span class="string">&#x27;profit&#x27;</span>,ascending=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">task3_8_1[<span class="string">&#x27;profit&#x27;</span>] = task3_8_1[<span class="string">&#x27;profit&#x27;</span>].apply(<span class="keyword">lambda</span> x: <span class="number">0</span> <span class="keyword">if</span>(x == -<span class="number">0.00</span>) <span class="keyword">else</span> x)</span><br><span class="line"></span><br><span class="line">x = task3_8_1.index</span><br><span class="line">y1 = task3_8_1[<span class="string">&#x27;profit&#x27;</span>].values</span><br><span class="line">y2 = task3_8_1[<span class="string">&#x27;pre&#x27;</span>].values</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>,<span class="number">6</span>),dpi=<span class="number">120</span>)</span><br><span class="line"></span><br><span class="line">plt.xticks(rotation=-<span class="number">45</span>, ha=<span class="string">&#x27;left&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.ylim(<span class="number">0</span>,<span class="number">1.2</span>)</span><br><span class="line">plt.yticks(np.arange(<span class="number">0</span>,<span class="number">1.4</span>,<span class="number">0.2</span>))</span><br><span class="line">plt.bar(x,y1, color=<span class="string">&#x27;red&#x27;</span>,label=<span class="string">&#x27;æ”¶ç›Š&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> a,b <span class="keyword">in</span> <span class="built_in">zip</span>(x,y1):</span><br><span class="line">    plt.text(a,b+<span class="number">0.02</span>,b,ha=<span class="string">&#x27;center&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.legend()</span><br><span class="line"></span><br><span class="line">ax2 = plt.twinx()</span><br><span class="line">ax2.set_ylim(-<span class="number">100</span>, <span class="number">300</span>)</span><br><span class="line">ax2.set_yticks(np.arange(-<span class="number">100</span>, <span class="number">350</span>, <span class="number">50</span>))</span><br><span class="line">ax2.set_yticklabels([(<span class="built_in">str</span>(i)+<span class="string">&quot;%&quot;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> np.arange(-<span class="number">100</span>, <span class="number">350</span>, <span class="number">50</span>)])</span><br><span class="line">ax2.set_ylabel(<span class="string">&#x27;æ”¶ç›Šç‡&#x27;</span>)</span><br><span class="line">ax2.plot(x, y2, marker=<span class="string">&#x27;o&#x27;</span>, label=<span class="string">&#x27;æ”¶ç›Šç‡&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ax2.legend(loc=<span class="string">&#x27;upper right&#x27;</span>, bbox_to_anchor=(<span class="number">1</span>, <span class="number">0.95</span>))</span><br><span class="line">plt.grid(axis=<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">plt.gca().spines[<span class="string">&#x27;top&#x27;</span>].set_visible(<span class="literal">False</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<h4 id="ä»»åŠ¡3-9ï¼ˆ4åˆ†ï¼‰">ä»»åŠ¡3-9ï¼ˆ4åˆ†ï¼‰</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">ç»Ÿè®¡ç”µå½±ç±»å‹Top5ï¼Œä»¥æ¡å½¢å›¾å±•ç¤º</span></span><br><span class="line"><span class="string">â€¢	æ¡å½¢å›¾é¢œè‰²ä¾æ¬¡ä¸º#BCEE68, #EBBDBF, #D6A5DD, #A020F0, #76CBE8 ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	æ¡å½¢å›¾å³ç«¯æ·»åŠ è±¡å½¢å›¾ç‰‡ï¼Œsymbolså·²æå‰ç»™å‡ºï¼Œè±¡å½¢å›¾æ¡†çº¿ä¸ºç°è‰²grey ï¼ˆ2åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	æ ‡ç­¾æ•°å€¼æ­£ç¡®ï¼ˆ0.5åˆ†ï¼‰</span></span><br><span class="line"><span class="string">â€¢	æ ‡ç­¾æ”¾ç½®æ¡å½¢å›¾å³ä¾§ï¼Œæ˜¾ç¤ºå®Œå…¨ï¼Œä¸èƒ½è¢«é®æŒ¡ï¼ˆ1åˆ†ï¼‰</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">data2 = pd.read_csv(<span class="string">&#x27;movie2.csv&#x27;</span>)</span><br><span class="line"></span><br><span class="line">data2[<span class="string">&#x27;genres&#x27;</span>] = data2[<span class="string">&#x27;genres&#x27;</span>].<span class="built_in">str</span>.split(<span class="string">&#x27;|&#x27;</span>)</span><br><span class="line">top5_genres = data2.explode(<span class="string">&#x27;genres&#x27;</span>).groupby(<span class="string">&#x27;genres&#x27;</span>).size().reset_index(name=<span class="string">&#x27;number&#x27;</span>)</span><br><span class="line"></span><br><span class="line">top5_res = top5_genres.nlargest(<span class="number">5</span>,columns=<span class="string">&#x27;number&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">genres	number</span></span><br><span class="line"><span class="string">6	Drama	2297</span></span><br><span class="line"><span class="string">3	Comedy	1722</span></span><br><span class="line"><span class="string">17	Thriller	1274</span></span><br><span class="line"><span class="string">0	Action	1154</span></span><br><span class="line"><span class="string">14	Romance	894</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">genres = top5_res[<span class="string">&#x27;genres&#x27;</span>]</span><br><span class="line">number = top5_res[<span class="string">&#x27;number&#x27;</span>]</span><br><span class="line"></span><br><span class="line">colors = [<span class="string">&#x27;#BCEE68&#x27;</span>, <span class="string">&#x27;#EBBDBF&#x27;</span>, <span class="string">&#x27;#D6A5DD&#x27;</span>, <span class="string">&#x27;#A020F0&#x27;</span>, <span class="string">&#x27;#76CBE8&#x27;</span>]</span><br><span class="line"></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»˜åˆ¶æ¡å½¢å›¾</span></span><br><span class="line">ax.barh(genres, number, color=colors, edgecolor=<span class="string">&#x27;grey&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ Unicodeå­—ç¬¦ä½œä¸ºè±¡å½¢å›¾ç‰‡</span></span><br><span class="line">symbols = [<span class="string">&#x27;âš”ï¸&#x27;</span>, <span class="string">&#x27;ğŸŒ&#x27;</span>, <span class="string">&#x27;ğŸ§™â€â™‚ï¸&#x27;</span>, <span class="string">&#x27;ğŸš€&#x27;</span>, <span class="string">&#x27;ğŸ°&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> a,b <span class="keyword">in</span> <span class="built_in">zip</span>(genres,number):</span><br><span class="line">    ax.text(b, a, symbols[i], va=<span class="string">&#x27;center&#x27;</span>, ha=<span class="string">&#x27;left&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">ax.set_xlabel(<span class="string">&#x27;æ•°é‡&#x27;</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">&#x27;ç”µå½±ç±»å‹&#x27;</span>)</span><br><span class="line">ax.set_title(<span class="string">&#x27;ç”µå½±ç±»å‹Top5&#x27;</span>)</span><br><span class="line">ax.spines[<span class="string">&#x27;right&#x27;</span>].set_visible(<span class="literal">False</span>)</span><br><span class="line">ax.spines[<span class="string">&#x27;top&#x27;</span>].set_visible(<span class="literal">False</span>)</span><br><span class="line">ax.yaxis.set_ticks_position(<span class="string">&#x27;left&#x27;</span>)</span><br><span class="line">ax.xaxis.set_ticks_position(<span class="string">&#x27;bottom&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<h1>æ¨¡å—Cï¼šæœºå™¨å­¦ä¹ </h1>
<blockquote>
<p>å››å¤©æŠŠæœºå™¨å­¦ä¹ çš„å‡ ç§ç®—æ³•è¿‡äº†ä¸€éï¼Œéš¾ç‚¹åœ¨ç‰¹å¾å·¥ç¨‹ï¼Œå¯¹äºæ¨¡å‹çš„é€‰æ‹©åªéœ€è¦æ˜ç™½æ˜¯å›å½’ï¼Œåˆ†ç±»è¿˜æ˜¯èšç±»å°±å¥½äº†ï¼Œå¦å¤–å°±æ˜¯å¯¹äºç‰¹å¾å€¼å’Œç›®æ ‡å€¼çš„æå–éœ€è¦æ³¨æ„ï¼Œç”±äºæ²¡æœ‰æ•°æ®ç»ƒï¼Œåªèƒ½æ‰¾bç«™çš„å‡ ä¸ªæ•°æ®ç»ƒäº†</p>
</blockquote>
<h2 id="ç‰¹å¾å·¥ç¨‹">ç‰¹å¾å·¥ç¨‹</h2>
<h3 id="ç‰¹å¾æå–">ç‰¹å¾æå–</h3>
<p>API</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sklearn.feature_extraction</span><br></pre></td></tr></table></figure>
<h4 id="1ã€å­—å…¸ç‰¹å¾æå–">1ã€å­—å…¸ç‰¹å¾æå–</h4>
<p>éœ€è¦å…ˆå°†æ•°æ®è½¬æ¢æˆå­—å…¸ç±»å‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è½¬æ¢æˆå­—å…¸</span></span><br><span class="line">x = x.to_dict(orient=<span class="string">&quot;recorda&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>éœ€è¦æ³¨æ„çš„æ˜¯è°ƒç”¨è½¬æ¢å™¨ä¹‹åè¿”å›çš„æ˜¯ç¨€ç–çŸ©é˜µï¼Œè¿™é‡Œsparseéœ€è¦è®¾ç½®æˆfalseæ‰ä¸ä¼šè¿”å›sparse</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> feature_extraction <span class="keyword">as</span> fe</span><br><span class="line"></span><br><span class="line">data = [&#123;<span class="string">&#x27;city&#x27;</span>:<span class="string">&#x27;bj&#x27;</span>, <span class="string">&#x27;tem&#x27;</span>:<span class="number">100</span>&#125;,</span><br><span class="line">       &#123;<span class="string">&#x27;city&#x27;</span>:<span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;tem&#x27;</span>:<span class="number">300</span>&#125;,</span><br><span class="line">       &#123;<span class="string">&#x27;city&#x27;</span>:<span class="string">&#x27;sd&#x27;</span>, <span class="string">&#x27;tem&#x27;</span>:<span class="number">50</span>&#125;]</span><br><span class="line">transfer = fe.DictVectorizer(sparse=<span class="literal">False</span>)		<span class="comment"># éœ€è¦è®¾ç½®æˆFalse</span></span><br><span class="line">data_new = transfer.fit_transform(data)</span><br><span class="line">data_new</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">array([[  1.,   0.,   0., 100.],</span></span><br><span class="line"><span class="string">       [  0.,   0.,   1., 300.],</span></span><br><span class="line"><span class="string">       [  0.,   1.,   0.,  50.]])</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<h4 id="2ã€æ–‡æœ¬ç‰¹å¾æå–">2ã€æ–‡æœ¬ç‰¹å¾æå–</h4>
<ul>
<li>
<p>è‹±æ–‡æ–‡æœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> feature_extraction <span class="keyword">as</span> fe</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–‡æœ¬ç‰¹å¾æå–</span></span><br><span class="line">data = [<span class="string">&quot;Lift is short, i like python&quot;</span>,</span><br><span class="line">       <span class="string">&quot;Lift is too long, i dislike sleep&quot;</span>]</span><br><span class="line">transfer = fe.text.CountVectorizer()</span><br><span class="line">data_new = transfer.fit_transform(data)</span><br><span class="line"><span class="built_in">print</span>(data_new.toarray())</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">[[0 1 1 1 0 1 1 0 0]</span></span><br><span class="line"><span class="string"> [1 1 1 0 1 0 0 1 1]]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>ä¸­æ–‡æ–‡æœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸­æ–‡æ–‡æœ¬æå–</span></span><br><span class="line"><span class="keyword">import</span> jieba</span><br><span class="line">data = [<span class="string">&#x27;æˆ‘çˆ±åŒ—äº¬å¤©å®‰é—¨&#x27;</span>, <span class="string">&#x27;å¤©å®‰é—¨ä¸Šå¤ªé˜³å‡&#x27;</span>]</span><br><span class="line">data_new = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    data_new.append(<span class="string">&quot; &quot;</span>.join(<span class="built_in">list</span>(jieba.cut(i))))</span><br><span class="line">data_new</span><br><span class="line">transfer = fe.text.CountVectorizer()</span><br><span class="line">data_final = transfer.fit_transform(data_new)</span><br><span class="line">data_final.toarray()</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">array([[1, 1, 0],</span></span><br><span class="line"><span class="string">       [0, 1, 1]], dtype=int64)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>3ã€TF-IDF</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># TFidfæ–‡æœ¬æå–</span></span><br><span class="line">fe.text.TfidfVectorizer().fit_transform(data_new).toarray()</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">array([[0.81480247, 0.57973867, 0.        ],</span></span><br><span class="line"><span class="string">       [0.        , 0.57973867, 0.81480247]])</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="ç‰¹å¾é™ç»´">ç‰¹å¾é™ç»´</h3>
<p>é™ç»´æ˜¯æŒ‡åœ¨æŸäº›é™å®šæ¡ä»¶ä¸‹ï¼Œé™ä½éšæœºå˜é‡(ç‰¹å¾)çš„ä¸ªæ•°ï¼Œå¾—åˆ°ä¸€ç»„&quot;ä¸æƒ³å…³&quot;ä¸»å˜é‡çš„è¿‡ç¨‹å¤§è‡´å°±æ˜¯æˆ‘å¦‚æœæœ‰ä¸‰ä¸ªç‰¹å¾ï¼Œä½†æ˜¯è¿™ä¸‰ä¸ªç‰¹å¾ä¹‹ä¸­æœ‰ä¸¤ä¸ªç›¸å…³ç³»æ•°éå¸¸å¤§ï¼Œå°±é€‰æ‹©è¿™ä¸¤è€…ä¹‹ä¸€</p>
<p>é™ç»´ä¹‹å‰è¦æ³¨æ„æˆ‘æ‰€æœ‰çš„åˆ—æ˜¯ç±»ä¼¼ont-hotä¸€æ ·çš„ç¼–ç æ ¼å¼ï¼Œä¸èƒ½å‡ºç°è‹±æ–‡æˆ–è€…ä¸­æ–‡</p>
<p>==<strong>é™ç»´æ–¹å¼</strong>==</p>
<ul>
<li>ç‰¹å¾é€‰æ‹©</li>
<li>ä¸»æˆåˆ†åˆ†æï¼ˆå¯ä»¥ç†è§£ä¸€ç§ç‰¹å¾æå–çš„æ–¹å¼ï¼‰</li>
</ul>
<h4 id="1ã€ç‰¹å¾é€‰æ‹©">1ã€ç‰¹å¾é€‰æ‹©</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Filterè¿‡æ»¤å¼</span><br><span class="line">- æ–¹å·®é€‰æ‹©æ³•ï¼šåœ°æ–¹æŸ¥ç‰¹å¾è¿‡æ»¤</span><br><span class="line">- ç›¸å…³ç³»æ•°</span><br><span class="line">  - è¡¡é‡ç‰¹å¾ä¸ç‰¹å¾ä¹‹é—´çš„ç›¸å…³æ€§</span><br><span class="line"></span><br><span class="line">EmbededåµŒå…¥å¼</span><br><span class="line">- å†³ç­–æ ‘</span><br><span class="line">- æ­£åˆ™åŒ–</span><br><span class="line">- æ·±åº¦å­¦ä¹ </span><br></pre></td></tr></table></figure>
<p>==<strong>è¿‡æ»¤å¼</strong>==</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn.feature_selection <span class="keyword">import</span> VarianceThreshold</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">variance_demo</span>():</span><br><span class="line">    data = pd.read_csv(<span class="string">r&quot;E:\Code\Pywork\Machine\data\factor_returns.csv&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;data:\n&quot;</span>,data)</span><br><span class="line">    data = data.iloc[:, <span class="number">1</span>:-<span class="number">2</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;data:\n&quot;</span>,data)</span><br><span class="line">    <span class="comment"># è¿™é‡Œçš„thresholdæ˜¯é˜ˆå€¼å¤§äºå®ƒçš„å°±ä¼šè¢«åˆ å»</span></span><br><span class="line">    transfer = VarianceThreshold(threshold=<span class="number">5</span>)</span><br><span class="line">    data_new = transfer.fit_transform(data)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;data_new:\n&quot;</span>, data_new, data_new.shape)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    variance_demo()</span><br></pre></td></tr></table></figure>
<p>==<strong>ç›¸å…³ç³»æ•°</strong>==</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn.feature_selection <span class="keyword">import</span> VarianceThreshold</span><br><span class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> pearsonr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">variance_demo</span>():</span><br><span class="line">    data = pd.read_csv(<span class="string">r&quot;E:\Code\Pywork\Machine\data\factor_returns.csv&quot;</span>)</span><br><span class="line">    data = data.iloc[:, <span class="number">1</span>:-<span class="number">2</span>]</span><br><span class="line">    r = pearsonr(data[<span class="string">&#x27;pe_ratio&#x27;</span>],data[<span class="string">&#x27;pb_ratio&#x27;</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ç›¸å…³ç³»æ•°:&quot;</span>,r)</span><br><span class="line"><span class="comment">#     ç›¸å…³ç³»æ•°: PearsonRResult(statistic=-0.004389322779936274, pvalue=0.8327205496564927)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    variance_demo()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="2ã€ä¸»æˆåˆ†åˆ†æ-PCA">2ã€ä¸»æˆåˆ†åˆ†æ(PCA)</h4>
<p>é«˜ç»´è½¬ä½ç»´</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sklearn.decomposition.<span class="keyword">PCA</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>äº¤å‰è¡¨ä½¿ç”¨: table = pd.crosstab(data[â€˜user_idâ€™],data[â€˜aisleâ€™])</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;array([[0.81480247, 0.57973867, 0.        ],</span></span><br><span class="line"><span class="string">       [0.        , 0.57973867, 0.81480247]])&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> decomposition <span class="keyword">as</span> sd</span><br><span class="line">transfer = sd.PCA(n_components=<span class="number">0.95</span>)	<span class="comment">#å°æ•°è¡¨ç¤ºä¿ç•™å¤šå°‘åŸå§‹ä¿¡æ¯ï¼Œæ•´æ•°è¡¨ç¤ºè·å–åˆ°å‡ ç»´æ•°æ®</span></span><br><span class="line">data_new = transfer.fit_transform(data2)</span><br><span class="line"><span class="built_in">print</span>(data_new)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">[[ 0.57615236]</span></span><br><span class="line"><span class="string"> [-0.57615236]]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="è°ƒä¼˜">è°ƒä¼˜</h3>
<h4 id="ç½‘æ ¼æœç´¢å’Œäº¤å‰éªŒè¯">ç½‘æ ¼æœç´¢å’Œäº¤å‰éªŒè¯</h4>
<p>API</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> model_selection <span class="keyword">as</span> ms</span><br><span class="line">ms.GridSearchCV(model,param_grid=xxx,cv=xxx)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets <span class="keyword">as</span> sd</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> model_selection <span class="keyword">as</span> ms</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing <span class="keyword">as</span> sp</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> neighbors <span class="keyword">as</span> sn</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> metrics <span class="keyword">as</span> sm</span><br><span class="line"><span class="keyword">from</span> sklearn.decomposition <span class="keyword">import</span> PCA</span><br><span class="line"></span><br><span class="line">iris = sd.load_iris()</span><br><span class="line">transfer = PCA(n_components=<span class="number">0.95</span>)</span><br><span class="line"></span><br><span class="line">x = iris.data</span><br><span class="line">y = iris.target</span><br><span class="line"></span><br><span class="line">x = transfer.fit_transform(x)</span><br><span class="line"></span><br><span class="line">train_x, test_x, train_y, test_y = ms.train_test_split(x, y, shuffle=<span class="literal">True</span>, random_state=<span class="number">5</span>, train_size=<span class="number">0.75</span>)</span><br><span class="line"></span><br><span class="line">transfer = sp.StandardScaler()</span><br><span class="line">train_x = transfer.fit_transform(train_x)</span><br><span class="line">test_x = transfer.transform(test_x</span><br><span class="line">                            </span><br><span class="line">model = sn.KNeighborsClassifier()</span><br><span class="line">                            </span><br><span class="line">ms.GridSearchCV(model,param_grid=&#123;<span class="string">&quot;n_neighbors&quot;</span>:&#123;<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">11</span>&#125;&#125;,cv=<span class="number">20</span>)</span><br><span class="line">model.fit(train_x, train_y)</span><br><span class="line">pred_y = model.predict(test_x)</span><br><span class="line">                            </span><br><span class="line">sm.f1_score(test_y, pred_y, average=<span class="string">&#x27;micro&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="æ•°æ®é¢„å¤„ç†">æ•°æ®é¢„å¤„ç†</h3>
<h4 id="1ã€å‡å€¼ç§»é™¤-æ ‡å‡†å·®æ ‡å‡†åŒ–">1ã€<strong>å‡å€¼ç§»é™¤ (æ ‡å‡†å·®æ ‡å‡†åŒ–)</strong></h4>
<blockquote>
<p>ç”±äºä¸€ä¸ªæ ·æœ¬çš„ä¸åŒç‰¹å¾å€¼å·®å¼‚è¾ƒå¤§ï¼Œä¸åˆ©äºä½¿ç”¨ç°æœ‰æœºå™¨å­¦ä¹ ç®—æ³•è¿›è¡Œæ ·æœ¬å¤„ç†ã€‚<br>
æ ‡å‡†å·®æ ‡å‡†åŒ–ä¹Ÿå«é›¶å‡å€¼æ ‡å‡†åŒ–æˆ–åˆ†æ•°æ ‡å‡†åŒ–ï¼Œæ˜¯å½“å‰ä½¿ç”¨æœ€å¹¿æ³›çš„æ•°æ®æ ‡å‡†åŒ–æ–¹æ³•ã€‚ç»è¿‡è¯¥æ–¹æ³•å¤„ç†çš„æ•°æ®å‡å€¼ç§»é™¤å¯ä»¥è®©æ ·æœ¬çŸ©é˜µä¸­çš„æ¯ä¸€åˆ—çš„å¹³å‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1ã€‚<br>
å¦‚ä½•ä½¿æ ·æœ¬çŸ©é˜µä¸­çš„æ¯ä¸€åˆ—çš„å¹³å‡å€¼ä¸º0å‘¢ï¼Ÿ</p>
</blockquote>
<p>$$<br>
X* = ï¼ˆX-meanï¼‰/ std<br>
$$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> sklearn.preprocessing <span class="keyword">as</span> sp</span><br><span class="line"></span><br><span class="line">arr01 = np.array([</span><br><span class="line">    [<span class="number">17</span>, <span class="number">100</span>, <span class="number">4000</span>],</span><br><span class="line">    [<span class="number">20</span>, <span class="number">80</span>, <span class="number">5000</span>],</span><br><span class="line">    [<span class="number">23</span>, <span class="number">75</span>, <span class="number">5500</span>]</span><br><span class="line">])</span><br><span class="line">arr01</span><br><span class="line"><span class="comment"># è°ƒç”¨ç±»ï¼Œç”Ÿæˆå®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">scaler = sp.StandardScaler()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…ˆè°ƒç”¨fit, å†è°ƒç”¨transform()</span></span><br><span class="line">scaler.fit(arr01).transform(arr01)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è°ƒç”¨fit_transform()</span></span><br><span class="line">std_samples = scaler.fit_transform(arr01)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">array([[-1.22474487,  1.38873015, -1.33630621],</span></span><br><span class="line"><span class="string">       [ 0.        , -0.46291005,  0.26726124],</span></span><br><span class="line"><span class="string">       [ 1.22474487, -0.9258201 ,  1.06904497]])</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€†è½¬</span></span><br><span class="line">scaler.inverse_transform(std_samples)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è°ƒç”¨æ–¹æ³•</span></span><br><span class="line">sp.scale(arr01)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªå®šä¹‰ç®—æ³•</span></span><br><span class="line">array01_mean = arr01.mean(axis=<span class="number">0</span>)</span><br><span class="line">arr01_new = (arr01-array01_mean)/arr01.std(axis=<span class="number">0</span>)</span><br><span class="line">arr01_new.mean(axis=<span class="number">0</span>)</span><br><span class="line">arr01_new.std(axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">sklearn</span>.preprocessing.StandardScaler(*, copy=<span class="literal">True</span>, with_mean=<span class="literal">True</span>, with_std=<span class="literal">True</span>)</span><br><span class="line">å‚æ•°ï¼š</span><br><span class="line">with_meanï¼š<span class="built_in">bool</span>, default=<span class="literal">True</span>ï¼šå¦‚æœä¸º<span class="literal">True</span>ï¼Œåˆ™åœ¨ç¼©æ”¾ä¹‹å‰å°†æ•°æ®å±…ä¸­ã€‚è¿™åœ¨æ“ä½œç¨€ç–çŸ©é˜µæ—¶ä¸èµ·ä½œç”¨ï¼ˆå¹¶ä¸”ä¼šå¼•å‘ä¸€ä¸ªå¼‚å¸¸ï¼‰ï¼Œå› ä¸ºå°†å®ƒä»¬å±…ä¸­éœ€è¦æ„å»ºä¸€ä¸ªå¯†é›†çŸ©é˜µï¼Œåœ¨å¸¸è§çš„ç”¨ä¾‹ä¸­ï¼Œå¯†é›†çŸ©é˜µå¯èƒ½å¤ªå¤§è€Œæ— æ³•å®¹çº³åœ¨å†…å­˜ä¸­ã€‚</span><br><span class="line">with_stdï¼š<span class="built_in">bool</span>, default=<span class="literal">True</span>ï¼šå¦‚æœä¸º<span class="literal">True</span>ï¼Œåˆ™å°†æ•°æ®ç¼©æ”¾ä¸ºå•ä½æ–¹å·®ï¼ˆæˆ–ç­‰æ•ˆçš„å•ä½æ ‡å‡†å·®ï¼‰ã€‚</span><br><span class="line">å±æ€§ï¼š</span><br><span class="line">scale_ ï¼šndarray of shape (n_features,) <span class="keyword">or</span> <span class="literal">None</span>ï¼šæ•°æ®çš„æ¯ä¸ªç‰¹å¾ç›¸å¯¹ç¼©æ”¾ï¼Œä»¥å®ç°é›¶å‡å€¼å’Œå•ä½æ–¹å·®ã€‚é€šå¸¸ä½¿ç”¨np.sqrtï¼ˆvarï¼‰è®¡ç®—ã€‚å¦‚æœæ–¹å·®ä¸ºé›¶ï¼Œæˆ‘ä»¬æ— æ³•å®ç°å•ä½æ–¹å·®ï¼Œæ•°æ®ä¿æŒåŸæ ·ï¼Œç»™å‡ºç¼©æ”¾å› å­<span class="number">1</span>ã€‚å½“with_std=<span class="literal">False</span>æ—¶ï¼Œscale_ç­‰äº<span class="literal">None</span>ã€‚</span><br><span class="line">mean_ ï¼šndarray of shape (n_features,) <span class="keyword">or</span> <span class="literal">None</span> ï¼šè®­ç»ƒé›†ä¸­æ¯ä¸ªç‰¹å¾çš„å¹³å‡å€¼ã€‚å½“_mean=<span class="literal">False</span>æ—¶ï¼Œç­‰äº<span class="literal">None</span>ã€‚</span><br><span class="line">var_ ï¼šndarray of shape (n_features,) <span class="keyword">or</span> <span class="literal">None</span>ï¼šè®­ç»ƒé›†ä¸­æ¯ä¸ªç‰¹å¾çš„æ–¹å·®ã€‚ç”¨äºè®¡ç®—scale_ ã€‚å½“std=<span class="literal">False</span>æ—¶ï¼Œç­‰äº<span class="literal">None</span>ã€‚</span><br><span class="line">ç¤ºä¾‹ï¼š</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data = [[<span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0</span>], [<span class="number">1</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">1</span>]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>scaler = StandardScaler()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(scaler.fit(data))</span><br><span class="line">StandardScaler()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(scaler.mean_)</span><br><span class="line">[<span class="number">0.5</span> <span class="number">0.5</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(scaler.transform(data))</span><br><span class="line">[[-<span class="number">1.</span> -<span class="number">1.</span>]</span><br><span class="line"> [-<span class="number">1.</span> -<span class="number">1.</span>]</span><br><span class="line"> [ <span class="number">1.</span>  <span class="number">1.</span>]</span><br><span class="line"> [ <span class="number">1.</span>  <span class="number">1.</span>]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(scaler.transform([[<span class="number">2</span>, <span class="number">2</span>]]))</span><br><span class="line">[[<span class="number">3.</span> <span class="number">3.</span>]]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="2ã€èŒƒå›´ç¼©æ”¾ï¼ˆç¦»å·®æ ‡å‡†åŒ–ï¼‰">2ã€<strong>èŒƒå›´ç¼©æ”¾ï¼ˆç¦»å·®æ ‡å‡†åŒ–ï¼‰</strong></h4>
<blockquote>
<p>å¦ä¸€ç§æ ‡å‡†åŒ–æ–¹æ³•æ˜¯å°†ç‰¹å¾ç¼©æ”¾åˆ°ç»™å®šçš„æœ€å°å€¼å’Œæœ€å¤§å€¼ä¹‹é—´ï¼Œé€šå¸¸ä»‹äº0å’Œ1ä¹‹é—´ï¼Œæˆ–è€…å°†æ¯ä¸ªç‰¹å¾çš„æœ€å¤§ç»å¯¹å€¼ç¼©æ”¾åˆ°å•ä½å¤§å°ã€‚è¿™å¯ä»¥åˆ†åˆ«ä½¿ç”¨MinMaxScaleræˆ–MaxAbsScalerå®ç°ã€‚ä½¿ç”¨è¿™ç§ç¼©æ”¾çš„åŠ¨æœºåŒ…æ‹¬å¯¹éå¸¸å°çš„ç‰¹å¾æ ‡å‡†å·®çš„é²æ£’æ€§ï¼Œä»¥åŠåœ¨ç¨€ç–æ•°æ®ä¸­ä¿æŒé›¶æ¡ç›®ã€‚</p>
<p>å°†æ ·æœ¬çŸ©é˜µä¸­çš„æ¯ä¸€åˆ—çš„æœ€å°å€¼å’Œæœ€å¤§å€¼è®¾å®šä¸ºç›¸åŒçš„åŒºé—´ï¼Œç»Ÿä¸€å„åˆ—ç‰¹å¾å€¼çš„èŒƒå›´ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ä¼šæŠŠç‰¹å¾å€¼ç¼©æ”¾è‡³[0, 1]åŒºé—´ã€‚</p>
<p>ç¦»å·®æ ‡å‡†åŒ–æ˜¯å¯¹åŸå§‹æ•°æ®çš„ä¸€ç§çº¿æ€§å˜æ¢ï¼Œç»“æœæ˜¯å°†åŸå§‹æ•°æ®çš„æ•°å€¼æ˜ å°„åˆ°[0,1]åŒºé—´ä¹‹é—´ã€‚<br>
$$<br>
X^*=(X-min)/(max-min)<br>
$$<br>
å…¶ä¸­maxä¸ºæ ·æœ¬æ•°æ®çš„æœ€å¤§å€¼ï¼Œmin ä¸ºæ ·æœ¬æ•°æ®çš„æœ€å°å€¼ï¼Œmax-minä¸ºæå·®ã€‚ç¦»å·®æ ‡å‡†åŒ–ä¿ç•™äº†åŸå§‹æ•°æ®å€¼ä¹‹é—´çš„è”ç³»ï¼Œæ˜¯æ¶ˆé™¤é‡çº²å’Œæ•°æ®å–å€¼èŒƒå›´å½±å“æœ€ç®€å•çš„æ–¹æ³•ã€‚</p>
<p>ç¦»å·®æ ‡å‡†åŒ–çš„ç‰¹ç‚¹ï¼š</p>
<p>æ•°æ®çš„æ•´ä½“åˆ†å¸ƒæƒ…å†µå¹¶ä¸ä¼šéšç¦»å·®æ ‡å‡†åŒ–è€Œå‘ç”Ÿæ”¹å˜ï¼ŒåŸå…ˆå–å€¼è¾ƒå¤§çš„æ•°æ®ï¼Œåœ¨åšå®Œç¦»å·®æ ‡å‡†åŒ–åçš„å€¼ä¾æ—§è¾ƒå¤§ã€‚</p>
<p>å½“æ•°æ®å’Œæœ€å°å€¼ç›¸ç­‰çš„æ—¶å€™ï¼Œé€šè¿‡ç¦»å·®æ ‡å‡†åŒ–å¯ä»¥å‘ç°æ•°æ®å˜ä¸º0ã€‚</p>
<p>åŒæ—¶ï¼Œè¿˜å¯ä»¥çœ‹å‡ºç¦»å·®æ ‡å‡†åŒ–çš„ç¼ºç‚¹ï¼šè‹¥æ•°æ®é›†ä¸­æŸä¸ªæ•°å€¼å¾ˆå¤§ï¼Œåˆ™ç¦»å·®æ ‡å‡†åŒ–çš„å€¼å°±ä¼šæ¥è¿‘äº0ï¼Œå¹¶ä¸”ç›¸äº’ä¹‹é—´å·®åˆ«ä¸å¤§ã€‚è‹¥å°†æ¥é‡åˆ°è¶…è¿‡ç›®å‰å±æ€§[min,max]å–å€¼èŒƒå›´çš„æ—¶å€™ï¼Œä¼šå¼•èµ·ç³»ç»Ÿå‡ºé”™ï¼Œè¿™æ—¶ä¾¿éœ€è¦é‡æ–°ç¡®å®šminå’Œmaxã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">scaler = sp.MinMaxScaler()</span><br><span class="line"><span class="comment"># è°ƒç”¨fit_transform</span></span><br><span class="line">scaler.fit_transform(arr01)</span><br><span class="line"><span class="comment"># æ‰‹å†™</span></span><br><span class="line">max_ = arr01.<span class="built_in">max</span>(axis=<span class="number">0</span>)</span><br><span class="line">min_ = arr01.<span class="built_in">min</span>(axis=<span class="number">0</span>)</span><br><span class="line">(arr01 - min_) / (max_ - min_)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">array([[0.        , 1.        , 0.        ],</span></span><br><span class="line"><span class="string">       [0.5       , 0.2       , 0.66666667],</span></span><br><span class="line"><span class="string">       [1.        , 0.        , 1.        ]])</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<h4 id="3ã€å¼‚å¸¸å€¼ç¼©æ”¾æ•°æ®">3ã€<strong>å¼‚å¸¸å€¼ç¼©æ”¾æ•°æ®</strong></h4>
<blockquote>
<p>å¦‚æœæ•°æ®ä¸­åŒ…å«äº†è®¸å¤šå¼‚å¸¸å€¼ï¼Œé‚£ä¹ˆä½¿ç”¨æ•°æ®çš„å‡å€¼å’Œæ–¹å·®è¿›è¡Œç¼©æ”¾å¯èƒ½ä¸ä¼šå¾ˆå¥½åœ°å·¥ä½œã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨RobustScalerä½œä¸ºæ›¿ä»£å“ã€‚å®ƒå¯¹æ•°æ®çš„ä¸­å¿ƒå’ŒèŒƒå›´ä½¿ç”¨äº†æ›´å¯é çš„ä¼°è®¡ã€‚</p>
<p>ä½¿ç”¨å¯¹å¼‚å¸¸å€¼å…·æœ‰é²æ£’æ€§çš„ç»Ÿè®¡æ•°æ®æ¥ç¼©æ”¾ç‰¹å¾ã€‚</p>
<p>æ­¤ç¼©æ”¾å™¨åˆ é™¤ä¸­å€¼ï¼Œå¹¶æ ¹æ®åˆ†ä½æ•°èŒƒå›´ï¼ˆé»˜è®¤ä¸ºIQRï¼šå››åˆ†ä½æ•°èŒƒå›´ï¼‰ç¼©æ”¾æ•°æ®ã€‚IQRæ˜¯ç¬¬ä¸€ä¸ªå››åˆ†ä½æ•°ï¼ˆç¬¬25åˆ†ä½æ•°ï¼‰å’Œç¬¬ä¸‰ä¸ªå››åˆ†ä½ï¼ˆç¬¬75åˆ†ä½æ•°ï¼‰ä¹‹é—´çš„èŒƒå›´ã€‚é€šè¿‡è®¡ç®—è®­ç»ƒé›†ä¸­æ ·æœ¬çš„ç›¸å…³ç»Ÿè®¡ä¿¡æ¯ï¼Œå¯¹æ¯ä¸ªç‰¹å¾è¿›è¡Œå±…ä¸­å’Œç¼©æ”¾ã€‚ç„¶åå­˜å‚¨ä¸­å€¼å’Œå››åˆ†ä½é—´è·ï¼Œä»¥ä¾¿ä½¿ç”¨è½¬æ¢æ–¹æ³•ç”¨äºåç»­æ•°æ®ã€‚</p>
<p>æ•°æ®é›†çš„æ ‡å‡†åŒ–æ˜¯è®¸å¤šæœºå™¨å­¦ä¹ ä¼°è®¡å™¨çš„å…±åŒè¦æ±‚ã€‚é€šå¸¸ï¼Œè¿™æ˜¯é€šè¿‡å»é™¤å¹³å‡å€¼å¹¶ç¼©æ”¾åˆ°å•ä½æ–¹å·®æ¥å®ç°çš„ã€‚ç„¶è€Œï¼Œå¼‚å¸¸å€¼é€šå¸¸ä¼šä»¥è´Ÿé¢æ–¹å¼å½±å“æ ·æœ¬å‡å€¼/æ–¹å·®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸­å€¼å’Œå››åˆ†ä½æ•°èŒƒå›´é€šå¸¸ä¼šç»™å‡ºæ›´å¥½çš„ç»“æœã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">scaler = sp.RobustScaler()</span><br><span class="line">scaler.fit_transform(arr01)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">array([[-1.        ,  1.6       , -1.33333333],</span></span><br><span class="line"><span class="string">       [ 0.        ,  0.        ,  0.        ],</span></span><br><span class="line"><span class="string">       [ 1.        , -0.4       ,  0.66666667]])</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<h4 id="4ã€å½’ä¸€åŒ–">4ã€<strong>å½’ä¸€åŒ–</strong></h4>
<blockquote>
<p>å½’ä¸€åŒ–/æ ‡å‡†åŒ–å¯ä»¥å»é™¤æ•°æ®å•ä½å¯¹è®¡ç®—å¸¦æ¥çš„å½±å“ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„å»é‡çº²è¡Œä¸ºï¼Œå½’ä¸€åŒ–/æ ‡å‡†åŒ–å®è´¨æ˜¯ä¸€ç§çº¿æ€§å˜æ¢ï¼Œçº¿æ€§å˜æ¢æœ‰å¾ˆå¤šè‰¯å¥½çš„æ€§è´¨ï¼Œè¿™äº›æ€§è´¨å†³å®šäº†å¯¹æ•°æ®æ”¹å˜åä¸ä¼šé€ æˆâ€œå¤±æ•ˆâ€ï¼Œåè€Œèƒ½æé«˜æ•°æ®çš„è¡¨ç°ï¼Œè¿™äº›æ€§è´¨æ˜¯å½’ä¸€åŒ–/æ ‡å‡†åŒ–çš„å‰æã€‚</p>
<p>å½’ä¸€åŒ–/æ ‡å‡†åŒ–çš„å»é‡çº²ä½œç”¨èƒ½å¤Ÿå¸¦æ¥ä»¥ä¸‹ä¸¤ä¸ªå¥½å¤„ï¼š</p>
<p>1ï¼‰æå‡æ¨¡å‹çš„ç²¾åº¦ã€‚ä¸€äº›åˆ†ç±»å™¨éœ€è¦è®¡ç®—æ ·æœ¬ä¹‹é—´çš„è·ç¦»ï¼ˆå¦‚æ¬§æ°è·ç¦»ï¼‰ï¼Œä¾‹å¦‚KNNã€‚å¦‚æœä¸€ä¸ªç‰¹å¾å€¼åŸŸèŒƒå›´éå¸¸å¤§ï¼Œé‚£ä¹ˆè·ç¦»è®¡ç®—å°±ä¸»è¦å–å†³äºè¿™ä¸ªç‰¹å¾ï¼Œä»è€Œä¸å®é™…æƒ…å†µç›¸æ‚–ï¼ˆæ¯”å¦‚è¿™æ—¶å®é™…æƒ…å†µæ˜¯å€¼åŸŸèŒƒå›´å°çš„ç‰¹å¾æ›´é‡è¦ï¼‰ã€‚</p>
<p>2ï¼‰æé«˜æ”¶æ•›é€Ÿåº¦ã€‚å¯¹äºçº¿æ€§æ¨¡å‹æ¥è¯´ï¼Œæ•°æ®å½’ä¸€åŒ–/æ ‡å‡†åŒ–åï¼Œæœ€ä¼˜è§£çš„å¯»ä¼˜è¿‡ç¨‹æ˜æ˜¾ä¼šå˜å¾—å¹³ç¼“ï¼Œæ›´å®¹æ˜“æ­£ç¡®çš„æ”¶æ•›åˆ°æœ€ä¼˜è§£ã€‚</p>
<p>æœ‰äº›æƒ…å†µæ¯ä¸ªæ ·æœ¬çš„æ¯ä¸ªç‰¹å¾å€¼å…·ä½“çš„å€¼å¹¶ä¸é‡è¦ï¼Œä½†æ˜¯æ¯ä¸ªæ ·æœ¬ç‰¹å¾å€¼çš„å æ¯”æ›´åŠ é‡è¦ã€‚</p>
<table>
<thead>
<tr>
<th></th>
<th>åŠ¨ä½œ</th>
<th>çˆ±æƒ…</th>
<th>ç§‘å¹»</th>
</tr>
</thead>
<tbody>
<tr>
<td>å°æ˜</td>
<td>20</td>
<td>10</td>
<td>5</td>
</tr>
<tr>
<td>å°ç‹</td>
<td>4</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>å°æ</td>
<td>15</td>
<td>11</td>
<td>13</td>
</tr>
</tbody>
</table>
<p>æ‰€ä»¥å½’ä¸€åŒ–å³æ˜¯ç”¨æ¯ä¸ªæ ·æœ¬çš„æ¯ä¸ªç‰¹å¾å€¼é™¤ä»¥è¯¥æ ·æœ¬å„ä¸ªç‰¹å¾å€¼ç»å¯¹å€¼çš„æ€»å’Œã€‚å˜æ¢åçš„æ ·æœ¬çŸ©é˜µï¼Œæ¯ä¸ªæ ·æœ¬çš„ç‰¹å¾å€¼ç»å¯¹å€¼ä¹‹å’Œä¸º1ã€‚</p>
<p>å°†æ ·æœ¬å•ç‹¬å½’ä¸€åŒ–ä¸ºå•ä½èŒƒæ•°ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">APIï¼š</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">sklearn</span>.preprocessing.Normalizer(norm=<span class="string">&#x27;l2&#x27;</span>, *, copy=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">å‚æ•°ï¼š</span><br><span class="line"></span><br><span class="line">normï¼š&#123;â€˜l1â€™, â€˜l2â€™, â€˜<span class="built_in">max</span>â€™&#125;, default=â€™l2â€™ï¼šç”¨äºæ ‡å‡†åŒ–æ¯ä¸ªéé›¶æ ·æœ¬çš„èŒƒæ•°ã€‚å¦‚æœä½¿ç”¨norm=<span class="string">&#x27;max&#x27;</span>ï¼Œåˆ™å€¼å°†æŒ‰ç»å¯¹å€¼çš„æœ€å¤§å€¼é‡æ–°ç¼©æ”¾ã€‚</span><br><span class="line"></span><br><span class="line">è¿™é‡Œï¼š l1 æ˜¯æ›¼å“ˆé¡¿è·ç¦»		l2 æ˜¯æ¬§å‡ é‡Œå¾—è·ç¦»</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">copyï¼š<span class="built_in">bool</span>, default=<span class="literal">True</span>ï¼šè®¾ç½®ä¸º<span class="literal">False</span>ä»¥æ‰§è¡Œåœ¨ä½è¡Œè§„èŒƒåŒ–å¹¶é¿å…å¤åˆ¶ï¼ˆå¦‚æœè¾“å…¥å·²ç»æ˜¯numpyæ•°ç»„æˆ–scipy.sparse CSRçŸ©é˜µï¼‰ã€‚</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">scaler = sp.Normalizer(norm=<span class="string">&#x27;l2&#x27;</span>)</span><br><span class="line">scaler.fit_transform(arr01)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">array([[0.00424863, 0.02499197, 0.99967862],</span></span><br><span class="line"><span class="string">       [0.00399946, 0.01599782, 0.99986403],</span></span><br><span class="line"><span class="string">       [0.00418139, 0.01363498, 0.9998983 ]])</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">scaler1 = sp.Normalizer(norm=<span class="string">&#x27;l1&#x27;</span>)</span><br><span class="line">scaler1.fit_transform(arr01)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">array([[0.00412922, 0.02428953, 0.97158125],</span></span><br><span class="line"><span class="string">       [0.00392157, 0.01568627, 0.98039216],</span></span><br><span class="line"><span class="string">       [0.00410861, 0.01339764, 0.98249375]])</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<h4 id="5ã€äºŒå€¼åŒ–">5ã€äºŒå€¼åŒ–</h4>
<blockquote>
<p>æœ‰äº›ä¸šåŠ¡å¹¶ä¸éœ€è¦åˆ†æçŸ©é˜µçš„è¯¦ç»†å®Œæ•´æ•°æ®ï¼ˆæ¯”å¦‚å›¾åƒè¾¹ç¼˜è¯†åˆ«åªéœ€è¦åˆ†æå‡ºå›¾åƒè¾¹ç¼˜å³å¯ï¼‰ï¼Œå¯ä»¥æ ¹æ®ä¸€ä¸ªäº‹å…ˆç»™å®šçš„é˜ˆå€¼ï¼Œç”¨0å’Œ1è¡¨ç¤ºç‰¹å¾å€¼ä¸é«˜äºæˆ–é«˜äºé˜ˆå€¼ã€‚äºŒå€¼åŒ–åçš„æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ é0å³1ï¼Œè¾¾åˆ°ç®€åŒ–æ•°å­¦æ¨¡å‹çš„ç›®çš„ã€‚å¤§äºé˜ˆå€¼çš„å€¼æ˜ å°„åˆ°1ï¼Œè€Œå°äºæˆ–ç­‰äºé˜ˆå€¼çš„å€¼åˆ™æ˜ å°„åˆ°0ã€‚é»˜è®¤é˜ˆå€¼ä¸º0æ—¶ï¼Œåªæœ‰æ­£å€¼æ˜ å°„åˆ°1ã€‚</p>
<p>äºŒå€¼åŒ–æ˜¯å¯¹æ–‡æœ¬è®¡æ•°æ•°æ®çš„ä¸€ç§å¸¸è§æ“ä½œï¼Œåˆ†æäººå‘˜å¯ä»¥å†³å®šåªè€ƒè™‘ç‰¹å¾çš„å­˜åœ¨æˆ–ä¸å­˜åœ¨ï¼Œè€Œä¸æ˜¯é‡åŒ–çš„å‡ºç°æ¬¡æ•°ã€‚å®ƒè¿˜å¯ä»¥ç”¨ä½œè€ƒè™‘å¸ƒå°”éšæœºå˜é‡çš„ä¼°è®¡å™¨çš„é¢„å¤„ç†æ­¥éª¤ï¼ˆä¾‹å¦‚ï¼Œåœ¨è´å¶æ–¯è®¾ç½®ä¸­ä½¿ç”¨ä¼¯åŠªåˆ©åˆ†å¸ƒå»ºæ¨¡ï¼‰ã€‚</p>
<p>APIï¼š</p>
<p>class sklearn.preprocessing.Binarizer(*, threshold=0.0, copy=True)</p>
<p>å‚æ•°ï¼š</p>
<p><code>thresholdï¼šfloat</code>, default=0.0ï¼šä½äºæˆ–ç­‰äºæ­¤çš„ç‰¹å¾å€¼ç”±0æ›¿æ¢ï¼Œé«˜äºæ­¤å€¼ç”±1æ›¿æ¢ã€‚å¯¹äºç¨€ç–çŸ©é˜µä¸Šçš„æ“ä½œï¼Œé˜ˆå€¼ä¸èƒ½å°äº0ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">scaler = sp.Binarizer(threshold=<span class="number">80</span>)</span><br><span class="line">scaler.fit_transform(arr01)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">array([[0, 1, 1],</span></span><br><span class="line"><span class="string">       [0, 0, 1],</span></span><br><span class="line"><span class="string">       [0, 0, 1]])</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<h4 id="6ã€ç‹¬çƒ­ç¼–ç ï¼ˆonehotï¼‰">6ã€ç‹¬çƒ­ç¼–ç ï¼ˆ<code>onehot</code>ï¼‰</h4>
<blockquote>
<p>å°†åˆ†ç±»ç‰¹å¾ç¼–ç ä¸ºä¸€ä¸ªçƒ­ç‚¹æ•°å­—æ•°ç»„ã€‚ä¸ºæ ·æœ¬ç‰¹å¾çš„æ¯ä¸ªå€¼å»ºç«‹ä¸€ä¸ªç”±ä¸€ä¸ª1å’Œè‹¥å¹²ä¸ª0ç»„æˆçš„åºåˆ—ï¼Œç”¨è¯¥åºåˆ—å¯¹æ‰€æœ‰çš„ç‰¹å¾å€¼è¿›è¡Œç¼–ç ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ä¸¤ä¸ªæ•°	ä¸‰ä¸ªæ•°	å››ä¸ªæ•°</span><br><span class="line"><span class="number">1</span>	<span class="number">3</span>	<span class="number">2</span></span><br><span class="line"><span class="number">7</span>	<span class="number">5</span>	<span class="number">4</span></span><br><span class="line"><span class="number">1</span>	<span class="number">8</span>	<span class="number">6</span></span><br><span class="line"><span class="number">7</span>	<span class="number">3</span>	<span class="number">9</span></span><br><span class="line">ä¸ºæ¯ä¸€ä¸ªæ•°å­—è¿›è¡Œç‹¬çƒ­ç¼–ç ï¼š</span><br><span class="line"><span class="number">1</span>-&gt;<span class="number">10</span>    <span class="number">3</span>-&gt;<span class="number">100</span>	  <span class="number">2</span>-&gt;<span class="number">1000</span></span><br><span class="line"><span class="number">7</span>-&gt;01    <span class="number">5</span>-&gt;<span class="number">0</span>10   <span class="number">4</span>-&gt;<span class="number">0</span>100</span><br><span class="line"><span class="number">8</span>-&gt;001   <span class="number">6</span>-&gt;<span class="number">00</span>10  <span class="number">9</span>-&gt;0001</span><br><span class="line">ç¼–ç å®Œæ¯•åå¾—åˆ°æœ€ç»ˆç»è¿‡ç‹¬çƒ­ç¼–ç åçš„æ ·æœ¬çŸ©é˜µï¼š</span><br><span class="line"><span class="number">101001000</span></span><br><span class="line"><span class="number">0</span>10100100</span><br><span class="line"><span class="number">100010010</span></span><br><span class="line">011000001</span><br><span class="line">APIï¼š</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">sklearn</span>.preprocessing.OneHotEncoder(*, categories=<span class="string">&#x27;auto&#x27;</span>, drop=<span class="literal">None</span>, sparse=<span class="literal">True</span>, dtype=&lt;<span class="keyword">class</span> <span class="string">&#x27;numpy.float64&#x27;</span>&gt;, handle_unknown=<span class="string">&#x27;error&#x27;</span>, min_frequency=<span class="literal">None</span>, max_categories=<span class="literal">None</span>)</span><br><span class="line">å‚æ•°:</span><br><span class="line">categoriesï¼šâ€˜autoâ€™ <span class="keyword">or</span> a <span class="built_in">list</span> of array-like, default=â€™autoâ€™ï¼š</span><br><span class="line">â€œautoâ€ï¼šæ ¹æ®åŸ¹è®­æ•°æ®è‡ªåŠ¨ç¡®å®šç±»åˆ«ã€‚</span><br><span class="line"><span class="built_in">list</span>:categories[i]åŒ…å«ç¬¬iåˆ—ä¸­é¢„æœŸçš„ç±»åˆ«ã€‚ä¼ é€’çš„ç±»åˆ«ä¸åº”åœ¨å•ä¸ªåŠŸèƒ½ä¸­æ··åˆå­—ç¬¦ä¸²å’Œæ•°å€¼ï¼Œå¹¶ä¸”åº”åœ¨æ•°å€¼çš„æƒ…å†µä¸‹è¿›è¡Œæ’åºã€‚</span><br><span class="line">sparseï¼š<span class="built_in">bool</span>, default=<span class="literal">True</span>ï¼šå¦‚æœè®¾ç½®ä¸º<span class="literal">True</span>ï¼Œå°†è¿”å›ç¨€ç–çŸ©é˜µï¼Œå¦åˆ™å°†è¿”å›æ•°ç»„ã€‚</span><br><span class="line">min_frequencyï¼š<span class="built_in">int</span> <span class="keyword">or</span> <span class="built_in">float</span>, default=<span class="literal">None</span>ï¼šæŒ‡å®šæœ€ä½é¢‘ç‡ï¼Œä½äºè¯¥é¢‘ç‡ç±»åˆ«å°†è¢«è§†ä¸ºä¸å¸¸è§ã€‚</span><br><span class="line">max_categoriesï¼š<span class="built_in">int</span>, default=<span class="literal">None</span>ï¼šåœ¨è€ƒè™‘ä¸å¸¸ç”¨ç±»åˆ«æ—¶ï¼Œä¸ºæ¯ä¸ªè¾“å…¥è¦ç´ æŒ‡å®šè¾“å‡ºè¦ç´ æ•°é‡çš„ä¸Šé™ã€‚å¦‚æœå­˜åœ¨ä¸å¸¸è§çš„ç±»åˆ«ï¼Œmax_categorieså°†åŒ…æ‹¬è¡¨ç¤ºä¸å¸¸è§ç±»åˆ«çš„ç±»åˆ«ä»¥åŠå¸¸è§ç±»åˆ«ã€‚å¦‚æœæ— ï¼Œåˆ™è¾“å‡ºç‰¹å¾çš„æ•°é‡æ²¡æœ‰é™åˆ¶ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> OneHotEncoder</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>enc = OneHotEncoder(handle_unknown=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>X = [[<span class="string">&#x27;Male&#x27;</span>, <span class="number">1</span>], [<span class="string">&#x27;Female&#x27;</span>, <span class="number">3</span>], [<span class="string">&#x27;Female&#x27;</span>, <span class="number">2</span>]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>enc.fit(X)</span><br><span class="line">OneHotEncoder(handle_unknown=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>enc.categories_ <span class="comment"># æ¯ä¸ªç‰¹å¾çš„ç±»åˆ«</span></span><br><span class="line">[array([<span class="string">&#x27;Female&#x27;</span>, <span class="string">&#x27;Male&#x27;</span>], dtype=<span class="built_in">object</span>), array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], dtype=<span class="built_in">object</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>enc.transform([[<span class="string">&#x27;Female&#x27;</span>, <span class="number">1</span>], [<span class="string">&#x27;Male&#x27;</span>, <span class="number">4</span>]]).toarray() <span class="comment"># å°†ç»“æœè½¬ä¸ºæ•°ç»„</span></span><br><span class="line">array([[<span class="number">1.</span>, <span class="number">0.</span>, <span class="number">1.</span>, <span class="number">0.</span>, <span class="number">0.</span>],</span><br><span class="line">       [<span class="number">0.</span>, <span class="number">1.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>]])</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†ç¼–ç åè½¬ä¸ºåŸæ¥çš„å½¢å¼</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>enc.inverse_transform([[<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]]) </span><br><span class="line">array([[<span class="string">&#x27;Male&#x27;</span>, <span class="number">1</span>],</span><br><span class="line">       [<span class="literal">None</span>, <span class="number">2</span>]], dtype=<span class="built_in">object</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>enc.get_feature_names_out([<span class="string">&#x27;gender&#x27;</span>, <span class="string">&#x27;group&#x27;</span>])</span><br><span class="line">array([<span class="string">&#x27;gender_Female&#x27;</span>, <span class="string">&#x27;gender_Male&#x27;</span>, <span class="string">&#x27;group_1&#x27;</span>, <span class="string">&#x27;group_2&#x27;</span>, <span class="string">&#x27;group_3&#x27;</span>], ...)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="7ã€æ ‡ç­¾ç¼–ç ">7ã€æ ‡ç­¾ç¼–ç </h4>
<blockquote>
<p>å¯¹å€¼ä»‹äº0å’Œn_classes-1ä¹‹é—´çš„ç›®æ ‡æ ‡ç­¾è¿›è¡Œç¼–ç ã€‚æ ¹æ®å­—ç¬¦ä¸²å½¢å¼çš„ç‰¹å¾å€¼åœ¨ç‰¹å¾åºåˆ—ä¸­çš„ä½ç½®ï¼Œä¸ºå…¶æŒ‡å®šä¸€ä¸ªæ•°å­—æ ‡ç­¾ï¼Œç”¨äºæä¾›ç»™åŸºäºæ•°å€¼ç®—æ³•çš„å­¦ä¹ æ¨¡å‹ã€‚è¯¥è½¬æ¢å™¨åº”ç”¨äºç¼–ç ç›®æ ‡å€¼ï¼Œå³yï¼Œè€Œä¸æ˜¯è¾“å…¥Xã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">APIï¼š</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">sklearn</span>.preprocessing.LabelEncoder()</span><br><span class="line">æ— å‚æ•°</span><br><span class="line">å±æ€§ï¼š</span><br><span class="line">classes_ï¼šndarray of shape (n_classes,)ï¼šä¿å­˜æ¯ä¸ªç±»çš„æ ‡ç­¾ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sklearn.preprocessing <span class="keyword">as</span> sp</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>raw_samples = np.array([</span><br><span class="line"><span class="meta">... </span>   <span class="string">&#x27;audi&#x27;</span>, <span class="string">&#x27;ford&#x27;</span>, <span class="string">&#x27;audi&#x27;</span>, <span class="string">&#x27;toyota&#x27;</span>,</span><br><span class="line"><span class="meta">... </span>   <span class="string">&#x27;ford&#x27;</span>, <span class="string">&#x27;bmw&#x27;</span>, <span class="string">&#x27;toyota&#x27;</span>, <span class="string">&#x27;ford&#x27;</span>,</span><br><span class="line"><span class="meta">... </span>   <span class="string">&#x27;audi&#x27;</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(raw_samples)</span><br><span class="line">lbe = sp.LabelEncoder()</span><br><span class="line">lbe_samples = lbe.fit_transform(raw_samples)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(lbe_samples)</span><br><span class="line">inv_samples = lbe.inverse_transform(lbe_samples)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(inv_samples)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="8ã€å¸¸ç”¨">8ã€å¸¸ç”¨</h4>
<table>
<thead>
<tr>
<th>ç±»å</th>
<th>æ–¹æ³•å</th>
</tr>
</thead>
<tbody>
<tr>
<td>sklearn.preprocessing.Binarizer()</td>
<td>sklearn.preprocessing.binarize()</td>
</tr>
<tr>
<td>sklearn.preprocessing.LabelBinarizer()</td>
<td>sklearn.preprocessing.label_binarize()</td>
</tr>
<tr>
<td>sklearn.preprocessing.MaxAbsScaler()</td>
<td>sklearn.preprocessing.maxabs_scale()</td>
</tr>
<tr>
<td>sklearn.preprocessing.MinMaxScaler()</td>
<td>sklearn.preprocessing.minmax_scale()</td>
</tr>
<tr>
<td>sklearn.preprocessing.Normalizer()</td>
<td>sklearn.preprocessing.normalize()</td>
</tr>
<tr>
<td>sklearn.preprocessing.StandardScaler()</td>
<td>sklearn.preprocessing.scale()</td>
</tr>
<tr>
<td>sklearn.preprocessing.RobustScaler()</td>
<td>sklearn.preprocessing.robust_scale()</td>
</tr>
</tbody>
</table>
<h2 id="å›å½’é—®é¢˜">å›å½’é—®é¢˜</h2>
<blockquote>
<p>å›å½’é—®é¢˜æ˜¯ä¸€ç§å¸¸è§çš„ç›‘ç£æœºå™¨å­¦ä¹ ä»»åŠ¡ï¼Œåœ¨å¾ˆå¤šé¢†åŸŸå‡æœ‰å¹¿æ³›åº”ç”¨ã€‚å…¶å…¸å‹åº”ç”¨åŒ…æ‹¬é”€é‡é¢„æµ‹ã€åº“å­˜é¢„æµ‹ã€è‚¡ç¥¨ä»·æ ¼é¢„æµ‹ã€å¤©æ°”é¢„æµ‹ç­‰</p>
<p>å¤§çº²ï¼š</p>
<p>çº¿æ€§å›å½’æ¨¡å‹çš„ç›®æ ‡å‡½æ•°ï¼ˆæŸå¤±å‡½æ•°å’Œæ­£åˆ™å‡½æ•°ï¼‰ã€çº¿æ€§å›å½’æ¨¡å‹çš„ä¼˜åŒ–æ±‚è§£ã€å›å½’ä»»åŠ¡çš„æ€§èƒ½æŒ‡æ ‡ã€çº¿æ€§å›å½’æ¨¡å‹çš„è¶…å‚æ•°è°ƒä¼˜ä»¥åŠä½¿ç”¨sklearnå®ç°çº¿æ€§å›å½’æ¨¡å‹çš„åº”ç”¨æ¡ˆä¾‹ã€‚</p>
</blockquote>
<h3 id="1ã€çº¿æ€§å›å½’ç®€ä»‹">1ã€çº¿æ€§å›å½’ç®€ä»‹</h3>
<blockquote>
<p>å›å½’åˆ†æï¼šå›å½’åˆ†ææ³•æŒ‡åˆ©ç”¨æ•°æ®ç»Ÿè®¡åŸç†ï¼Œå¯¹å¤§é‡ç»Ÿè®¡æ•°æ®è¿›è¡Œæ•°å­¦å¤„ç†ï¼Œå¹¶ç¡®å®šå› å˜é‡yä¸æŸäº›è‡ªå˜é‡xçš„ç›¸å…³å…³ç³»ï¼Œå»ºç«‹ä¸€ä¸ªç›¸å…³æ€§è¾ƒå¥½çš„å›å½’æ–¹ç¨‹ï¼ˆå‡½æ•°è¡¨è¾¾å¼ï¼‰ï¼Œå¹¶åŠ ä»¥å¤–æ¨ï¼Œç”¨äºé¢„æµ‹ä»Šåçš„å› å˜é‡çš„å˜åŒ–åˆ†ææ–¹æ³•ã€‚å›å½’çš„ç›®æ ‡æ˜¯å­¦ä¹ ä¸€ä¸ªè¾“å…¥xåˆ°è¾“å‡ºyçš„æ˜ å°„fï¼Œå¹¶æ ¹æ®è¯¥æ¨¡å‹é¢„æµ‹æ–°çš„æµ‹è¯•æ•°æ®xå¯¹åº”çš„å“åº”y=f(x)'å…¬å¼ï¼š</p>
</blockquote>
<p>$$<br>
f(x,w)=w^T+b<br>
$$</p>
<h3 id="2ã€ä¸€å…ƒçº¿æ€§å›å½’">2ã€ä¸€å…ƒçº¿æ€§å›å½’</h3>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://picco.eu.org//img/bizhi20230710153626.png" alt=""></p>
<p>å¯ä»¥çœ‹å‡ºæ¥æœ€åæ±‚çš„å°±æ˜¯æŸå¤±å‡½æ•°ï¼Œè·å–æœ€å°å€¼min	å³è·ç¦»çº¿è·ç¦»å’Œæœ€çŸ­</p>
<p>å¯ä»¥ç†è§£æˆ‘æ¯ä¸€æ®µéƒ½éœ€è¦è·å–æœ€å°å€¼ï¼Œ</p>
<h5 id="æŸå¤±å‡½æ•°">æŸå¤±å‡½æ•°</h5>
<blockquote>
<p>æŸå¤±å‡½æ•°å°±æ˜¯æ€»æ ·æœ¬è¯¯å·®å…³äºæ¨¡å‹å‚æ•°çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°å±äºä¸‰ç»´æ•°å­¦æ¨¡å‹ï¼Œå³éœ€è¦æ‰¾åˆ°ä¸€ç»„<code>w0</code>ï¼Œ<code>w1</code>ä½¿å¾—losså–æå°å€¼ã€‚</p>
<p>æ ¸å¿ƒï¼šæ‰¾åˆ°w0å’Œw1çš„å€¼ï¼Œä½¿å¾—é¢„æµ‹å€¼å’ŒçœŸå®å€¼ä¹‹é—´çš„å¹³å‡å·®å¼‚æœ€å°ã€‚</p>
<p>æŸå¤±ï¼šæœºå™¨å­¦ä¹ æ¨¡å‹å…³äºå•ä¸ªæ ·æœ¬çš„é¢„æµ‹å€¼ä¸çœŸå®å€¼çš„å·®ï¼ŒæŸå¤±è¶Šå°ï¼Œæ¨¡å‹è¶Šå¥½ï¼›å¦‚æœé¢„æµ‹å€¼ä¸çœŸå®å€¼ç›¸ç­‰ï¼Œå°±æ˜¯æ²¡æœ‰æŸå¤±ã€‚</p>
<p>æŸå¤±å‡½æ•°ï¼šç”¨äºè®¡ç®—æŸå¤±çš„å‡½æ•°æ¨¡å‹æ¯ä¸€æ¬¡é¢„æµ‹çš„å¥½åç”¨æŸå¤±å‡½æ•°æ¥åº¦é‡ã€‚</p>
<p>å¸¸è§çš„æŸå¤±å‡½æ•°ï¼š</p>
<p>l å¹³å‡å¹³æ–¹è¯¯å·®ï¼ˆMean Squared Error ï¼ˆ<code>MSE</code>ï¼‰ï¼‰ï¼šä¹Ÿç§°ä¸º <code>L2</code> Lossï¼Œæ˜¯æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ å›å½’ä»»åŠ¡ä¸­æœ€å¸¸ç”¨çš„ä¸€ç§æŸå¤±å‡½æ•°ï¼Œå¯¹ç¦»ç¾¤ç‚¹æ•æ„Ÿã€‚</p>
<p>l å¹³å‡ç»å¯¹è¯¯å·®ï¼ˆ Mean Absolute Errorï¼ˆMAEï¼‰ï¼‰ï¼šä¹Ÿç§°ä¸º<code>L1</code> Lossï¼Œä½¿ç”¨ç»å¯¹å€¼ï¼Œ<code>L1</code>æŸå¤±å¯¹ç¦»ç¾¤ç‚¹ä¸æ•æ„Ÿã€‚</p>
<p>l èƒ¡ä¼¯æŸå¤±ï¼ˆHuberï¼‰ï¼šç»¼åˆäº†<code>L2</code>æŸå¤±å’Œ<code>L1</code>æŸå¤±çš„ä¼˜ç‚¹ã€‚</p>
</blockquote>
<h5 id="çº¿æ€§å›å½’æ¨¡å‹çš„ä¼˜åŒ–æ±‚è§£">çº¿æ€§å›å½’æ¨¡å‹çš„ä¼˜åŒ–æ±‚è§£</h5>
<blockquote>
<p>æ¨¡å‹çš„ç›®æ ‡å‡½æ•°ç¡®å®šåï¼Œæˆ‘ä»¬å°±å¯ä»¥é‡‡ç”¨åˆé€‚çš„ä¼˜åŒ–æ–¹æ³•å¯»æ‰¾æœ€ä½³çš„æ¨¡å‹å‚æ•°ã€‚åœ¨çº¿æ€§å›å½’æ¨¡å‹ä¸­ï¼Œæ¨¡å‹å‚æ•°åŒ…æ‹¬çº¿æ€§å›å½’ç³»æ•°<code>w1</code>ï¼Œå’Œæˆªè·<code>w0</code>ã€‚å½“è®­ç»ƒæ•°æ®é›†ä¸å¤§æ—¶ï¼Œæœ€å°äºŒä¹˜çº¿æ€§å›å½’å¯é‡‡ç”¨è§£ææ±‚è§£æ³•æ±‚è§£ï¼Œè§£ææ±‚è§£æ³•æ¶‰åŠåˆ°å¤§é‡å…¬å¼æ¨å¯¼ï¼Œæ­¤å¤„æš‚ä¸åšè®²è§£ã€‚é™¤æ­¤ä»¥å¤–è¿˜å¯ä»¥ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•æ±‚è§£ã€‚</p>
</blockquote>
<h5 id="æ­£è§„æ–¹ç¨‹">æ­£è§„æ–¹ç¨‹</h5>
<p>ç›´æ¥æ±‚è§£W</p>
<p>ä¸¾ä¾‹ï¼š</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">y <span class="operator">=</span> ax^<span class="number">2</span> + bx +<span class="keyword">c</span></span><br><span class="line">y&#x27; <span class="operator">=</span> <span class="number">2</span>ax + b <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">x</span> <span class="operator">=</span> - b / <span class="number">2</span>a</span><br><span class="line"></span><br><span class="line">åŒç†æ˜¯çŸ©é˜µæ±‚å¯¼<span class="operator">=</span><span class="number">0</span></span><br></pre></td></tr></table></figure>
<h5 id="æ¢¯åº¦ä¸‹é™ï¼ˆGradient-Descentï¼‰">æ¢¯åº¦ä¸‹é™ï¼ˆGradient Descentï¼‰</h5>
<blockquote>
<p>æ¢¯åº¦ä¸‹é™æ³•æ˜¯æ±‚è§£æ— çº¦æŸä¼˜åŒ–é—®é¢˜æœ€å¸¸ç”¨çš„æ–¹æ³•ä¹‹ä¸€ï¼Œäº¦è¢«ç§°ä¸ºæœ€é€Ÿä¸‹é™æ³•ã€‚æœ€å°äºŒä¹˜å›å½’å’Œå²­å›å½’å‡å¯é‡‡ç”¨æ¢¯åº¦ä¸‹é™æ³•æ±‚è§£ï¼ŒLassoå›å½’ç”±äºç›®æ ‡å‡½æ•°ä¸­æœ‰L1æ­£åˆ™å‡½æ•°è€Œä¸å¯å¯¼ï¼Œå› æ­¤ä¸èƒ½é‡‡ç”¨æ¢¯åº¦ä¸‹é™æ³•æ±‚è§£ã€‚æ¢¯åº¦ä¸‹é™æ³•æ˜¯ä¸€ç§åŸºäºæœç´¢çš„æœ€ä¼˜åŒ–æ–¹æ³•ï¼Œåœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œç†Ÿç»ƒçš„ä½¿ç”¨æ¢¯åº¦æ³•ï¼ˆä¸‹é™æ³•æˆ–ä¸Šå‡æ³•ï¼‰æ±‚å–ç›®æ ‡å‡½æ•°çš„æœ€ä¼˜è§£æ˜¯éå¸¸é‡è¦çš„ã€‚çº¿æ€§å›å½’ç®—æ³•æ¨¡å‹çš„æœ¬è´¨å°±æ˜¯æœ€å°åŒ–ä¸€ä¸ªæŸå¤±å‡½æ•°ï¼Œç„¶åæ±‚å‡ºæŸå¤±å‡½æ•°çš„å‚æ•°çš„æ•°å­¦è§£ï¼› æ¢¯åº¦ä¸‹é™æ³•æ˜¯åœ¨æœºå™¨å­¦ä¹ é¢†åŸŸä¸­æœ€å°åŒ–æŸå¤±å‡½æ•°çš„æœ€ä¸ºå¸¸ç”¨çš„æ–¹æ³•ã€‚</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://picco.eu.org//img/bizhi/20230710205448.png" alt=""></p>
<blockquote>
<p>å‡å¦‚ä½ è¿·å¤±åœ¨å±±ä¸Šçš„æµ“é›¾ä¹‹ä¸­ï¼Œå®Œå…¨çœ‹ä¸è§ä¸‹å±±çš„æ–¹å‘ï¼Œä½ èƒ½æ„Ÿè§‰åˆ°çš„åªæœ‰è„šä¸‹çš„è·¯é¢å¡åº¦ã€‚å¿«é€Ÿåˆ°è¾¾å±±è„šçš„ä¸€ä¸ªç­–ç•¥å°±æ˜¯æ²¿ç€æœ€é™¡çš„æ–¹å‘ä¸‹å¡ã€‚è¿™å°±æ˜¯æ¢¯åº¦ä¸‹é™çš„åšæ³•ï¼šé€šè¿‡æµ‹é‡å‚æ•°å‘é‡Î¸ç›¸å…³çš„æŸå¤±å‡½æ•°çš„å±€éƒ¨æ¢¯åº¦ï¼Œå¹¶ä¸æ–­æ²¿ç€é™ä½æ¢¯åº¦çš„æ–¹å‘è°ƒæ•´ï¼Œç›´åˆ°æ¢¯åº¦å°†ä¸º0ï¼Œè¾¾åˆ°æœ€å°å€¼ï¼ æ¯ä¸‹é™ä¸€æ­¥éƒ½å»é€‰æ‹©æœ€é™¡å³­çš„æ–¹å‘ï¼Œç„¶åè¸å‡ºä¸€æ­¥ã€‚å› æ­¤æ²¡è¿­ä»£ä¸€æ¬¡éœ€è¦è€ƒè™‘ä¸¤ä¸ªå˜é‡ï¼Œä¸€ä¸ªæ˜¯æ–¹å‘ï¼ˆæœå“ªè¾¹èµ°ï¼‰ï¼Œä¸€ä¸ªæ˜¯æ­¥é•¿ï¼ˆèµ°å¤šå°‘ï¼‰ã€‚æ–¹å‘å°±æ˜¯å‘é‡Î¸çš„æ–œç‡ï¼Œæ­¥é•¿æ˜¯ä¸€ä¸ªè¶…å‚æ•°å«åšå­¦ä¹ ç‡ï¼ˆlearning_rateï¼‰ã€‚</p>
</blockquote>
<p>==<strong>å­¦ä¹ é€Ÿç‡ï¼ˆlearning_rateï¼‰</strong>==</p>
<blockquote>
<p>å­¦ä¹ ç‡æ˜¯ä¸€ä¸ªè¶…å‚æ•°ï¼Œå­¦ä¹ ç‡çš„å–å€¼ä¼šå½±å“è·å¾—æœ€ä¼˜è§£çš„é€Ÿåº¦; å¤ªå°ï¼Œç®—æ³•éœ€è¦ç»è¿‡å¤§é‡è¿­ä»£æ‰èƒ½æ”¶æ•›ï¼Œè¿™å°†è€—è´¹å¾ˆé•¿æ—¶é—´ï¼›åè¿‡æ¥å­¦ä¹ ç‡å¤ªå¤§ï¼Œå¯èƒ½ä¼šè¶Šè¿‡æœ€å°å€¼ç›´æ¥åˆ°è¾¾å¦ä¸€è¾¹ï¼Œç”šè‡³æœ‰å¯èƒ½æ¯”ä¹‹å‰çš„èµ·ç‚¹è¿˜è¦é«˜ï¼Œè¿™ä¼šå¯¼è‡´ç®—æ³•å‘æ•£ï¼Œå€¼è¶Šæ¥è¶Šå¤§ï¼Œæ— æ³•æ‰¾åˆ°æœ€ä¼˜è§£ã€‚å­¦ä¹ ç‡æ˜¯è¶…å‚æ•°éœ€è¦æ‰‹åŠ¨è°ƒèŠ‚ï¼Œå–å€¼èŒƒå›´ä¸€èˆ¬åœ¨[0, 1]ä¹‹é—´ã€‚ä¸‹å›¾å±•ç¤ºäº†ä¸åŒå­¦ä¹ ç‡å¯¹æ¢¯åº¦ä¸‹é™çš„å½±å“ã€‚</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://picco.eu.org//img/bizhi/20230710205526.png" alt=""></p>
<h3 id="3ã€å›å½’ç›¸å…³API">3ã€å›å½’ç›¸å…³<code>API</code></h3>
<blockquote>
<p><code>sklearn.linear_model</code>æ¨¡å—ä¸‹æä¾›äº†çº¿æ€§åˆ†ç±»å™¨ï¼ˆLinear classifiersï¼‰å’Œç»å…¸çº¿æ€§å›å½’ï¼ˆClassical linear regressorsï¼‰ä¸¤ç§é—®é¢˜çš„å®ç°ç±»ã€‚å…¶ä¸­Linear classifiersä¸­çš„ç±»æ˜¯ç”¨çº¿æ€§å›å½’çš„æ€æƒ³è§£å†³åˆ†ç±»é—®é¢˜çš„ï¼Œå…¶ä¸­åŒ…å«äº†é€»è¾‘å›å½’åˆ†ç±»å™¨ï¼ˆ<code>LogisticRegression</code>ï¼‰ï¼Œå²­å›å½’åˆ†ç±»å™¨ï¼ˆ<code>RidgeClassifier</code>ï¼‰ï¼Œäº¤å‰éªŒè¯é€»è¾‘å›å½’åˆ†ç±»å™¨ï¼ˆ<code>RidgeClassifierCV</code>ï¼‰ï¼Œçº¿æ€§æ„ŸçŸ¥å™¨åˆ†ç±»å™¨ï¼ˆ<code>Perceptron</code>ï¼‰ï¼Œ<code>SGD</code>è®­ç»ƒçš„çº¿æ€§åˆ†ç±»å™¨ï¼ˆ<code>SGDClassifier</code>ï¼‰ç­‰å¤šç§åˆ†ç±»å™¨ã€‚Classical linear regressorsæ¨¡å—ä¸­æä¾›äº†çº¿æ€§å›å½’ï¼ˆ<code>LinearRegression</code>ï¼‰ï¼Œå²­å›å½’ï¼ˆRidgeï¼‰ï¼Œäº¤å‰éªŒè¯å²­å›å½’ï¼ˆ<code>RidgeCV</code>ï¼‰ï¼Œéšæœºæ¢¯åº¦ä¸‹é™å›å½’ï¼ˆ<code>SGDRegressor</code>ï¼‰ã€‚é™¤æ­¤ä»¥å¤–è¿˜æœ‰å¸¦æœ‰å˜é‡é€‰æ‹©çš„å›å½’å™¨ï¼ˆRegressors with variable selectionï¼‰ï¼›è´å¶æ–¯å›å½’ï¼ˆBayesian regressorsï¼‰ï¼›å…·æœ‰å˜é‡é€‰æ‹©çš„å¤šä»»åŠ¡çº¿æ€§å›å½’å™¨ï¼ˆMulti-task linear regressors with variable selectionï¼‰ï¼›ç¦»ç¾¤ç¨³å¥å›å½’ï¼ˆ<code>Outlier-robust regressors</code>ï¼‰ï¼›å›å½’çš„å¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼ˆGeneralized linear models (<code>GLM</code>) for regressionï¼‰ï¼›æ··åˆæ¨¡å‹ï¼ˆMiscellaneousï¼‰ç­‰ã€‚</p>
</blockquote>
<p>==1.<strong><code>LinearRegression()</code></strong>==</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">æ™®é€šæœ€å°äºŒä¹˜çº¿æ€§å›å½’ã€‚çº¿æ€§å›å½’æ‹Ÿåˆç³»æ•°w=ï¼ˆw1ï¼Œâ€¦ï¼Œwpï¼‰çš„çº¿æ€§æ¨¡å‹ï¼Œä»¥æœ€å°åŒ–æ•°æ®é›†ä¸­è§‚å¯Ÿåˆ°çš„ç›®æ ‡ä¸çº¿æ€§è¿‘ä¼¼é¢„æµ‹çš„ç›®æ ‡ä¹‹é—´çš„æ®‹å·®å¹³æ–¹å’Œã€‚</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">sklearn.linear_model.LinearRegression(*, fit_intercept=<span class="literal">True</span>, normalize=<span class="literal">False</span>, copy_X=<span class="literal">True</span>, n_jobs=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>å‚æ•°åç§°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>fit_intercept</td>
<td>æ˜¯å¦è®¡ç®—æ­¤æ¨¡å‹çš„æˆªè·ã€‚å¦‚æœè®¾ç½®ä¸ºFalseï¼Œåˆ™ä¸ä¼šåœ¨è®¡ç®—ä¸­ä½¿ç”¨æˆªè·ï¼ˆå³ï¼Œé¢„è®¡æ•°æ®å°†å±…ä¸­ï¼‰ã€‚</td>
</tr>
<tr>
<td>normalize</td>
<td>å½“fit_interceptè®¾ç½®ä¸ºFalseæ—¶ï¼Œå°†å¿½ç•¥æ­¤å‚æ•°ã€‚å¦‚æœä¸ºTrueï¼Œåˆ™å›å½’å‰å°†é€šè¿‡å‡å»å¹³å‡å€¼å¹¶é™¤ä»¥l2èŒƒæ•°å¯¹å›å½’Xè¿›è¡Œå½’ä¸€åŒ–ã€‚å¦‚æœæ‚¨å¸Œæœ›æ ‡å‡†åŒ–ï¼Œè¯·åœ¨å¯¹normalize=Falseçš„ä¼°è®¡å™¨è°ƒç”¨fitä¹‹å‰ä½¿ç”¨StandardScalerã€‚</td>
</tr>
<tr>
<td>copy_X</td>
<td>å¦‚æœä¸ºTrueï¼Œå°†å¤åˆ¶Xï¼›å¦åˆ™ï¼Œå¯èƒ½ä¼šè¢«è¦†ç›–ã€‚</td>
</tr>
<tr>
<td>n_jobs</td>
<td>ç”¨äºè®¡ç®—çš„ä½œä¸šæ•°</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>coef_</td>
<td>ç³»æ•°ã€‚å½¢çŠ¶ä¸ºï¼ˆn_featuresï¼Œï¼‰æˆ–ï¼ˆn_targetsï¼Œn_featuresï¼‰çš„æ•°ç»„</td>
</tr>
<tr>
<td>rank_</td>
<td>çŸ©é˜µçš„ç­‰çº§X</td>
</tr>
<tr>
<td>intercept_</td>
<td>æˆªè·</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>fit(X, y)</td>
<td>æ‹Ÿåˆçº¿æ€§æ¨¡å‹</td>
</tr>
<tr>
<td>get_params([deep])</td>
<td>è·å–æ­¤ä¼°è®¡å™¨çš„å‚æ•°ã€‚</td>
</tr>
<tr>
<td>predict(X)</td>
<td>ä½¿ç”¨çº¿æ€§æ¨¡å‹è¿›è¡Œé¢„æµ‹ã€‚</td>
</tr>
<tr>
<td>score(X, y)</td>
<td>è¿”å›é¢„æµ‹çš„ç¡®å®šç³»æ•°ã€‚</td>
</tr>
<tr>
<td>set_params()</td>
<td>è®¾ç½®æ­¤ä¼°è®¡å™¨çš„å‚æ•°ã€‚</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ç¤ºä¾‹ä»£ç ï¼š</span><br><span class="line"><span class="keyword">import</span> sklearn.linear_model <span class="keyword">as</span> lm</span><br><span class="line"><span class="comment"># åˆ›å»ºæ¨¡å‹</span></span><br><span class="line">model = lm.LinearRegression()</span><br><span class="line"><span class="comment"># è®­ç»ƒæ¨¡å‹</span></span><br><span class="line"><span class="comment"># è¾“å…¥ä¸ºä¸€ä¸ªäºŒç»´æ•°ç»„è¡¨ç¤ºçš„æ ·æœ¬çŸ©é˜µ</span></span><br><span class="line"><span class="comment"># è¾“å‡ºä¸ºæ¯ä¸ªæ ·æœ¬æœ€ç»ˆçš„ç»“æœ</span></span><br><span class="line">model.fit(è¾“å…¥, è¾“å‡º) <span class="comment"># é€šè¿‡æ¢¯åº¦ä¸‹é™æ³•è®¡ç®—æ¨¡å‹å‚æ•°</span></span><br><span class="line"><span class="comment"># é¢„æµ‹è¾“å‡º  </span></span><br><span class="line"><span class="comment"># è¾“å…¥arrayæ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œæ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªæ ·æœ¬ï¼Œæ¯ä¸€åˆ—æ˜¯ä¸€ä¸ªç‰¹å¾ã€‚</span></span><br><span class="line">result = model.predict(array)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>==2.<strong><code>SGDRegressor()</code></strong>==</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">é€šè¿‡SGDæœ€å°åŒ–æ­£åˆ™åŒ–ç»éªŒæŸå¤±æ‹Ÿåˆçš„çº¿æ€§æ¨¡å‹ã€‚SGDä»£è¡¨éšæœºæ¢¯åº¦ä¸‹é™ï¼šä¸€æ¬¡ä¼°è®¡æ¯ä¸ªæ ·æœ¬çš„æŸå¤±æ¢¯åº¦ï¼Œå¹¶ä»¥é€’å‡çš„å¼ºåº¦è®¡åˆ’ï¼ˆå³å­¦ä¹ ç‡ï¼‰æ›´æ–°æ¨¡å‹ã€‚æ­£åˆ™åŒ–å™¨æ˜¯æ·»åŠ åˆ°æŸå¤±å‡½æ•°çš„æƒ©ç½šï¼Œå…¶ä½¿ç”¨å¹³æ–¹æ¬§å‡ é‡Œå¾·èŒƒæ•°L2æˆ–ç»å¯¹èŒƒæ•°L1æˆ–ä¸¤è€…çš„ç»„åˆï¼ˆå¼¹æ€§ç½‘ï¼‰å°†æ¨¡å‹å‚æ•°æ”¶ç¼©åˆ°é›¶å‘é‡ã€‚å¦‚æœå‚æ•°æ›´æ–°ç”±äºæ­£åˆ™åŒ–å™¨è€Œä¸0.0å€¼äº¤å‰ï¼Œåˆ™æ›´æ–°å°†è¢«æˆªæ–­ä¸º0.0ï¼Œä»¥å…è®¸å­¦ä¹ ç¨€ç–æ¨¡å‹å¹¶å®ç°åœ¨çº¿ç‰¹å¾é€‰æ‹©ã€‚æ­¤å®ç°å¯ä»¥å¤„ç†è¡¨ç¤ºä¸ºç‰¹å¾æµ®ç‚¹å€¼å¯†é›†numpyæ•°ç»„çš„æ•°æ®ã€‚</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">sklearn</span>.linear_model.SGDRegressor(loss=<span class="string">&#x27;squared_error&#x27;</span>, *, penalty=<span class="string">&#x27;l2&#x27;</span>, alpha=<span class="number">0.0001</span>, l1_ratio=<span class="number">0.15</span>, fit_intercept=<span class="literal">True</span>, max_iter=<span class="number">1000</span>, tol=<span class="number">0.001</span>, shuffle=<span class="literal">True</span>, verbose=<span class="number">0</span>, epsilon=<span class="number">0.1</span>, random_state=<span class="literal">None</span>, learning_rate=<span class="string">&#x27;invscaling&#x27;</span>, eta0=<span class="number">0.01</span>, power_t=<span class="number">0.25</span>, early_stopping=<span class="literal">False</span>, validation_fraction=<span class="number">0.1</span>, n_iter_no_change=<span class="number">5</span>, warm_start=<span class="literal">False</span>, average=<span class="literal">False</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>loss</td>
<td>æŸå¤±å‡½æ•°ï¼Œstrï¼Œé»˜è®¤å€¼ä¸ºï¼šsquared_errorï¼Œå¯é€‰ï¼šâ€˜squared_errorâ€™,  â€˜huberâ€™, â€˜epsilon_insensitiveâ€™, or â€˜squared_epsilon_insensitiveâ€™</td>
</tr>
<tr>
<td>penalty</td>
<td>æ­£åˆ™é¡¹ï¼Œå¯é€‰ï¼š{â€˜l2â€™,  â€˜l1â€™, â€˜elasticnetâ€™}, é»˜è®¤å€¼ä¸ºâ€™l2â€™</td>
</tr>
<tr>
<td>alpha</td>
<td>æ­£åˆ™å¼ºåº¦ï¼Œæµ®ç‚¹å‹ï¼Œé»˜è®¤å€¼ä¸ºï¼š0.0001ã€‚å€¼è¶Šå¤§ï¼Œæ­£åˆ™åŒ–è¶Šå¼ºã€‚</td>
</tr>
<tr>
<td>fit_intercept</td>
<td>æ˜¯å¦è®¡ç®—æˆªè·ï¼Œå¸ƒå°”å‹ï¼Œé»˜è®¤å€¼ä¸ºï¼šTrueã€‚æ˜¯å¦åº”ä¼°è®¡æˆªè·ã€‚å¦‚æœä¸ºFalseï¼Œåˆ™å‡å®šæ•°æ®å·²å±…ä¸­ã€‚</td>
</tr>
<tr>
<td>learning_rate</td>
<td>å­¦ä¹ ç‡ï¼Œå­—ç¬¦ä¸²ï¼Œé»˜è®¤å€¼ä¸ºï¼šinvscalingï¼Œä¸æŒ‰æ¯”ä¾‹ç¼©æ”¾ã€‚</td>
</tr>
<tr>
<td>eta0</td>
<td>å­¦ä¹ ç‡çš„åˆå§‹å€¼ï¼Œæµ®ç‚¹å‹ï¼Œ  â€˜constantâ€™, â€˜invscalingâ€™ or â€˜adaptiveâ€™åˆå§‹å­¦ä¹ ç‡ï¼Œé»˜è®¤ä¸º0.01</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>coef_</td>
<td>æŒ‡å®šè¦ç´ çš„æƒé‡æ–œç‡ã€‚</td>
</tr>
<tr>
<td>intercept_</td>
<td>æˆªè·é¡¹ã€‚</td>
</tr>
<tr>
<td>n_iter_</td>
<td>è¾¾åˆ°åœæ­¢æ ‡å‡†ä¹‹å‰çš„å®é™…è¿­ä»£æ¬¡æ•°ã€‚</td>
</tr>
<tr>
<td>t_</td>
<td>è®­ç»ƒæœŸé—´æ‰§è¡Œçš„ä½“é‡æ›´æ–°æ¬¡æ•°</td>
</tr>
<tr>
<td>n_features_in_</td>
<td>è£…é…è¿‡ç¨‹ä¸­çœ‹åˆ°çš„ç‰¹å¾æ•°é‡ã€‚</td>
</tr>
<tr>
<td>feature_names_in_</td>
<td>è£…é…è¿‡ç¨‹ä¸­çœ‹åˆ°çš„ç‰¹å¾åç§°ã€‚ä»…å½“Xå…·æœ‰å…¨éƒ¨å­—ç¬¦ä¸²çš„è¦ç´ åç§°æ—¶æ‰å®šä¹‰ã€‚</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>fit(X, y)</td>
<td>ç”¨éšæœºæ¢¯åº¦ä¸‹é™æ‹Ÿåˆçº¿æ€§æ¨¡å‹ã€‚</td>
</tr>
<tr>
<td>predict(X)</td>
<td>ä½¿ç”¨æ¨¡å‹é¢„æµ‹</td>
</tr>
<tr>
<td>get_params(deep=True)</td>
<td>è·å–æ­¤ä¼°è®¡å™¨çš„å‚æ•°ã€‚</td>
</tr>
<tr>
<td>sparsify()</td>
<td>å°†ç³»æ•°çŸ©é˜µè½¬æ¢ä¸ºç¨€ç–æ ¼å¼ã€‚</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> SGDRegressor</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> make_pipeline</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>n_samples, n_features = <span class="number">10</span>, <span class="number">5</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rng = np.random.RandomState(<span class="number">0</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = rng.randn(n_samples)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>X = rng.randn(n_samples, n_features)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># Always scale the input. The most convenient way is to use a pipeline.</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>reg = make_pipeline(StandardScaler(),</span><br><span class="line"><span class="meta">... </span>                    SGDRegressor(max_iter=<span class="number">1000</span>, tol=<span class="number">1e-3</span>))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>reg.fit(X, y)</span><br><span class="line">Pipeline(steps=[(<span class="string">&#x27;standardscaler&#x27;</span>, StandardScaler()),</span><br><span class="line">                (<span class="string">&#x27;sgdregressor&#x27;</span>, SGDRegressor())])</span><br></pre></td></tr></table></figure>
<h3 id="4ã€æ¡ˆä¾‹å®æˆ˜ï¼šåŠ åˆ©ç¦å°¼äºšæˆ¿å±‹ä»·æ ¼å›å½’åˆ†æ">4ã€æ¡ˆä¾‹å®æˆ˜ï¼šåŠ åˆ©ç¦å°¼äºšæˆ¿å±‹ä»·æ ¼å›å½’åˆ†æ</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets <span class="keyword">as</span> sd</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> model_selection <span class="keyword">as</span> sm</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> linear_model <span class="keyword">as</span> sl</span><br><span class="line"></span><br><span class="line">data = sd.fetch_california_housing()</span><br><span class="line">x = data[<span class="string">&#x27;data&#x27;</span>]</span><br><span class="line">y = data[<span class="string">&#x27;target&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">æŸ¥çœ‹å½¢çŠ¶</span></span><br><span class="line"><span class="string">x.shape</span></span><br><span class="line"><span class="string">y.shape</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ•°æ®ä»‹ç»</span></span><br><span class="line"><span class="string">print(data[&#x27;DESCR&#x27;])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># æ•°æ®å·²ç»å¤„ç†å¥½äº†ä¸éœ€è¦è¿›è¡Œç‰¹å¾å·¥ç¨‹</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®é›†åˆ’åˆ†ï¼šè®­ç»ƒé›†å’Œæµ‹è¯•é›†</span></span><br><span class="line">train_x, test_x, train_y, test_y = sm.train_test_split(x, y, train_size=<span class="number">0.75</span>, test_size=<span class="number">0.25</span>, shuffle=<span class="literal">True</span>, random_state=<span class="number">145</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">è¿™é‡Œ:</span></span><br><span class="line"><span class="string">train_size + test_size = 1</span></span><br><span class="line"><span class="string">shuffle = True 	æ··æ´—</span></span><br><span class="line"><span class="string">random_state = 145	éšæœºæ•°ç§å­</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€‰æ‹©æ¨¡å‹</span></span><br><span class="line">model = sl.LinearRegression()</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®­ç»ƒæ¨¡å‹</span></span><br><span class="line">model.fit(train_x, train_y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„æµ‹</span></span><br><span class="line">pred_y = model.predict(test_x)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">é¢„æµ‹è¿™é‡Œä¸»è¦çœ‹çš„å°±æ˜¯çœ‹é¢„æµ‹å€¼ä¸æµ‹è¯•å€¼ä¹‹é—´çš„åŒºåˆ«</span></span><br><span class="line"><span class="string">é¢„æµ‹å€¼:</span></span><br><span class="line"><span class="string">array([0.0696445 , 0.61678432, 2.02419006, ..., 1.9095006 , 2.67847098,</span></span><br><span class="line"><span class="string">       2.07215543])</span></span><br><span class="line"><span class="string">      </span></span><br><span class="line"><span class="string">æµ‹è¯•å€¼:</span></span><br><span class="line"><span class="string">array([0.988, 1.572, 1.609, ..., 1.361, 2.727, 3.167])</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è¯„ä¼°</span></span><br><span class="line">sm.mean_squared_error(test_y, pred_y)	<span class="comment">#0.5406765977332207</span></span><br></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºæ¥éšæœºæ•°ç§å­çš„é€‰æ‹©å’Œå¯¹æµ‹è¯•é›†å’Œè®­ç»ƒé›†çš„åˆ’åˆ†å¯¹æœ€åæ¨¡å‹çš„è¯„ä¼°æœ‰ç€å¾ˆé‡è¦çš„ä½œç”¨</p>
<h3 id="5ã€å›å½’æ¨¡å‹è¯„ä»·æŒ‡æ ‡">5ã€å›å½’æ¨¡å‹è¯„ä»·æŒ‡æ ‡</h3>
<p>sklearnåº¦é‡æ¨¡å—å®ç°äº†å‡ ä¸ªæŸå¤±ã€åˆ†æ•°å’Œæ•ˆç”¨å‡½æ•°æ¥åº¦é‡å›å½’æ€§èƒ½ã€‚å…¶ä¸­ä¸€äº›å·²è¢«å¢å¼ºä»¥å¤„ç†å¤šè¾“å‡ºæƒ…å†µï¼šmean_squared_errorã€mean_absolute_errorï¼Œr2_scoreï¼Œexplained_variance_scoreã€mean_pinball_lossã€d2_pinball_scoreå’Œd2_absolute _error_scoreã€‚</p>
<table>
<thead>
<tr>
<th>æ–¹æ³•åç§°</th>
<th>æœ€ä¼˜å€¼</th>
<th>sklearnå‡½æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td>å¹³å‡ç»å¯¹è¯¯å·®</td>
<td>0.0</td>
<td>metrics. mean_absolute_error(y_true, y_pred)</td>
</tr>
<tr>
<td>å¹³å‡å‡æ–¹è¯¯å·®</td>
<td>0.0</td>
<td>metrics. mean_squared_error(y_true, y_pred)</td>
</tr>
<tr>
<td>å‡æ–¹å¯¹æ•°è¯¯å·®</td>
<td>0.0</td>
<td>metrics.mean_squared_log_error(y_true, y_pred)</td>
</tr>
<tr>
<td>ä¸­ä½ç»å¯¹è¯¯å·®</td>
<td>0.0</td>
<td>metrics. median_absolute_error(y_true, y_pred)</td>
</tr>
<tr>
<td>æœ€å¤§è¯¯å·®</td>
<td>0.0</td>
<td>metrics.max_error(y_true, y_pred)</td>
</tr>
<tr>
<td>å¯è§£é‡Šæ–¹å·®å€¼</td>
<td>1.0</td>
<td>metrics. explained_variance_score(y_true,  y_pred)</td>
</tr>
<tr>
<td>Ræ–¹å€¼</td>
<td>1.0</td>
<td>metrics. r2_score(y_true, y_pred)</td>
</tr>
</tbody>
</table>
<p>ç¤ºä¾‹ï¼š</p>
<p>çº¿æ€§å›å½’æ¨¡å‹è®­ç»ƒå®Œæ¯•åï¼Œå¯ä»¥åˆ©ç”¨æµ‹è¯•é›†è¯„ä¼°è®­ç»ƒç»“æœè¯¯å·®ã€‚sklearn.metricsæä¾›äº†è®¡ç®—æ¨¡å‹è¯¯å·®çš„å‡ ä¸ªå¸¸ç”¨ç®—æ³•ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sklearn.metrics <span class="keyword">as</span> sm</span><br><span class="line"> </span><br><span class="line"><span class="comment"># å¹³å‡ç»å¯¹å€¼è¯¯å·®ï¼š1/mâˆ‘|å®é™…è¾“å‡º-é¢„æµ‹è¾“å‡º|</span></span><br><span class="line"> sm.mean_absolute_error(test_y, pred_y)</span><br><span class="line"><span class="comment"># å¹³å‡å¹³æ–¹è¯¯å·®ï¼šSQRT(1/mÎ£(å®é™…è¾“å‡º-é¢„æµ‹è¾“å‡º)^2)</span></span><br><span class="line"> sm.mean_squared_error(test_y, pred_y)</span><br><span class="line"><span class="comment"># ä¸­ä½ç»å¯¹å€¼è¯¯å·®ï¼šMEDIAN(|å®é™…è¾“å‡º-é¢„æµ‹è¾“å‡º|)</span></span><br><span class="line"> sm.median_absolute_error(test_y, pred_y)</span><br><span class="line"><span class="comment"># è§£é‡Šæ–¹å·®å›å½’è¯„åˆ†ï¼šæœ€å¥½åˆ†æ•°æ˜¯ 1.0ï¼Œè¶Šä½æ¨¡å‹è¶Šä¸å¥½</span></span><br><span class="line"> sm.explained_variance_score(test_y, y_pred)</span><br><span class="line"><span class="comment"># R2å¾—åˆ†ï¼Œ(0,1]åŒºé—´çš„åˆ†å€¼,åˆ†æ•°è¶Šé«˜ï¼Œè¯¯å·®è¶Šå°ã€‚</span></span><br><span class="line"> sm.r2_score(test_y, pred_y)</span><br></pre></td></tr></table></figure>
<h3 id="6ã€è¿‡æ‹Ÿåˆå’Œæ¬ æ‹Ÿåˆ">6ã€è¿‡æ‹Ÿåˆå’Œæ¬ æ‹Ÿåˆ</h3>
<p>æ¬ æ‹Ÿåˆ</p>
<ul>
<li>åŸå› : å­¦ä¹ å¯¼æ•°æ®çš„ç‰¹å¾è¿‡å°‘</li>
<li>è§£å†³åŠæ³•: å¢åŠ æ•°æ®çš„ç‰¹å¾æ•°é‡</li>
</ul>
<p>è¿‡äºç®€å•çš„æ¨¡å‹ï¼Œæ— è®ºå¯¹äºè®­ç»ƒæ•°æ®è¿˜æ˜¯æµ‹è¯•æ•°æ®éƒ½æ— æ³•ç»™å‡ºè¶³å¤Ÿé«˜çš„é¢„æµ‹ç²¾åº¦ï¼Œè¿™ç§ç°è±¡å«åšæ¬ æ‹Ÿåˆã€‚</p>
<p>è¿‡æ‹Ÿåˆ</p>
<ul>
<li>åŸå› : åŸå§‹ç‰¹å¾è¿‡å¤šï¼Œå­˜åœ¨ä¸€äº›å˜ˆæ‚ç‰¹å¾ï¼Œæ¨¡å‹è¿‡äºå¤æ‚æ˜¯å› ä¸ºæ¨¡å‹æŸ¥å®å»å…¼é¡¾å„ä¸ªæµ‹è¯•æ•°æ®ç‚¹</li>
<li>è§£å†³åŠæ³•: æ­£åˆ™åŒ–</li>
</ul>
<p>è¿‡äºå¤æ‚çš„æ¨¡å‹ï¼Œå¯¹äºè®­ç»ƒæ•°æ®å¯ä»¥å¾—åˆ°è¾ƒé«˜çš„é¢„æµ‹ç²¾åº¦ï¼Œä½†å¯¹äºæµ‹è¯•æ•°æ®é€šå¸¸ç²¾åº¦è¾ƒä½ï¼Œè¿™ç§ç°è±¡å«åšè¿‡æ‹Ÿåˆã€‚</p>
<p>ä¸€ä¸ªæ€§èƒ½å¯ä»¥æ¥å—çš„å­¦ä¹ æ¨¡å‹åº”è¯¥å¯¹è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®éƒ½æœ‰æ¥è¿‘çš„é¢„æµ‹ç²¾åº¦ï¼Œè€Œä¸”ç²¾åº¦ä¸èƒ½å¤ªä½ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è®­ç»ƒé›†R2  æµ‹è¯•é›†R2</span><br><span class="line"> <span class="number">0.3</span>    <span class="number">0.4</span>    æ¬ æ‹Ÿåˆï¼šè¿‡äºç®€å•ï¼Œæ— æ³•åæ˜ æ•°æ®çš„è§„åˆ™</span><br><span class="line"> <span class="number">0.9</span>    <span class="number">0.2</span>    è¿‡æ‹Ÿåˆï¼šè¿‡äºå¤æ‚ï¼Œå¤ªç‰¹æ®Šï¼Œç¼ºä¹ä¸€èˆ¬æ€§</span><br><span class="line"> <span class="number">0.7</span>    <span class="number">0.6</span>    å¯æ¥å—ï¼šå¤æ‚åº¦é€‚ä¸­ï¼Œæ—¢åæ˜ æ•°æ®çš„è§„åˆ™ï¼ŒåŒæ—¶åˆä¸å¤±ä¸€èˆ¬æ€§</span><br></pre></td></tr></table></figure>
<h3 id="7ã€å¤šå…ƒçº¿æ€§å›å½’">7ã€å¤šå…ƒçº¿æ€§å›å½’</h3>
<p>åœ¨å›å½’åˆ†æä¸­ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è‡ªå˜é‡ï¼Œå°±ç§°ä¸ºå¤šå…ƒå›å½’ã€‚</p>
<p>ä¾‹å¦‚æˆ¿å±‹ä»·æ ¼é¢„æµ‹ï¼Œå…¶ä¸­æˆ¿å±‹ä»·æ ¼ä¼šå—åˆ°æˆ¿å±‹é¢ç§¯ï¼Œå§å®¤æ•°é‡ï¼Œæ¥¼å±‚ï¼Œæˆ¿å±‹å¹´é™ç­‰å¤šç§å› ç´ çš„å½±å“ï¼Œæ¯ä¸ªè‡ªå˜é‡å¯¹ä»·æ ¼ï¼ˆå› å˜é‡ï¼‰çš„å½±å“ç¨‹åº¦ä¸ä¸€æ ·</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://picco.eu.org//img/bizhi/20230710205809.png" alt=""></p>
<h3 id="8ã€å¤šé¡¹å¼å›å½’">8ã€å¤šé¡¹å¼å›å½’</h3>
<blockquote>
<p>å¦‚æœæ•°æ®æ¯”ç›´çº¿æ›´å¤æ‚æ€ä¹ˆåŠï¼Ÿå¯ä»¥ä½¿ç”¨çº¿æ€§æ¨¡å‹æ¥æ‹Ÿåˆéçº¿æ€§æ•°æ®ã€‚ä¸€ä¸ªç®€å•çš„æ–¹æ³•å°±æ˜¯å°†æ¯ä¸ªç‰¹å¾çš„å¹‚æ¬¡æ–¹æ·»åŠ ä¸ºä¸€ä¸ªæ–°ç‰¹å¾ï¼Œç„¶ååœ¨æ­¤æ‰©å±•ç‰¹å¾é›†ä¸Šè®­ç»ƒä¸€ä¸ªçº¿æ€§æ¨¡å‹ã€‚è¿™ç§æŠ€æœ¯ç§°ä¸ºå¤šé¡¹å¼å›å½’ã€‚</p>
</blockquote>
<h3 id="9ã€æ­£åˆ™åŒ–çº¿æ€§æ¨¡å‹">9ã€æ­£åˆ™åŒ–çº¿æ€§æ¨¡å‹</h3>
<blockquote>
<p>å‡å°‘è¿‡æ‹Ÿåˆçš„ä¸€ä¸ªå¥½æ–¹æ³•æ˜¯å¯¹æ¨¡å‹è¿›è¡Œæ­£åˆ™åŒ–ï¼ˆå³çº¦æŸæ¨¡å‹ï¼‰ï¼šå®ƒæ‹¥æœ‰çš„è‡ªç”±åº¦è¶Šå°‘ï¼Œåˆ™è¿‡æ‹Ÿåˆæ•°æ®çš„éš¾åº¦å°±è¶Šå¤§ã€‚</p>
<p>å¤šé¡¹å¼æ¨¡å‹æ­£åˆ™åŒ–çš„ä¸€ç§ç®€å•æ–¹æ³•æ˜¯å‡å°‘å¤šé¡¹å¼çš„æ¬¡æ•°ã€‚</p>
<p>çº¿æ€§æ¨¡å‹æ­£åˆ™åŒ–é€šå¸¸æ˜¯é€šè¿‡çº¦æŸæ¨¡å‹çš„æƒé‡æ¥å®ç°çš„ã€‚</p>
<p>å²­å›å½’ã€Lassoå›å½’å’Œå¼¹æ€§ç½‘ç»œï¼Œå®ƒä»¬å®ç°äº†ä¸‰ç§é™åˆ¶æƒé‡çš„æ–¹æ³•</p>
</blockquote>
<p>æˆ‘çš„ç†è§£å°±æ˜¯æ•°æ®ç§æœ‰è„æ•°æ®ï¼Œæœ‰å¼‚å¸¸å€¼å³è¿‡å¤§æˆ–è¿‡å°ï¼Œè€Œæ­£åˆ™åŒ–å°±æ˜¯æ’é™¤è¿™äº›å¼‚å¸¸</p>
<p>å„ä¸ªèŒƒå¼çš„ç†è§£ï¼š</p>
<p>â€‹	<a target="_blank" rel="noopener" href="https://blog.csdn.net/vincent_duan/article/details/117305250">https://blog.csdn.net/vincent_duan/article/details/117305250</a></p>
<ul>
<li>
<p>==<strong>å²­å›å½’</strong>==</p>
<p>å²­å›å½’ä¹Ÿç§°ä¸ºTikhonovæ­£åˆ™åŒ–ï¼Œæ˜¯çº¿æ€§å›å½’çš„æ­£åˆ™åŒ–ç‰ˆæœ¬ã€‚æ™®é€šçº¿æ€§å›å½’æ¨¡å‹ä½¿ç”¨åŸºäºæ¢¯åº¦ä¸‹é™çš„æœ€å°äºŒä¹˜æ³•ï¼Œåœ¨æœ€å°åŒ–æŸå¤±å‡½æ•°çš„å‰æä¸‹ï¼Œå¯»æ‰¾æœ€ä¼˜æ¨¡å‹å‚æ•°ï¼Œäºæ­¤è¿‡ç¨‹ä¸­ï¼ŒåŒ…æ‹¬<strong>å°‘æ•°å¼‚å¸¸æ ·æœ¬</strong>åœ¨å†…çš„å…¨éƒ¨è®­ç»ƒæ•°æ®éƒ½ä¼šå¯¹æœ€ç»ˆæ¨¡å‹å‚æ•°é€ æˆç¨‹åº¦ç›¸ç­‰çš„å½±å“ï¼Œå¼‚å¸¸å€¼å¯¹æ¨¡å‹æ‰€å¸¦æ¥å½±å“<strong>æ— æ³•åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­</strong>è¢«è¯†åˆ«å‡ºæ¥ã€‚ä¸ºæ­¤ï¼Œå²­å›å½’åœ¨æ¨¡å‹è¿­ä»£è¿‡ç¨‹æ‰€ä¾æ®çš„æŸå¤±å‡½æ•°ä¸­<strong>å¢åŠ äº†æ­£åˆ™é¡¹</strong>ï¼Œä»¥é™åˆ¶æ¨¡å‹å‚æ•°å¯¹å¼‚å¸¸æ ·æœ¬çš„åŒ¹é…ç¨‹åº¦ï¼Œè¿›è€Œæé«˜æ¨¡å‹é¢å¯¹å¤šæ•°æ­£å¸¸æ ·æœ¬çš„æ‹Ÿåˆç²¾åº¦ã€‚</p>
<p>â€‹	çº¿æ€§å›å½’+L2æ­£åˆ™é¡¹ï¼šRidge å›å½’ï¼ˆå²­å›å½’ï¼‰</p>
<ol>
<li>è¶…å‚æ•°Î³æ§åˆ¶è¦å¯¹æ¨¡å‹è¿›è¡Œæ­£åˆ™åŒ–çš„ç¨‹åº¦ã€‚å¦‚æœÎ³=0ï¼Œåˆ™å²­å›å½’ä»…æ˜¯çº¿æ€§å›å½’ã€‚å¦‚æœÎ³éå¸¸å¤§ï¼Œåˆ™æ‰€æœ‰æƒé‡æœ€ç»ˆéƒ½éå¸¸æ¥è¿‘äºé›¶ï¼Œç»“æœæ˜¯ä¸€æ¡ç»è¿‡æ•°æ®å‡å€¼çš„å¹³çº¿ã€‚</li>
<li>åœ¨æ‰§è¡Œå²­å›å½’ä¹‹å‰ç¼©æ”¾æ•°æ®ï¼ˆä¾‹å¦‚ä½¿ç”¨StandardScalerï¼‰å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒå¯¹è¾“å…¥ç‰¹å¾çš„ç¼©æ”¾æ•æ„Ÿ</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å²­å›å½’APIï¼š</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">sklearn</span>.linear_model.Ridge(alpha=<span class="number">1.0</span>, *, fit_intercept=<span class="literal">True</span>, copy_X=<span class="literal">True</span>, max_iter=<span class="literal">None</span>, tol=<span class="number">0.0001</span>, solver=<span class="string">&#x27;auto&#x27;</span>, positive=<span class="literal">False</span>, random_state=<span class="literal">None</span>, normalize=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>normalizeè®¾ç½®ä¸ºTrueç›¸å½“äºå…ˆè¿›è¡Œäº†ä¸€æ¬¡æ ‡å‡†åŒ–</li>
<li>alphaæ˜¯æ­£åˆ™åŒ–åŠ›åº¦ï¼Œå–å€¼: 0-1 1-10</li>
<li>solver:ä¼šæ ¹æ®æ•°æ®è‡ªåŠ¨é€‰æ‹©ä¼˜åŒ–æ–¹æ³•
<ul>
<li>sag:å¦‚æœæ•°æ®é›†ã€ç‰¹å¾éƒ½æ¯”è¾ƒå¤§ï¼Œé€‰æ‹©è¯¥éšæœºæ¢¯åº¦ä¸‹é™ä¼˜åŒ–</li>
</ul>
</li>
</ul>
</li>
<li>
<p>==<strong>Lasso å›å½’</strong>==</p>
<p>çº¿æ€§å›å½’+L1æ­£åˆ™é¡¹ï¼šLasso å›å½’ï¼ˆå¥—ç´¢å›å½’ï¼‰</p>
<p>ä¸å²­å›å½’ä¸€æ ·ï¼Œå®ƒä¹Ÿæ˜¯å‘æˆæœ¬å‡½æ•°æ·»åŠ ä¸€ä¸ªæ­£åˆ™é¡¹ï¼Œä½†æ˜¯å®ƒå¢åŠ çš„æ˜¯æƒé‡å‘é‡çš„L1èŒƒæ•°ï¼Œè€Œä¸æ˜¯L2èŒƒæ•°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rom sklearn <span class="keyword">import</span> linear_model</span><br><span class="line"></span><br><span class="line">linear_model.Lasso(alpha=<span class="number">1.0</span>, *, fit_intercept=<span class="literal">True</span>, normalize=<span class="literal">False</span>, precompute=<span class="literal">False</span>, copy_X=<span class="literal">True</span>, max_iter=<span class="number">1000</span>, tol=<span class="number">0.0001</span>, warm_start=<span class="literal">False</span>, positive=<span class="literal">False</span>, random_state=<span class="literal">None</span>, selection=<span class="string">&#x27;cyclic&#x27;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>==<strong>å¼¹æ€§ç½‘ç»œ</strong>==</p>
<p>å¼¹æ€§ç½‘ç»œæ˜¯ä»‹äºå²­å›å½’å’ŒLassoå›å½’ä¹‹é—´çš„ä¸­é—´åœ°å¸¦ã€‚æ­£åˆ™é¡¹æ˜¯å²­å’ŒLassoæ­£åˆ™é¡¹çš„ç®€å•æ··åˆï¼Œå¯ä»¥æ§åˆ¶æ··åˆæ¯”Ïã€‚</p>
<ul>
<li>
<p>å½“Ï=0æ—¶ï¼Œå¼¹æ€§ç½‘ç»œç­‰æ•ˆäºå²­å›å½’ï¼›</p>
</li>
<li>
<p>å½“Ï=1æ—¶ï¼Œå¼¹æ€§ç½‘ç»œç­‰äºLassoå›å½’ï¼›</p>
</li>
</ul>
<blockquote>
<p>é‚£ä¹ˆä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ™®é€šçš„çº¿æ€§å›å½’å²­ã€Lassoæˆ–å¼¹æ€§ç½‘ç»œå‘¢ï¼Ÿé€šå¸¸ï¼Œæœ‰æ­£åˆ™åŒ–ï¼Œå“ªæ€•å¾ˆå°ï¼Œæ€»æ¯”æ²¡æœ‰æ›´å¯å–ä¸€äº›ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œåº”è¯¥é¿å…ä½¿ç”¨çº¯çº¿æ€§å›å½’ã€‚å²­å›å½’æ˜¯ä¸ªä¸é”™çš„é»˜è®¤é€‰æ‹©ï¼Œä½†æ˜¯å¦‚æœå®é™…ç”¨åˆ°çš„ç‰¹å¾åªæœ‰å°‘æ•°å‡ ä¸ªï¼Œé‚£å°±åº”è¯¥æ›´å€¾å‘äºLassoå›å½’æˆ–è€…å¼¹æ€§ç½‘ç»œï¼Œå› ä¸ºå®ƒä»¬ä¼šå°†æ— ç”¨ç‰¹å¾çš„æƒé‡é™ä¸ºé›¶ã€‚ä¸€èˆ¬ï¼Œå¼¹æ€§ç½‘ç»œä¼˜äºLassoå›å½’ï¼Œå› ä¸ºå½“ç‰¹å¾æ•°é‡è¶…è¿‡è®­ç»ƒå®ä¾‹æ•°é‡ï¼Œåˆæˆ–è€…æ˜¯å‡ ä¸ªç‰¹å¾å¼ºç›¸å…³æ—¶ï¼ŒLassoå›å½’çš„è¡¨ç°å¯èƒ½éå¸¸ä¸ç¨³å®šã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> ElasticNet</span><br><span class="line"></span><br><span class="line">ElasticNet(alpha=<span class="number">1.0</span>, *, l1_ratio=<span class="number">0.5</span>, fit_intercept=<span class="literal">True</span>, normalize=<span class="literal">False</span>, precompute=<span class="literal">False</span>, max_iter=<span class="number">1000</span>, copy_X=<span class="literal">True</span>, tol=<span class="number">0.0001</span>, warm_start=<span class="literal">False</span>, positive=<span class="literal">False</span>, random_state=<span class="literal">None</span>, selection=<span class="string">&#x27;cyclic&#x27;</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="é€»è¾‘å›å½’">é€»è¾‘å›å½’</h2>
<blockquote>
<p>é€»è¾‘å›å½’åˆ†ç±»æ¨¡å‹æ˜¯ä¸€ç§åŸºäºå›å½’æ€æƒ³å®ç°åˆ†ç±»ä¸šåŠ¡çš„åˆ†ç±»æ¨¡å‹ã€‚</p>
<p>é€»è¾‘å›å½’çš„å·¥ä½œåŸç†ï¼šä¸çº¿æ€§å›å½’æ¨¡å‹ä¸€æ ·ï¼Œé€»è¾‘å›å½’æ¨¡å‹ä¹Ÿæ˜¯è®¡ç®—è¾“å…¥ç‰¹å¾çš„åŠ æƒå’Œï¼ˆåŠ ä¸Šåç½®é¡¹ï¼‰ï¼Œä½†æ˜¯ä¸åŒäºçº¿æ€§å›å½’æ¨¡å‹ç›´æ¥è¾“å‡ºç»“æœï¼Œå®ƒè¾“å‡ºçš„æ˜¯ç»“æœçš„æ•°ç†é€»è¾‘ã€‚åˆ†ç±»é—®é¢˜å¯ä»¥åˆ†ä¸ºäºŒå…ƒåˆ†ç±»ï¼ˆOvO:one-versus-allï¼‰å’Œå¤šå…ƒåˆ†ç±»(OvR:one-versus-all)ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:%5CUsers%5Cbeihai%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230711084936733.png" alt="image-20230711084936733"></p>
<p>é€»è¾‘å›å½’åšäºŒå…ƒåˆ†ç±»æ—¶çš„æ ¸å¿ƒæ€æƒ³ä¸ºï¼š</p>
<p>é’ˆå¯¹è¾“å‡ºä¸º{0, 1}çš„å·²çŸ¥è®­ç»ƒæ ·æœ¬è®­ç»ƒä¸€ä¸ªå›å½’æ¨¡å‹ï¼Œä½¿å¾—è®­ç»ƒæ ·æœ¬çš„é¢„æµ‹è¾“å‡ºé™åˆ¶åœ¨(0, 1)çš„æ•°å€¼åŒºé—´ã€‚è¯¥æ¨¡å‹ä½¿åŸç±»åˆ«ä¸º0çš„æ ·æœ¬çš„è¾“å‡ºæ›´æ¥è¿‘äº0ï¼ŒåŸç±»åˆ«ä¸º1çš„æ ·æœ¬çš„è¾“å‡ºæ›´æ¥è¿‘äº1ã€‚è¿™æ ·å°±å¯ä»¥ä½¿ç”¨ç›¸åŒçš„å›å½’æ¨¡å‹æ¥å®Œæˆåˆ†ç±»é¢„æµ‹ã€‚</p>
</blockquote>
<h3 id="1ã€é€»è¾‘å›å½’åŸç†">1ã€é€»è¾‘å›å½’åŸç†</h3>
<p>é€»è¾‘å›å½’ç›®æ ‡å‡½æ•°ï¼š<br>
$$<br>
é€»è¾‘å‡½æ•°(sigmoid)ï¼šy=1/(1+e^(-z) );â€z=w^T x+b<br>
$$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é€»è¾‘å›å½’ç›¸å…³APIï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sklearn.linear_model <span class="keyword">as</span> lm		<span class="comment"># logist:é€»è¾‘</span></span><br><span class="line"><span class="comment"># æ„å»ºé€»è¾‘å›å½’å™¨ 		</span></span><br><span class="line"><span class="comment"># solverï¼šé€»è¾‘å‡½æ•°ä¸­æŒ‡æ•°çš„å‡½æ•°å…³ç³»ï¼ˆliblinearä¸ºçº¿å‹å‡½æ•°å…³ç³»ï¼‰</span></span><br><span class="line"><span class="comment"># Cï¼šå‚æ•°ä»£è¡¨æ­£åˆ™å¼ºåº¦ï¼Œä¸ºäº†é˜²æ­¢è¿‡æ‹Ÿåˆã€‚æ­£åˆ™è¶Šå¤§æ‹Ÿåˆæ•ˆæœè¶Šå°ã€‚</span></span><br><span class="line">model = lm.LogisticRegression(solver=<span class="string">&#x27;liblinear&#x27;</span>, C=æ­£åˆ™å¼ºåº¦)</span><br><span class="line">model.fit(è®­ç»ƒè¾“å…¥é›†ï¼Œè®­ç»ƒè¾“å‡ºé›†)</span><br><span class="line">result = model.predict(å¸¦é¢„æµ‹è¾“å…¥é›†)</span><br></pre></td></tr></table></figure>
<h3 id="2ã€äº¤å‰éªŒè¯">2ã€äº¤å‰éªŒè¯</h3>
<blockquote>
<p>åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œå› ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„æ•°æ®åˆ’åˆ†æ˜¯éšæœºçš„ï¼Œæ‰€ä»¥æœ‰æ—¶ä¼šé‡å¤åœ°ä½¿ç”¨æ•°æ®ï¼Œä»¥ä¾¿æ›´å¥½åœ°è¯„ä¼°æ¨¡å‹çš„æœ‰æ•ˆæ€§ï¼Œå¹¶é€‰å‡ºæœ€å¥½çš„æ¨¡å‹ï¼Œè¯¥åšæ³•ç§°ä¸ºäº¤å‰éªŒè¯ã€‚å…·ä½“è€Œè¨€å°±æ˜¯å¯¹åŸå§‹æ ·æœ¬æ•°æ®è¿›è¡Œåˆ‡åˆ†ï¼Œç„¶åç»„åˆæˆä¸ºå¤šç»„ä¸åŒçš„è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œç”¨è®­ç»ƒé›†è®­ç»ƒæ¨¡å‹ï¼Œç”¨æµ‹è¯•é›†è¯„ä¼°æ¨¡å‹ã€‚æŸæ¬¡çš„è®­ç»ƒé›†å¯èƒ½æ˜¯ä¸‹æ¬¡çš„æµ‹è¯•é›†ï¼Œæ•…è€Œç§°ä¸ºäº¤å‰éªŒè¯ã€‚</p>
<p>äº¤å‰éªŒè¯çš„æ–¹æ³•æœ‰ç®€å•äº¤å‰éªŒè¯ã€KæŠ˜äº¤å‰éªŒè¯å’Œç•™ä¸€äº¤å‰éªŒè¯3ç§ã€‚å…¶ä¸­KæŠ˜äº¤å‰éªŒè¯åº”ç”¨è¾ƒä¸ºå¹¿æ³›ï¼Œå®ƒæ˜¯æŒ‡å°†æ•°æ®é›†éšæœºç­‰åˆ†ä¸ºKä»½ï¼Œæ¯æ¬¡é€‰å–K-1ä»½ä½œä¸ºè®­ç»ƒé›†ï¼Œç”¨å‰©ä¸‹çš„1ä»½ä½œä¸ºæµ‹è¯•é›†ï¼Œå¾—åˆ°Kä¸ªæ¨¡å‹åå°†è¿™Kä¸ªæ¨¡å‹çš„å¹³å‡æµ‹è¯•æ•ˆæœä½œä¸ºæœ€ç»ˆçš„æ¨¡å‹æ•ˆæœã€‚</p>
<p>é€šå¸¸æ¥è¯´ï¼Œå¦‚æœè®­ç»ƒé›†ç›¸å¯¹è¾ƒå°ï¼Œåˆ™å¢å¤§Kå€¼ï¼Œè¿™æ ·åœ¨æ¯æ¬¡è¿­ä»£è¿‡ç¨‹ä¸­å°†ä¼šæœ‰æ›´å¤šæ•°æ®ç”¨äºæ¨¡å‹è®­ç»ƒï¼ŒåŒæ—¶ç®—æ³•æ—¶é—´å»¶é•¿ï¼›å¦‚æœè®­ç»ƒé›†ç›¸å¯¹è¾ƒå¤§ï¼Œåˆ™å‡å°Kå€¼ï¼Œè¿™æ ·å¯ä»¥é™ä½æ¨¡å‹åœ¨ä¸åŒçš„æ•°æ®å—ä¸Šè¿›è¡Œé‡å¤æ‹Ÿåˆæ€§èƒ½è¯„ä¼°çš„è®¡ç®—æˆæœ¬ï¼Œåœ¨å¹³å‡æ€§èƒ½çš„åŸºç¡€ä¸Šè·å¾—æ¨¡å‹çš„å‡†ç¡®è¯„ä¼°ã€‚</p>
<p>é™¤äº†æ›´ç²¾ç¡®åœ°è¯„ä¼°æ¨¡å‹ï¼Œäº¤å‰éªŒè¯çš„å¦ä¸€ä¸ªé‡è¦ä½œç”¨å°±æ˜¯åˆ©ç”¨æ›´ç²¾ç¡®çš„è¯„ä¼°ç»“æœå¯¹æ¨¡å‹è¿›è¡Œå‚æ•°è°ƒä¼˜ï¼Œå®ƒç»å¸¸ä¸<code>GridSearch</code>ç½‘æ ¼æœç´¢é…åˆä½¿ç”¨ã€‚</p>
</blockquote>
<p>å°±æ˜¯æŠŠå°†è®­ç»ƒé›†åˆ†ä¸ºä¸åŒçš„æŠ˜ï¼Œç„¶åå°†æµ‹è¯•é›†äº¤å‰æ”¾è¿›å»ä¸è®­ç»ƒé›†æ‹Ÿåˆï¼Œå¥½å¤„å°±æ˜¯å¯ä»¥å­¦åˆ°è®­ç»ƒé›†çš„ç»†èŠ‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:%5CUsers%5Cbeihai%5CDesktop%5Cgrid_search_cross_validation.png" alt="grid_search_cross_validation"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sklearnæä¾›äº†äº¤å‰éªŒè¯ç›¸å…³APIï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sklearn.model_selection <span class="keyword">as</span> ms</span><br><span class="line">æŒ‡æ ‡å€¼æ•°ç»„ = ms.cross_val_score(æ¨¡å‹, è¾“å…¥é›†, è¾“å‡ºé›†, cv=æŠ˜å æ•°, scoring=æŒ‡æ ‡å)</span><br></pre></td></tr></table></figure>
<h3 id="3ã€æ•°æ®é›†åˆ’åˆ†">3ã€æ•°æ®é›†åˆ’åˆ†</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æ•°æ®é›†åˆ’åˆ†ç›¸å…³APIï¼š</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sklearn.model_selection <span class="keyword">as</span> ms</span><br><span class="line"> </span><br><span class="line"> X_train, X_test, y_train, y_test = ms.train_test_split(X, y, test_size=æµ‹è¯•é›†å æ¯”, random_state=éšæœºç§å­)</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>å‚æ•°åç§°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>*arrays</td>
<td>æ¥æ”¶ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®é›†ã€‚ä»£è¡¨éœ€è¦åˆ’åˆ†çš„æ•°æ®é›†ï¼Œè‹¥ä¸ºåˆ†ç±»å›å½’åˆ™åˆ†åˆ«ä¼ å…¥æ•°æ®å’Œæ ‡ç­¾ï¼Œè‹¥ä¸ºèšç±»åˆ™ä¼ å…¥æ•° æ®ã€‚æ— é»˜è®¤ã€‚</td>
</tr>
<tr>
<td>test_size</td>
<td>æ¥æ”¶floatï¼Œintï¼ŒNoneç±»å‹çš„æ•°æ®ã€‚ä»£è¡¨æµ‹è¯•é›†çš„å¤§å°ã€‚å¦‚æœä¼ å…¥çš„ä¸ºfloatç±»å‹çš„æ•°æ®åˆ™éœ€è¦é™å®šåœ¨0-1ä¹‹ é—´ï¼Œä»£è¡¨æµ‹è¯•é›†åœ¨æ€»æ•°ä¸­çš„å æ¯”ï¼›å¦‚æœä¼ å…¥ä¸ºintç±»å‹çš„æ•°æ®ï¼Œåˆ™è¡¨ç¤ºæµ‹è¯•é›†è®°å½•çš„ç»å¯¹æ•°ç›®ã€‚è¯¥å‚æ•°ä¸  train_sizeå¯ä»¥åªä¼ å…¥ä¸€ä¸ªã€‚åœ¨0.21ç‰ˆæœ¬å‰ï¼Œè‹¥test_sizeå’Œtrain_sizeå‡ä¸ºé»˜è®¤åˆ™testsizeä¸º25%ã€‚</td>
</tr>
<tr>
<td>train_size</td>
<td>æ¥æ”¶floatï¼Œintï¼ŒNoneç±»å‹çš„æ•°æ®ã€‚ä»£è¡¨è®­ç»ƒé›†çš„å¤§å°ã€‚è¯¥å‚æ•°ä¸test_sizeå¯ä»¥åªä¼ å…¥ä¸€ä¸ªã€‚</td>
</tr>
<tr>
<td>random_state</td>
<td>æ¥æ”¶intã€‚ä»£è¡¨éšæœºç§å­ç¼–å·ï¼Œç›¸åŒéšæœºç§å­ç¼–å·äº§ç”Ÿç›¸åŒçš„éšæœºç»“æœï¼Œä¸åŒçš„éšæœºç§å­ç¼–å·äº§ç”Ÿä¸åŒçš„éšæœºç»“æœã€‚é»˜è®¤ä¸ºNoneã€‚random_stateå°±æ˜¯ä¸ºäº†ä¿è¯ç¨‹åºæ¯æ¬¡è¿è¡Œéƒ½åˆ†å‰²ä¸€æ ·çš„è®­ç»ƒé›†åˆæµ‹è¯•é›†ã€‚</td>
</tr>
<tr>
<td>shuffle</td>
<td>æ¥æ”¶booleanã€‚ä»£è¡¨æ˜¯å¦è¿›è¡Œæœ‰æ”¾å›æŠ½æ ·ã€‚è‹¥è¯¥å‚æ•°å–å€¼ä¸ºTrueåˆ™stratifyå‚æ•°å¿…é¡»ä¸èƒ½ä¸ºç©ºã€‚</td>
</tr>
<tr>
<td>stratify</td>
<td>æ¥æ”¶arrayæˆ–è€…Noneã€‚å¦‚æœä¸ä¸ºNoneï¼Œåˆ™ä½¿ç”¨ä¼ å…¥çš„æ ‡ç­¾è¿›è¡Œåˆ†å±‚æŠ½æ ·ã€‚</td>
</tr>
</tbody>
</table>
<p>train_test_splitæ˜¯æœ€å¸¸ç”¨çš„æ•°æ®åˆ’åˆ†æ–¹æ³•ï¼Œåœ¨model_selectionæ¨¡å—ä¸­è¿˜æä¾›äº†å…¶ä»–æ•°æ®é›†åˆ’åˆ†çš„å‡½æ•°ï¼Œå¦‚<code>PredefinedSplit</code>ï¼Œ<code>ShuffleSplit</code>ç­‰ã€‚</p>
<p>åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†åœ¨æŸç§ç¨‹åº¦ä¸Šä¹Ÿæ˜¯ä¸ºäº†æ£€æŸ¥æ¨¡å‹æ˜¯å¦å‡ºç°è¿‡æ‹Ÿåˆã€‚è¿‡æ‹ŸåˆæŒ‡æ¨¡å‹åœ¨è®­ç»ƒæ ·æœ¬ä¸­æ‹Ÿåˆç¨‹åº¦è¿‡é«˜ï¼Œè™½ç„¶å®ƒå¾ˆå¥½åœ°å¥‘åˆäº†è®­ç»ƒé›†æ•°æ®ï¼Œä½†æ˜¯å´ä¸§å¤±äº†æ³›åŒ–èƒ½åŠ›ï¼Œå› è€Œä¸å…·æœ‰æ¨å¹¿æ€§ï¼Œå¯¼è‡´åœ¨æµ‹è¯•é›†æ•°æ®ä¸­çš„é¢„æµ‹è¡¨ç°ä¸ä½³ã€‚å°±å¥½æ¯”æ¯æ¬¡æ¨¡è€ƒéƒ½åšåŒä¸€ä»½å·å­ï¼Œè®­ç»ƒæ—¶å¾—åˆ†å¾ˆé«˜ï¼Œä½†æ˜¯æœŸæœ«è€ƒè¯•æ¢äº†ä¸€å¥—å·å­å°±å¾—åˆ†å¾ˆä½ã€‚è€Œåˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†å¯ä»¥ç”¨æ¥å¯¹æ¨¡å‹è¿›è¡Œæ›´å¥½çš„æ£€éªŒã€‚</p>
<h3 id="4ã€æ¨¡å‹æ­å»º">4ã€æ¨¡å‹æ­å»º</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ¨¡å‹çš„æ­å»ºç›¸å¯¹æ¯”è¾ƒå®¹æ˜“ï¼Œé€»è¾‘å›å½’ç›¸å…³APIï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sklearn.linear_model <span class="keyword">as</span> lm</span><br><span class="line"> <span class="comment"># æ„å»ºé€»è¾‘å›å½’å™¨ </span></span><br><span class="line"> <span class="comment"># solverï¼šé€»è¾‘å‡½æ•°ä¸­æŒ‡æ•°çš„å‡½æ•°å…³ç³»ï¼ˆliblinearä¸ºçº¿å‹å‡½æ•°å…³ç³»ï¼‰</span></span><br><span class="line"> <span class="comment"># Cï¼šå‚æ•°ä»£è¡¨æ­£åˆ™å¼ºåº¦ï¼Œåå€¼ï¼Œä¸ºäº†é˜²æ­¢è¿‡æ‹Ÿåˆã€‚æ­£åˆ™è¶Šå¤§æ‹Ÿåˆæ•ˆæœè¶Šå°ã€‚</span></span><br><span class="line"></span><br><span class="line"> model = lm.LogisticRegression(solver=<span class="string">&#x27;liblinear&#x27;</span>, C=æ­£åˆ™å¼ºåº¦)</span><br><span class="line"> model.fit(X_trainï¼Œy_train)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">å¦‚æœè¿™é‡Œsolverä¸é€‰æ‹©liblinear ä¼šé»˜è®¤é€‰æ‹© lbfgs</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å®˜ç½‘è¿™æ ·è¯´çš„ï¼šThe â€˜newton-cgâ€™, â€˜sagâ€™, and â€˜lbfgsâ€™ solvers support only L2 regularization with primal formulation, or no regularization. The â€˜liblinearâ€™ solver supports both L1 and L2 regularization, with a dual formulation only for the L2 penalty. The Elastic-Net regularization is only supported by the â€˜sagaâ€™ solver.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="5ã€åˆ†ç±»é—®é¢˜æ¨¡å‹è¯„ä¼°">5ã€åˆ†ç±»é—®é¢˜æ¨¡å‹è¯„ä¼°</h3>
<ul>
<li>
<p>==<strong>ä¸€çº§æŒ‡æ ‡</strong>==</p>
<blockquote>
<p>åˆ†ç±»æ¨¡å‹çš„è¯„ä»·æŒ‡æ ‡ï¼šçœŸå‡ä¸æ­£ç±»è´Ÿç±»</p>
<p>a. çœŸæ­£ä¾‹(TP) æ˜¯æŒ‡æ¨¡å‹å°†æ­£ç±»åˆ«æ ·æœ¬æ­£ç¡®åœ°é¢„æµ‹ä¸ºæ­£ç±»åˆ«ã€‚</p>
<p>b. çœŸè´Ÿä¾‹(TN) æ˜¯æŒ‡æ¨¡å‹å°†è´Ÿç±»åˆ«æ ·æœ¬æ­£ç¡®åœ°é¢„æµ‹ä¸ºè´Ÿç±»åˆ«ã€‚</p>
<p>c. å‡æ­£ä¾‹(FP) æ˜¯æŒ‡æ¨¡å‹å°†è´Ÿç±»åˆ«æ ·æœ¬é”™è¯¯åœ°é¢„æµ‹ä¸ºæ­£ç±»åˆ«ã€‚</p>
<p>d. å‡è´Ÿä¾‹(FN) æ˜¯æŒ‡å°†æ­£ç±»åˆ«æ ·æœ¬é”™è¯¯åœ°é¢„æµ‹ä¸ºè´Ÿç±»åˆ«ã€‚</p>
</blockquote>
<p><strong>æ··æ·†çŸ©é˜µ</strong></p>
<p>æ··æ·†çŸ©é˜µï¼ˆä¹Ÿç§°è¯¯å·®çŸ©é˜µï¼ŒConfusion Matrixï¼‰å°±æ˜¯åˆ†åˆ«ç»Ÿè®¡åˆ†ç±»æ¨¡å‹å½’é”™ç±»ï¼Œå½’å¯¹ç±»çš„è§‚æµ‹å€¼ä¸ªæ•°ï¼Œç„¶åæŠŠç»“æœæ”¾åœ¨ä¸€ä¸ªè¡¨é‡Œå±•ç¤ºå‡ºæ¥ã€‚è¿™ä¸ªè¡¨å°±æ˜¯æ··æ·†çŸ©é˜µã€‚</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th>çœŸå®å€¼</th>
<th>çœŸå®å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td>Positive</td>
<td>Negative</td>
</tr>
<tr>
<td>é¢„æµ‹å€¼</td>
<td>Positive</td>
<td>çœŸæ­£ä¾‹ï¼ˆTP)</td>
<td>å‡æ­£ä¾‹ï¼ˆFP)</td>
</tr>
<tr>
<td>é¢„æµ‹å€¼</td>
<td>Negative</td>
<td>å‡è´Ÿä¾‹ï¼ˆFN)</td>
<td>çœŸè´Ÿä¾‹ï¼ˆTN)</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è·å–æ¨¡å‹åˆ†ç±»ç»“æœçš„æ··æ·†çŸ©é˜µçš„ç›¸å…³APIï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sklearn.metrics <span class="keyword">as</span> sm</span><br><span class="line">æ··æ·†çŸ©é˜µ = sm.confusion_matrix(å®é™…è¾“å‡º, é¢„æµ‹è¾“å‡º)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>==<strong>äºŒçº§æŒ‡æ ‡</strong>==</p>
<p>å‡†ç¡®ç‡(accuracy)ï¼šæ˜¯æŒ‡æ¨¡å‹é¢„æµ‹æ­£ç¡®çš„æ ·æœ¬æ•°æ¯”ä¸Šæ€»æ ·æœ¬æ•°çš„æ¯”é‡ã€‚</p>
<p>è®¡ç®—å…¬å¼ï¼šaccuracy = (TP + TN) / (TP + TN + FP + FN)</p>
<p>ç²¾ç¡®ç‡(precision_weighted)ï¼šé’ˆå¯¹æ¯ä¸€ä¸ªç±»åˆ«ï¼Œé¢„æµ‹æ­£ç¡®çš„æ ·æœ¬æ•°æ¯”ä¸Šé¢„æµ‹å‡ºæ¥çš„æ ·æœ¬æ•°ã€‚</p>
<p>è®¡ç®—å…¬å¼ï¼šprecision_weighted = TP / TP + FP</p>
<p>å¬å›ç‡(recall_weighted)ï¼šé’ˆå¯¹æ¯ä¸€ä¸ªç±»åˆ«ï¼Œé¢„æµ‹æ­£ç¡®çš„æ ·æœ¬æ•°æ¯”ä¸Šå®é™…å­˜åœ¨çš„æ ·æœ¬æ•°ã€‚</p>
<p>â€‹       è®¡ç®—å…¬å¼ï¼šrecall_weighted = TP / TP + FN</p>
<p>æŸæ± å¡˜æœ‰1400æ¡é²¤é±¼ï¼Œ300åªè™¾ï¼Œ300åªé³–ã€‚ç°åœ¨ä»¥æ•é²¤é±¼ä¸ºç›®çš„ã€‚ æ’’ä¸€å¤§ç½‘ï¼Œé€®ç€äº†700æ¡é²¤é±¼ï¼Œ200åªè™¾ï¼Œ100åªé³–ã€‚é‚£ä¹ˆï¼Œè¿™äº›æŒ‡æ ‡ åˆ†åˆ«å¦‚ä¸‹ï¼š<br>
ç²¾ç¡®ç‡ = 700 / (700 + 200 + 100) = 70%<br>
å¬å›ç‡ = 700 / 1400 = 50%<br>
Få€¼ = 70% * 50% * 2 / (70% + 50%) = 58.3%</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># API</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡†ç¡®ç‡</span></span><br><span class="line">sm.accuracy_score(test_y, pred_y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç²¾ç¡®ç‡</span></span><br><span class="line">sm.precision_score(test_y, pred_y)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">è¿™é‡Œä¼šæŠ¥é”™ï¼š</span></span><br><span class="line"><span class="string">		ValueError: Target is multiclass but average=&#x27;binary&#x27;. Please choose another average setting, one of [None, &#x27;micro&#x27;, &#x27;macro&#x27;, &#x27;weighted&#x27;].</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">åªéœ€è¦æ›´æ”¹ï¼š</span></span><br><span class="line"><span class="string">sm.precision_score(test_y, pred_y, average=None)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># æ›´æ”¹ä¸ºï¼›</span></span><br><span class="line">sm.precision_score(test_y, pred_y, average=<span class="literal">None</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">array([0.8       , 0.94444444, 1.        ])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç²¾ç¡®ç‡</span></span><br><span class="line">sm.precision_score(test_y, pred_y, average=<span class="string">&#x27;macro&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0.9148148148148149</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¬å›ç‡</span></span><br><span class="line">sm.recall_score(test_y, pred_y, average=<span class="literal">None</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">array([0.88888889, 0.89473684, 1.        ])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¬å›ç‡</span></span><br><span class="line">sm.recall_score(test_y, pred_y, average=<span class="string">&#x27;macro&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0.9278752436647174</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ç²¾ç¡®ç‡å’Œå¬å›ç‡æœ‰ä¸€å®šå…³ç³» -&gt;</p>
<ol>
<li>ç²¾ç¡®ç‡æ˜¯é¢„æµ‹æ­£ç¡®çš„æ¯”ä¸Šé¢„æµ‹å‡ºæ¥çš„</li>
<li>å¬å›ç‡æ˜¯é¢„æµ‹æ­£ç¡®çš„æ¯”ä¸ŠåŸæ¥å°±æœ‰çš„</li>
<li>è®°ä½ä¸€ä¸ªç»“è®ºï¼šç²¾ç¡®ç‡å’Œå¬å›ç‡æ˜¯æ­¤æ¶ˆå½¼é•¿çš„å…³ç³»</li>
<li>ä¾‹å¦‚ï¼šæŠ–éŸ³å®¡æ ¸ï¼Œç²¾ç¡®ç‡ä¸Šå‡ï¼Œå¬å›ç‡ä¸‹é™</li>
</ol>
</li>
<li>
<p>==<strong>ä¸‰çº§æŒ‡æ ‡</strong>==</p>
<blockquote>
<p>â€¢      F1_Score(f1_weighted)ï¼š2xç²¾ç¡®ç‡xå¬å›ç‡/(ç²¾ç¡®ç‡+å¬å›ç‡)</p>
<p>åˆ†ç±»æ¨¡å‹å¯¹æµ‹è¯•é›†è¿›è¡Œé¢„æµ‹è€Œå¾—å‡ºçš„å‡†ç¡®ç‡(accuracy)å¹¶ä¸èƒ½å¾ˆå¥½åœ°åæ˜ æ¨¡å‹çš„æ€§èƒ½ï¼Œä¸ºäº†æœ‰æ•ˆåˆ¤æ–­ä¸€ä¸ªé¢„æµ‹æ¨¡å‹çš„æ€§èƒ½è¡¨ç°ï¼Œéœ€è¦ç»“åˆçœŸå®å€¼ï¼Œè®¡ç®—å‡ºç²¾ç¡®ç‡(precision_weighted)ã€å¬å›ç‡(recall_weighted)ã€F1_Scoreå’ŒCohenâ€™s Kappaç³»æ•°ç­‰æŒ‡æ ‡æ¥è¡¡é‡ã€‚åˆ†å€¼è¶Šé«˜è¶Šå¥½ã€‚</p>
<p>è¦å…¨é¢è¯„ä¼°æ¨¡å‹çš„æœ‰æ•ˆæ€§ï¼Œå¿…é¡»<strong>åŒæ—¶</strong>æ£€æŸ¥ç²¾ç¡®ç‡(precision_weighted)å’Œå¬å›ç‡(recall_weighted)ã€‚é—æ†¾çš„æ˜¯ï¼Œç²¾ç¡®ç‡å’Œå¬å›ç‡å¾€å¾€æ˜¯æ­¤æ¶ˆå½¼é•¿çš„æƒ…å†µã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæé«˜ç²¾ç¡®ç‡é€šå¸¸ä¼šé™ä½å¬å›ç‡å€¼ï¼Œåä¹‹äº¦ç„¶ã€‚æé«˜åˆ†ç±»é˜ˆå€¼ï¼Œç²¾ç¡®ç‡å¯èƒ½ä¼šæé«˜ï¼ˆå› ä¸ºFPå¯èƒ½ä¼šå‡å°ï¼‰ï¼›å¬å›ç‡ä¼šä¸‹é™æˆ–ä¿æŒä¸å˜ï¼ˆå› ä¸ºTPä¼šå‡å°‘æˆ–ä¸å˜ï¼Œä¸”FNä¼šå¢åŠ æˆ–ä¸å˜ï¼‰ã€‚é™ä½åˆ†ç±»é˜ˆå€¼ï¼Œç²¾ç¡®ç‡å¯èƒ½ä¼šä¸‹é™ï¼ˆå› ä¸ºFPå¯èƒ½ä¼šå¢åŠ ï¼‰ï¼Œè€Œå¬å›ç‡ï¼ˆFNå¯èƒ½ä¼šå‡å°‘ï¼‰å¯èƒ½ä¼šæœ‰æ‰€æé«˜ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># f1å¾—åˆ†  -&gt; å¬å›ç‡å’Œç²¾ç¡®ç‡</span></span><br><span class="line">sm.f1_score(test_y, pred_y, average=<span class="string">&#x27;macro&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0.9203413940256047</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†ç±»æŠ¥å‘Š</span></span><br><span class="line"><span class="built_in">print</span>(sm.classification_report(test_y, pred_y))</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">			precision    recall  f1-score   support</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">           0       0.80      0.89      0.84         9</span></span><br><span class="line"><span class="string">           1       0.94      0.89      0.92        19</span></span><br><span class="line"><span class="string">           2       1.00      1.00      1.00        17</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    accuracy                           0.93        45</span></span><br><span class="line"><span class="string">   macro avg       0.91      0.93      0.92        45</span></span><br><span class="line"><span class="string">weighted avg       0.94      0.93      0.93        45</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="6ã€çº¢é…’åˆ†ç±»">6ã€çº¢é…’åˆ†ç±»</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets <span class="keyword">as</span> sd</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> model_selection <span class="keyword">as</span> ms</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> linear_model <span class="keyword">as</span> lm</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> metrics <span class="keyword">as</span> sm</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ•°æ®</span></span><br><span class="line">data = sd.load_wine()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ä¸€äº›æ•°æ®è¯¦æƒ…</span></span><br><span class="line"><span class="built_in">print</span>(data[<span class="string">&#x27;DESCR&#x27;</span>])</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> ============================= ==== ===== ======= =====</span></span><br><span class="line"><span class="string">                                   Min   Max   Mean     SD</span></span><br><span class="line"><span class="string">    ============================= ==== ===== ======= =====</span></span><br><span class="line"><span class="string">    Alcohol:                      11.0  14.8    13.0   0.8</span></span><br><span class="line"><span class="string">    Malic Acid:                   0.74  5.80    2.34  1.12</span></span><br><span class="line"><span class="string">    Ash:                          1.36  3.23    2.36  0.27</span></span><br><span class="line"><span class="string">    Alcalinity of Ash:            10.6  30.0    19.5   3.3</span></span><br><span class="line"><span class="string">    Magnesium:                    70.0 162.0    99.7  14.3</span></span><br><span class="line"><span class="string">    Total Phenols:                0.98  3.88    2.29  0.63</span></span><br><span class="line"><span class="string">    Flavanoids:                   0.34  5.08    2.03  1.00</span></span><br><span class="line"><span class="string">    Nonflavanoid Phenols:         0.13  0.66    0.36  0.12</span></span><br><span class="line"><span class="string">    Proanthocyanins:              0.41  3.58    1.59  0.57</span></span><br><span class="line"><span class="string">    Colour Intensity:              1.3  13.0     5.1   2.3</span></span><br><span class="line"><span class="string">    Hue:                          0.48  1.71    0.96  0.23</span></span><br><span class="line"><span class="string">    OD280/OD315 of diluted wines: 1.27  4.00    2.61  0.71</span></span><br><span class="line"><span class="string">    Proline:                       278  1680     746   315</span></span><br><span class="line"><span class="string">    ============================= ==== ===== ======= =====</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–ç‰¹å¾å€¼å’Œç›®æ ‡å€¼</span></span><br><span class="line">x = data[<span class="string">&#x27;data&#x27;</span>]</span><br><span class="line">y = data[<span class="string">&#x27;target&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ’åˆ†æ•°æ®é›†</span></span><br><span class="line">train_x, test_x, train_y, test_y = ms.train_test_split(x, y, train_size=<span class="number">0.75</span>, shuffle=<span class="literal">True</span>, random_state=<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é€‰æ‹©æ¨¡å‹</span></span><br><span class="line">model = lm.LogisticRegression(solver=<span class="string">&#x27;liblinear&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">è¿™é‡Œsolveråˆ‡è®°è¦åˆ‡æ¢æ¨¡å‹ ä¸ç„¶ä¸‹é¢è®­ç»ƒæ¨¡å‹ä¼šå‡ºé”™</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®­ç»ƒæ¨¡å‹</span></span><br><span class="line">model.fit(train_x, train_y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„æµ‹æ¨¡å‹</span></span><br><span class="line">pred_y = model.predict(test_x)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">array([2, 0, 2, 2, 1, 2, 1, 0, 1, 2, 0, 1, 2, 1, 1, 1, 1, 2, 0, 0, 0, 1,</span></span><br><span class="line"><span class="string">       1, 1, 0, 2, 1, 2, 2, 2, 1, 1, 2, 1, 1, 1, 2, 2, 0, 2, 0, 0, 2, 2,</span></span><br><span class="line"><span class="string">       1])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¹æ¯”çœŸå®å€¼</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">array([2, 0, 2, 2, 1, 2, 1, 0, 1, 2, 0, 1, 2, 1, 1, 1, 1, 2, 0, 0, 1, 1,</span></span><br><span class="line"><span class="string">       1, 1, 0, 2, 1, 2, 2, 2, 1, 0, 2, 1, 1, 1, 2, 2, 0, 2, 0, 1, 2, 2,</span></span><br><span class="line"><span class="string">       1])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ··æ·†çŸ©é˜µ</span></span><br><span class="line">sm.confusion_matrix(test_y, pred_y)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">array([[ 8,  1,  0],</span></span><br><span class="line"><span class="string">       [ 2, 17,  0],</span></span><br><span class="line"><span class="string">       [ 0,  0, 17]], dtype=int64)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">è¿™é‡Œæ¨ªè½´ç›¸åŠ ä¸ºçœŸå®å€¼çš„å„ä¸ªç±»çš„æ€»å’Œ</span></span><br><span class="line"><span class="string">çºµè½´ç›¸åŠ ä¸ºé¢„æµ‹å€¼çš„å„ä¸ªç±»çš„æ€»å’Œ</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è¯„ä¼°</span></span><br><span class="line"><span class="comment"># å‡†ç¡®ç‡</span></span><br><span class="line">sm.accuracy_score(test_y, pred_y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç²¾ç¡®ç‡</span></span><br><span class="line">sm.precision_score(test_y, pred_y, average=<span class="string">&#x27;macro&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0.9148148148148149</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¬å›ç‡</span></span><br><span class="line">sm.recall_score(test_y, pred_y, average=<span class="literal">None</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">array([0.88888889, 0.89473684, 1.        ])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¬å›ç‡</span></span><br><span class="line">sm.recall_score(test_y, pred_y, average=<span class="string">&#x27;macro&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0.9278752436647174</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># f1å¾—åˆ†  -&gt; å¬å›ç‡å’Œç²¾ç¡®ç‡</span></span><br><span class="line">sm.f1_score(test_y, pred_y, average=<span class="string">&#x27;macro&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0.9203413940256047</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†ç±»æŠ¥å‘Š</span></span><br><span class="line"><span class="built_in">print</span>(sm.classification_report(test_y, pred_y))</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">			precision    recall  f1-score   support</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">           0       0.80      0.89      0.84         9</span></span><br><span class="line"><span class="string">           1       0.94      0.89      0.92        19</span></span><br><span class="line"><span class="string">           2       1.00      1.00      1.00        17</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    accuracy                           0.93        45</span></span><br><span class="line"><span class="string">   macro avg       0.91      0.93      0.92        45</span></span><br><span class="line"><span class="string">weighted avg       0.94      0.93      0.93        45</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="å†³ç­–æ ‘">å†³ç­–æ ‘</h2>
<p>**å†³ç­–æ ‘æ¨¡å‹çš„å‡ ä¸ªé‡è¦æ¦‚å¿µï¼š**çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹ã€æ ¹èŠ‚ç‚¹å’Œå¶å­èŠ‚ç‚¹ã€‚</p>
<p>çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹æ˜¯ç›¸å¯¹çš„ï¼Œå­èŠ‚ç‚¹ç”±çˆ¶èŠ‚ç‚¹æ ¹æ®æŸä¸€è§„åˆ™åˆ†è£‚è€Œæ¥ï¼Œç„¶åå­èŠ‚ç‚¹ä½œä¸ºæ–°çš„çˆ¶èŠ‚ç‚¹ç»§ç»­åˆ†è£‚ï¼Œç›´è‡³ä¸èƒ½åˆ†è£‚ä¸ºæ­¢ã€‚</p>
<p>æ ¹èŠ‚ç‚¹åˆ™å’Œå¶å­èŠ‚ç‚¹æ˜¯ç»å¯¹çš„ï¼Œæ ¹èŠ‚ç‚¹æ˜¯æ²¡æœ‰çˆ¶èŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼Œå³åˆå§‹èŠ‚ç‚¹ï¼Œå¶å­èŠ‚ç‚¹åˆ™æ˜¯æ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼Œå³æœ€ç»ˆèŠ‚ç‚¹ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:%5CUsers%5Cbeihai%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230711104500841.png" alt="image-20230711104500841"></p>
<p>**å†³ç­–æ ‘æ¨¡å‹çš„å…³é”®ï¼š**å°±æ˜¯å¦‚ä½•é€‰æ‹©åˆé€‚çš„èŠ‚ç‚¹è¿›è¡Œåˆ†è£‚ã€‚</p>
<h3 id="1ã€å†³ç­–æ ‘å›å½’å™¨æ¨¡å‹ç›¸å…³API">1ã€å†³ç­–æ ‘å›å½’å™¨æ¨¡å‹ç›¸å…³API</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sklearn.tree <span class="keyword">as</span> st</span><br><span class="line"> </span><br><span class="line"><span class="comment"># å†³ç­–æ ‘åˆ†ç±»æ¨¡å‹æ¥å£</span></span><br><span class="line"> sklearn.tree.DecisionTreeClassifier(*, criterion=<span class="string">&#x27;gini&#x27;</span>, splitter=<span class="string">&#x27;best&#x27;</span>, max_depth=<span class="literal">None</span>, min_samples_split=<span class="number">2</span>, min_samples_leaf=<span class="number">1</span>, min_weight_fraction_leaf=<span class="number">0.0</span>, max_features=<span class="literal">None</span>, random_state=<span class="literal">None</span>, max_leaf_nodes=<span class="literal">None</span>, min_impurity_decrease=<span class="number">0.0</span>, min_impurity_split=<span class="literal">None</span>, class_weight=<span class="literal">None</span>, ccp_alpha=<span class="number">0.0</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># å†³ç­–æ ‘å›å½’æ¨¡å‹æ¥å£</span></span><br><span class="line"> sklearn.tree.DecisionTreeRegressor(*, criterion=<span class="string">&#x27;mse&#x27;</span>, splitter=<span class="string">&#x27;best&#x27;</span>, max_depth=<span class="literal">None</span>, min_samples_split=<span class="number">2</span>, min_samples_leaf=<span class="number">1</span>, min_weight_fraction_leaf=<span class="number">0.0</span>, max_features=<span class="literal">None</span>, random_state=<span class="literal">None</span>, max_leaf_nodes=<span class="literal">None</span>, min_impurity_decrease=<span class="number">0.0</span>, min_impurity_split=<span class="literal">None</span>, ccp_alpha=<span class="number">0.0</span>)</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>criterion:{â€œginiâ€, â€œentropyâ€}, default=â€giniâ€</td>
<td>è¡¡é‡åˆ†ç±»çš„è´¨é‡â€œentropyâ€ä»£è¡¨ä¿¡æ¯å¢ç›Š,&quot;gini&quot;ä»£è¡¨åŸºå°¼ç³»æ•°</td>
</tr>
<tr>
<td>max_depth</td>
<td>æ ‘çš„æœ€å¤§æ·±åº¦</td>
</tr>
<tr>
<td>min_samples_split</td>
<td>ä¸€ä¸ªå†…éƒ¨èŠ‚ç‚¹éœ€è¦çš„æœ€å°‘çš„æ ·æœ¬æ•°</td>
</tr>
<tr>
<td>min_samples_leaf</td>
<td>ä¸€ä¸ªå¶èŠ‚ç‚¹æ‰€éœ€è¦çš„æœ€å°æ ·æœ¬æ•°</td>
</tr>
<tr>
<td>max_leaf_nodes</td>
<td>æœ€å¤§å¶å­èŠ‚ç‚¹çš„å€¼</td>
</tr>
<tr>
<td>class_weight</td>
<td>ç±»çš„å…³è”æƒå€¼</td>
</tr>
</tbody>
</table>
<h3 id="2ã€é¸¢å°¾èŠ±å›å½’å†³ç­–æ ‘">2ã€é¸¢å°¾èŠ±å›å½’å†³ç­–æ ‘</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets <span class="keyword">as</span> sd</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> model_selection <span class="keyword">as</span> ms</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> tree <span class="keyword">as</span> st</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> metrics <span class="keyword">as</span> sm</span><br><span class="line"></span><br><span class="line">data = sd.load_iris()</span><br><span class="line">x = data.data</span><br><span class="line">y = data.target</span><br><span class="line">train_x, test_x, train_y, test_y = ms.train_test_split(x, y, train_size=<span class="number">0.75</span>, shuffle=<span class="literal">True</span>, random_state=<span class="number">7</span>)</span><br><span class="line"><span class="comment"># é€‰æ‹©æ¨¡å‹</span></span><br><span class="line">model = st.DecisionTreeClassifier()</span><br><span class="line"><span class="comment"># è®­ç»ƒæ¨¡å‹</span></span><br><span class="line">model.fit(train_x, train_y)</span><br><span class="line"><span class="comment"># é¢„æµ‹æ¨¡å‹</span></span><br><span class="line">pred_y = model.predict(test_x)</span><br><span class="line"><span class="comment"># æ¨¡å‹è¯„ä¼°</span></span><br><span class="line">sm.f1_score(test_y, pred_y, average=<span class="string">&#x27;micro&#x27;</span>)</span><br><span class="line"><span class="comment"># ç»˜ç”»å†³ç­–æ ‘</span></span><br><span class="line">st.plot_tree(model,feature_names=[<span class="string">&#x27;sepal length&#x27;</span>, <span class="string">&#x27;sepal width&#x27;</span>, <span class="string">&#x27;petal length&#x27;</span>, <span class="string">&#x27;petal width&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç‰¹å¾çš„é‡è¦æ€§</span></span><br><span class="line">model.feature_importances_</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">array([0.01786711, 0.        , 0.0329131 , 0.94921978])</span></span><br><span class="line"><span class="string">æ‰€ä»¥æˆ‘ä»¬é€‰æ‹©dataçš„æ—¶å€™åªéœ€è¦åé¢ä¸¤åˆ—å°±ok</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:%5CUsers%5Cbeihai%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230711110745356.png" alt="image-20230711110745356"></p>
<h2 id="é›†åˆç®—æ³•">é›†åˆç®—æ³•</h2>
<blockquote>
<p>é›†åˆç®—æ³•ä¹Ÿå«é›†æˆå­¦ä¹ æ¨¡å‹ï¼Œå®ƒæ˜¯ä½¿ç”¨ä¸€ç³»åˆ—å¼±å­¦ä¹ å™¨ï¼ˆä¹Ÿç§°ä¸ºåŸºç¡€æ¨¡å‹æˆ–åŸºæ¨¡å‹ï¼‰è¿›è¡Œå­¦ä¹ ï¼Œå¹¶å°†å„ä¸ªå¼±å­¦ä¹ å™¨çš„ç»“æœè¿›è¡Œæ•´åˆï¼Œä»è€Œè·å¾—æ¯”å•ä¸ªå­¦ä¹ å™¨æ›´å¥½çš„å­¦ä¹ æ•ˆæœã€‚é›†æˆå­¦ä¹ æ¨¡å‹çš„å¸¸è§ç®—æ³•æœ‰Baggingç®—æ³•å’ŒBoostingç®—æ³•ä¸¤ç§ã€‚Baggingç®—æ³•çš„å…¸å‹æœºå™¨å­¦ä¹ æ¨¡å‹ä¸ºéšæœºæ£®æ—æ¨¡å‹ï¼Œè€ŒBoostingç®—æ³•çš„å…¸å‹æœºå™¨å­¦ä¹ æ¨¡å‹ä¸ºï¼šAdaBoostã€GBDTã€XGBoostå’ŒLightGBMæ¨¡å‹ã€‚</p>
<p>Baggingç®—æ³•</p>
<p>Baggingç®—æ³•çš„åŸç†ç±»ä¼¼æŠ•ç¥¨ï¼Œæ¯ä¸ªå¼±å­¦ä¹ å™¨éƒ½æœ‰ä¸€ç¥¨ï¼Œæœ€ç»ˆæ ¹æ®æ‰€æœ‰å¼±å­¦ä¹ å™¨çš„æŠ•ç¥¨ï¼ŒæŒ‰ç…§â€œå°‘æ•°æœä»å¤šæ•°â€çš„åŸåˆ™äº§ç”Ÿæœ€ç»ˆçš„é¢„æµ‹ç»“æœã€‚</p>
<p>å‡è®¾åŸå§‹æ•°æ®å…±æœ‰10000æ¡ï¼Œä»ä¸­éšæœºæœ‰æ”¾å›åœ°æŠ½å–10000æ¬¡æ•°æ®æ„æˆä¸€ä¸ªæ–°çš„è®­ç»ƒé›†ï¼ˆå› ä¸ºæ˜¯éšæœºæœ‰æ”¾å›æŠ½æ ·ï¼Œæ‰€ä»¥å¯èƒ½å‡ºç°æŸä¸€æ¡æ•°æ®å¤šæ¬¡è¢«æŠ½ä¸­ï¼Œä¹Ÿæœ‰å¯èƒ½æŸä¸€æ¡æ•°æ®ä¸€æ¬¡ä¹Ÿæ²¡æœ‰è¢«æŠ½ä¸­ï¼‰ï¼Œæ¯æ¬¡ä½¿ç”¨ä¸€ä¸ªè®­ç»ƒé›†è®­ç»ƒä¸€ä¸ªå¼±å­¦ä¹ å™¨ã€‚è¿™æ ·æœ‰æ”¾å›åœ°éšæœºæŠ½å–næ¬¡åï¼Œè®­ç»ƒç»“æŸæ—¶å°±èƒ½è·å¾—ç”±ä¸åŒçš„è®­ç»ƒé›†è®­ç»ƒå‡ºçš„nä¸ªå¼±å­¦ä¹ å™¨ï¼Œæ ¹æ®è¿™nä¸ªå¼±å­¦ä¹ å™¨çš„é¢„æµ‹ç»“æœï¼ŒæŒ‰ç…§â€œå°‘æ•°æœä»å¤šæ•°â€çš„åŸåˆ™ï¼Œè·å¾—ä¸€ä¸ªæ›´åŠ å‡†ç¡®ã€åˆç†çš„æœ€ç»ˆé¢„æµ‹ç»“æœã€‚å…·ä½“æ¥è¯´ï¼Œåœ¨åˆ†ç±»é—®é¢˜ä¸­æ˜¯ç”¨nä¸ªå¼±å­¦ä¹ å™¨æŠ•ç¥¨çš„æ–¹å¼è·å–æœ€ç»ˆç»“æœï¼Œåœ¨å›å½’é—®é¢˜ä¸­åˆ™æ˜¯å–nä¸ªå¼±å­¦ä¹ å™¨çš„å¹³å‡å€¼ä½œä¸ºæœ€ç»ˆç»“æœã€‚</p>
<p>Boostingç®—æ³•</p>
<p>Boostingç®—æ³•çš„æœ¬è´¨æ˜¯å°†å¼±å­¦ä¹ å™¨æå‡ä¸ºå¼ºå­¦ä¹ å™¨ï¼Œå®ƒå’ŒBaggingç®—æ³•çš„åŒºåˆ«åœ¨äºï¼šBaggingç®—æ³•å¯¹å¾…æ‰€æœ‰çš„å¼±å­¦ä¹ å™¨ä¸€è§†åŒä»ï¼›è€ŒBoostingç®—æ³•åˆ™ä¼šå¯¹å¼±å­¦ä¹ å™¨â€œåŒºåˆ«å¯¹å¾…â€ï¼Œé€šä¿—æ¥è®²å°±æ˜¯æ³¨é‡â€œåŸ¹å…»ç²¾è‹±â€å’Œâ€œé‡è§†é”™è¯¯â€ã€‚</p>
<p>â€åŸ¹å…»ç²¾è‹±â€å°±æ˜¯æ¯ä¸€è½®è®­ç»ƒåå¯¹é¢„æµ‹ç»“æœè¾ƒå‡†ç¡®çš„å¼±å­¦ä¹ å™¨ç»™äºˆè¾ƒå¤§çš„æƒé‡ï¼Œå¯¹è¡¨ç°ä¸å¥½çš„å¼±å­¦ä¹ å™¨åˆ™é™ä½å…¶æƒé‡ã€‚è¿™æ ·åœ¨æœ€ç»ˆé¢„æµ‹æ—¶ï¼Œâ€œä¼˜ç§€æ¨¡å‹â€çš„æƒé‡æ˜¯å¤§çš„ï¼Œç›¸å½“äºå®ƒå¯ä»¥æŠ•å‡ºå¤šç¥¨ï¼Œè€Œâ€œä¸€èˆ¬æ¨¡å‹â€åªèƒ½æŠ•å‡ºä¸€ç¥¨æˆ–ä¸èƒ½æŠ•ç¥¨ã€‚</p>
<p>â€œé‡è§†é”™è¯¯â€å°±æ˜¯åœ¨æ¯ä¸€è½®è®­ç»ƒåæ”¹å˜è®­ç»ƒé›†çš„æƒå€¼æˆ–æ¦‚ç‡åˆ†å¸ƒï¼Œé€šè¿‡æé«˜åœ¨å‰ä¸€è½®è¢«å¼±å­¦ä¹ å™¨é¢„æµ‹é”™è¯¯çš„æ ·ä¾‹çš„æƒå€¼ï¼Œé™ä½å‰ä¸€è½®è¢«å¼±å­¦ä¹ å™¨é¢„æµ‹æ­£ç¡®çš„æ ·ä¾‹çš„æƒå€¼ï¼Œæ¥æé«˜å¼±å­¦ä¹ å™¨å¯¹é¢„æµ‹é”™è¯¯çš„æ•°æ®çš„é‡è§†ç¨‹åº¦ï¼Œä»è€Œæå‡æ¨¡å‹çš„æ•´ä½“é¢„æµ‹æ•ˆæœã€‚</p>
</blockquote>
<h3 id="1ã€éšæœºæ£®æ—">1ã€éšæœºæ£®æ—</h3>
<p>â€‹				éšæœºæ£®æ—ï¼ˆRandom Forestï¼‰æ˜¯ä¸€ç§ç»å…¸çš„Baggingæ¨¡å‹ï¼Œå…¶å¼±å­¦ä¹ å™¨ä¸ºå†³ç­–æ ‘æ¨¡å‹ã€‚éšæœºæ£®æ—æ¨¡å‹ä¼šåœ¨åŸå§‹æ•°æ®é›†ä¸­éšæœºæŠ½æ ·ï¼Œæ„æˆnä¸ªä¸åŒçš„æ ·æœ¬æ•°æ®é›†ï¼Œç„¶åæ ¹æ®è¿™äº›æ•°æ®é›†æ­å»ºnä¸ªä¸åŒçš„å†³ç­–æ ‘æ¨¡å‹ï¼Œæœ€åæ ¹æ®è¿™äº›å†³ç­–æ ‘æ¨¡å‹çš„å¹³å‡å€¼ï¼ˆé’ˆå¯¹å›å½’æ¨¡å‹ï¼‰æˆ–è€…æŠ•ç¥¨æƒ…å†µï¼ˆé’ˆå¯¹åˆ†ç±»æ¨¡å‹ï¼‰æ¥è·å–æœ€ç»ˆç»“æœã€‚ä¸ºäº†ä¿è¯æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼ˆæˆ–è€…è¯´é€šç”¨èƒ½åŠ›ï¼‰ï¼Œéšæœºæ£®æ—æ¨¡å‹åœ¨å»ºç«‹æ¯æ£µæ ‘æ—¶ï¼Œå¾€å¾€ä¼šéµå¾ª<strong>æ•°æ®éšæœº</strong>å’Œ<strong>ç‰¹å¾éšæœº</strong>è¿™ä¸¤ä¸ªåŸºæœ¬åŸåˆ™ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#éšæœºæ£®æ—ç›¸å…³APIï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sklearn.ensemble <span class="keyword">as</span> se</span><br><span class="line"></span><br><span class="line"><span class="comment"># éšæœºæ£®æ—å›å½’æ¨¡å‹	ï¼ˆå±äºé›†åˆç®—æ³•çš„ä¸€ç§ï¼‰</span></span><br><span class="line"><span class="comment"># max_depthï¼šå†³ç­–æ ‘æœ€å¤§æ·±åº¦10</span></span><br><span class="line"><span class="comment"># n_estimatorsï¼šæ„å»º1000æ£µå†³ç­–æ ‘ï¼Œè®­ç»ƒæ¨¡å‹</span></span><br><span class="line"><span class="comment"># min_samples_split: å­è¡¨ä¸­æœ€å°æ ·æœ¬æ•° è‹¥å°äºè¿™ä¸ªæ•°å­—ï¼Œåˆ™ä¸å†ç»§ç»­å‘ä¸‹æ‹†åˆ†</span></span><br><span class="line">model = se.RandomForestRegressor(max_depth=<span class="number">10</span>, n_estimators=<span class="number">1000</span>,min_samples_split=<span class="number">2</span>,random_state=<span class="number">7</span>)</span><br><span class="line">model.fit(X,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># éšé›†æ£®æ—åˆ†ç±»æ¨¡å‹</span></span><br><span class="line">model=RandomForestClassifier(max_depth=<span class="number">10</span>, n_estimators=<span class="number">1000</span>,min_samples_split=<span class="number">2</span>,random_state=<span class="number">7</span>)</span><br><span class="line">model.fit(X,y)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>==<strong>æ¡ˆä¾‹</strong>==</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets <span class="keyword">as</span> sd</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> model_selection <span class="keyword">as</span> ms</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> ensemble <span class="keyword">as</span> se</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> metrics <span class="keyword">as</span> sm</span><br><span class="line"></span><br><span class="line">data = sd.load_iris()</span><br><span class="line">x = data.data</span><br><span class="line">y = data.target</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ’åˆ†æ•°æ®é›†</span></span><br><span class="line">train_x, test_x, train_y, test_y = ms.train_test_split(x, y, train_size=<span class="number">0.75</span>, shuffle=<span class="literal">True</span>, random_state=<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é€‰æ‹©æ¨¡å‹</span></span><br><span class="line">model = se.RandomForestClassifier()</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®­ç»ƒæ¨¡å‹</span></span><br><span class="line">model.fit(train_x, train_y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æƒé‡</span></span><br><span class="line">model.feature_importances_</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">array([0.06178603, 0.0128437 , 0.47481514, 0.45055513])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„æµ‹æ¨¡å‹</span></span><br><span class="line">pred_y = model.predict(test_x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¨€ç–çŸ©é˜µ</span></span><br><span class="line">sm.confusion_matrix(test_y, pred_y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è¯„ä¼°</span></span><br><span class="line">sm.f1_score(test_y, pred_y, average=<span class="string">&#x27;micro&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0.8947368421052632</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(sm.classification_report(test_y, pred_y))</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">              precision    recall  f1-score   support</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">           0       1.00      1.00      1.00        11</span></span><br><span class="line"><span class="string">           1       0.86      0.86      0.86        14</span></span><br><span class="line"><span class="string">           2       0.85      0.85      0.85        13</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    accuracy                           0.89        38</span></span><br><span class="line"><span class="string">   macro avg       0.90      0.90      0.90        38</span></span><br><span class="line"><span class="string">weighted avg       0.89      0.89      0.89        38</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="2ã€AdaBoost">2ã€AdaBoost</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets <span class="keyword">as</span> sd</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> model_selection <span class="keyword">as</span> ms</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> linear_model <span class="keyword">as</span> lm</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> ensemble <span class="keyword">as</span> se</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> metrics <span class="keyword">as</span> sm</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ•°æ®</span></span><br><span class="line">data = sd.load_iris()</span><br><span class="line"></span><br><span class="line">x = data.data</span><br><span class="line">y = data.target</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ’åˆ†æ•°æ®é›†</span></span><br><span class="line">train_x, test_x, train_y, test_y = ms.train_test_split(x, y, train_size=<span class="number">0.8</span>, shuffle=<span class="literal">True</span>, random_state=<span class="number">21</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é€‰æ‹©æ¨¡å‹</span></span><br><span class="line">sgd = lm.SGDClassifier()</span><br><span class="line">model = se.AdaBoostClassifier(estimator=sgd, algorithm=<span class="string">&#x27;SAMME&#x27;</span>, n_estimators=<span class="number">50</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è®­ç»ƒ</span></span><br><span class="line">model.fit(train_x, train_y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹é¢„æµ‹</span></span><br><span class="line">pred_y = model.predict(test_x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è¯„ä¼°</span></span><br><span class="line"><span class="built_in">print</span>(sm.classification_report(test_y, pred_y))</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">			  precision    recall  f1-score   support</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">           0       1.00      1.00      1.00        11</span></span><br><span class="line"><span class="string">           1       1.00      0.71      0.83        14</span></span><br><span class="line"><span class="string">           2       0.76      1.00      0.87        13</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    accuracy                           0.89        38</span></span><br><span class="line"><span class="string">   macro avg       0.92      0.90      0.90        38</span></span><br><span class="line"><span class="string">weighted avg       0.92      0.89      0.89        38</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="æœ´ç´ è´å¶æ–¯">æœ´ç´ è´å¶æ–¯</h2>
<blockquote>
<p>è´å¶æ–¯åˆ†ç±»æ˜¯æœºå™¨å­¦ä¹ ä¸­åº”ç”¨æä¸ºå¹¿æ³›çš„åˆ†ç±»ç®—æ³•ä¹‹ä¸€ï¼Œå…¶äº§ç”Ÿè‡ªè‹±å›½æ•°å­¦å®¶è´å¶æ–¯å¯¹äºé€†æ¦‚é—®é¢˜çš„æ€è€ƒã€‚æœ´ç´ è´å¶æ–¯æ˜¯è´å¶æ–¯æ¨¡å‹å½“ä¸­æœ€ç®€å•çš„ä¸€ç§ã€‚</p>
<p><strong>è´å¶æ–¯å…¬å¼</strong> **: **<br>
$$<br>
P(A|B) = P(B|A)P(A) / P(B)<br>
$$<br>
å…¶ä¸­Pï¼ˆAï¼‰ä¸ºäº‹ä»¶Aå‘ç”Ÿçš„æ¦‚ç‡ï¼ŒPï¼ˆBï¼‰ä¸ºäº‹ä»¶Bå‘ç”Ÿçš„æ¦‚ç‡ï¼ŒPï¼ˆA|Bï¼‰è¡¨ç¤ºåœ¨äº‹ä»¶Bå‘ç”Ÿçš„æ¡ä»¶ä¸‹äº‹ä»¶Aå‘ç”Ÿçš„æ¦‚ç‡ï¼ŒåŒç†Pï¼ˆB|Aï¼‰åˆ™è¡¨ç¤ºåœ¨äº‹ä»¶Aå‘ç”Ÿçš„æ¡ä»¶ä¸‹äº‹ä»¶Bå‘ç”Ÿçš„æ¦‚ç‡ã€‚</p>
<p><strong>æœ´ç´ è´å¶æ–¯åˆ†ç±»æ˜¯è´å¶æ–¯åˆ†ç±»ä¸­æœ€ç®€å•ï¼Œä¹Ÿæ˜¯å¸¸è§çš„ä¸€ç§åˆ†ç±»æ–¹æ³•</strong>ã€‚<br>
$$<br>
P( Y|X1,X2,â€¦,Xn ) = p( X1,X2,â€¦Xn|Y) P(Y) / P(X1,X2,â€¦Xn)<br>
$$<br>
æœ´ç´ è´å¶æ–¯æ¨¡å‹å‡è®¾ç»™å®šç›®æ ‡å€¼åå„ä¸ªç‰¹å¾ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œåˆ†å­çš„è®¡ç®—å…¬å¼å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼:<br>
$$<br>
P( X1,X2,â€¦Xn|Y)P(Y) = P(X1|Y)P(X2|Y)P(X3|Y)â€¦P(Xn|Y)P(Y)<br>
$$<br>
ã€‚å…¶ä¸­<code>Pï¼ˆX1|Yï¼‰ã€Pï¼ˆX2|Yï¼‰ã€Pï¼ˆYï¼‰</code>ç­‰æ•°æ®éƒ½æ˜¯å·²çŸ¥çš„ï¼Œç”±æ­¤å¯ä»¥è®¡ç®—åœ¨nä¸ªç‰¹å¾å˜é‡å–ä¸åŒçš„å€¼çš„æ¡ä»¶ä¸‹ï¼Œç›®æ ‡å˜é‡å–æŸä¸ªå€¼çš„æ¦‚ç‡ï¼Œå¹¶ä¸”é€‰æ‹©æ¦‚ç‡æ›´é«˜è€…å¯¹æ ·æœ¬è¿›è¡Œåˆ†ç±»ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æœ´ç´ è´å¶æ–¯æ¨¡å‹ç›¸å…³API:</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sklearn.naive_bayes <span class="keyword">as</span> nb</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºé«˜æ–¯åˆ†å¸ƒæœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨,å®ƒé€‚ç”¨äºä»»ä½•è¿ç»­æ•°å€¼å‹çš„æ•°æ®é›†ã€‚</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets <span class="keyword">as</span> sd</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> feature_extraction <span class="keyword">as</span> fe</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> naive_bayes <span class="keyword">as</span> nb</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> model_selection <span class="keyword">as</span> ms</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> metrics <span class="keyword">as</span> sm</span><br><span class="line"></span><br><span class="line">data = sd.fetch_20newsgroups()</span><br><span class="line">x = data.data</span><br><span class="line">y = data.target</span><br><span class="line"></span><br><span class="line">train_x, test_x, train_y, test_y = ms.train_test_split(x, y, train_size=<span class="number">0.75</span>, random_state=<span class="number">6</span>, shuffle=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">transfer = fe.text.TfidfVectorizer()</span><br><span class="line">train_x = transfer.fit_transform(train_x)</span><br><span class="line">test_x = transfer.transform(test_x)</span><br><span class="line"></span><br><span class="line">model = nb.MultinomialNB()</span><br><span class="line">model.fit(train_x, train_y)</span><br><span class="line">pred_y = model.predict(test_x)</span><br><span class="line"></span><br><span class="line">sm.f1_score(test_y, pred_y, average=<span class="string">&#x27;micro&#x27;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">0.8462354188759279</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="æ”¯æŒå‘é‡æœº-SVM">æ”¯æŒå‘é‡æœº(SVM)</h2>
<p><strong>æ”¯æŒå‘é‡æœº</strong>(<strong>SVM</strong>)æ˜¯ä¸€ç»„ç”¨äºåˆ†ç±»ã€å›å½’å’Œå¼‚å¸¸å€¼æ£€æµ‹çš„ç›‘ç£å­¦ä¹ æ–¹æ³•ã€‚</p>
<p>æ”¯æŒå‘é‡æœºçš„ä¼˜ç‚¹æ˜¯ï¼š</p>
<ul>
<li>
<p>åœ¨é«˜ç»´ç©ºé—´ä¸­æœ‰æ•ˆã€‚</p>
</li>
<li>
<p>åœ¨ç»´æ•°å¤§äºæ ·æœ¬æ•°çš„æƒ…å†µä¸‹ä»ç„¶æœ‰æ•ˆã€‚</p>
</li>
<li>
<p>åœ¨å†³ç­–å‡½æ•°ä¸­ä½¿ç”¨è®­ç»ƒç‚¹çš„å­é›†ï¼ˆç§°ä¸ºæ”¯æŒå‘é‡ï¼‰ï¼Œå› æ­¤å®ƒä¹Ÿæ˜¯å†…å­˜é«˜æ•ˆçš„ã€‚</p>
</li>
<li>
<p>é€šç”¨æ€§ï¼šå¯ä»¥ä¸ºå†³ç­–å‡½æ•°æŒ‡å®šä¸åŒçš„å†…æ ¸å‡½æ•°ã€‚æä¾›äº†é€šç”¨å†…æ ¸ï¼Œä½†ä¹Ÿå¯ä»¥æŒ‡å®šè‡ªå®šä¹‰å†…æ ¸ã€‚</p>
</li>
</ul>
<p>æ”¯æŒå‘é‡æœºçš„ç¼ºç‚¹åŒ…æ‹¬ï¼š</p>
<ul>
<li>
<p>â€‹     å¦‚æœç‰¹å¾æ•°é‡è¿œå¤§äºæ ·æœ¬æ•°é‡ï¼Œåœ¨é€‰æ‹©æ ¸å‡½æ•°æ—¶é¿å…è¿‡åº¦æ‹Ÿåˆï¼Œæ­£åˆ™åŒ–é¡¹è‡³å…³é‡è¦ã€‚</p>
</li>
<li>
<p>â€‹      SVMä¸ç›´æ¥æä¾›æ¦‚ç‡ä¼°è®¡ï¼Œè¿™äº›æ˜¯ä½¿ç”¨æ˜‚è´µçš„äº”æŠ˜äº¤å‰éªŒè¯è®¡ç®—çš„ã€‚</p>
</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:%5CUsers%5Cbeihai%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230711150419453.png" alt="image-20230711150419453"></p>
<h3 id="åˆ†ç±»ï¼ˆSVCï¼‰">åˆ†ç±»ï¼ˆSVCï¼‰</h3>
<p>SVCï¼ŒNuSVCã€LinearSVCæ˜¯èƒ½å¤Ÿå¯¹æ•°æ®é›†æ‰§è¡ŒäºŒè¿›åˆ¶å’Œå¤šç±»åˆ†ç±»çš„ç±»ã€‚</p>
<p>SVCå’ŒNuSVCæ˜¯ç±»ä¼¼çš„æ–¹æ³•ï¼Œä½†æ¥å—çš„å‚æ•°é›†ç•¥æœ‰ä¸åŒï¼Œå¹¶å…·æœ‰ä¸åŒçš„æ•°å­¦å…¬å¼ã€‚å¦ä¸€æ–¹é¢ï¼ŒLinearSVCå¯¹äºçº¿æ€§æ ¸çš„æƒ…å†µï¼Œæ˜¯æ”¯æŒå‘é‡åˆ†ç±»çš„å¦ä¸€ç§ï¼ˆæ›´å¿«ï¼‰å®ç°ã€‚è¯·æ³¨æ„ï¼Œ LinearSVCä¸æ¥å—å‚æ•°kernelï¼Œå› ä¸ºå®ƒè¢«å‡å®šä¸ºçº¿æ€§çš„ã€‚</p>
<p>ä½œä¸ºå…¶ä»–åˆ†ç±»å™¨ï¼ŒSVCã€NuSVCå’Œ LinearSVCå°†ä¸¤ä¸ªæ•°ç»„ä½œä¸ºè¾“å…¥ï¼šä¸€ä¸ªåŒ…å«è®­ç»ƒæ ·æœ¬Xçš„å½¢çŠ¶æ•°ç»„ï¼Œä»¥åŠä¸€ä¸ªå½¢çŠ¶ç±»æ ‡ç­¾ï¼ˆå­—ç¬¦ä¸²æˆ–æ•´æ•°ï¼‰æ•°ç»„ï¼š(n_samples, n_features) y(n_samples)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sklearn.svm.LinearSVC(penalty=<span class="string">&#x27;l2&#x27;</span>, loss=<span class="string">&#x27;squared_hinge&#x27;</span>, *, dual=<span class="literal">True</span>, tol=<span class="number">0.0001</span>, C=<span class="number">1.0</span>, multi_class=<span class="string">&#x27;ovr&#x27;</span>, fit_intercept=<span class="literal">True</span>, intercept_scaling=<span class="number">1</span>, class_weight=<span class="literal">None</span>, verbose=<span class="number">0</span>, random_state=<span class="literal">None</span>, max_iter=<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">sklearn.svm.NuSVC(*, nu=<span class="number">0.5</span>, kernel=<span class="string">&#x27;rbf&#x27;</span>, degree=<span class="number">3</span>, gamma=<span class="string">&#x27;scale&#x27;</span>, coef0=<span class="number">0.0</span>, shrinking=<span class="literal">True</span>, probability=<span class="literal">False</span>, tol=<span class="number">0.001</span>, cache_size=<span class="number">200</span>, class_weight=<span class="literal">None</span>, verbose=<span class="literal">False</span>, max_iter=-<span class="number">1</span>, decision_function_shape=<span class="string">&#x27;ovr&#x27;</span>, break_ties=<span class="literal">False</span>, random_state=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">sklearn.svm.SVC(*, C=<span class="number">1.0</span>, kernel=<span class="string">&#x27;rbf&#x27;</span>, degree=<span class="number">3</span>, gamma=<span class="string">&#x27;scale&#x27;</span>, coef0=<span class="number">0.0</span>, shrinking=<span class="literal">True</span>, probability=<span class="literal">False</span>, tol=<span class="number">0.001</span>, cache_size=<span class="number">200</span>, class_weight=<span class="literal">None</span>, verbose=<span class="literal">False</span>, max_iter=-<span class="number">1</span>, decision_function_shape=<span class="string">&#x27;ovr&#x27;</span>, break_ties=<span class="literal">False</span>, random_state=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<h3 id="å›å½’ï¼ˆSVRï¼‰">å›å½’ï¼ˆSVRï¼‰</h3>
<p>æ”¯æŒå‘é‡åˆ†ç±»çš„æ–¹æ³•å¯ä»¥æ‰©å±•åˆ°è§£å†³å›å½’é—®é¢˜ã€‚è¿™ç§æ–¹æ³•ç§°ä¸ºæ”¯æŒå‘é‡å›å½’ã€‚</p>
<p>SVMç®—æ³•éå¸¸å…¨é¢ï¼Œå®ƒä¸ä»…æ”¯æŒçº¿æ€§å’Œéçº¿æ€§åˆ†ç±»ï¼Œè€Œä¸”è¿˜æ”¯æŒçº¿æ€§å’Œéçº¿æ€§å›å½’ã€‚SVMå›å½’è¦åšçš„å°±æ˜¯è®©å°½å¯èƒ½å¤šçš„å®ä¾‹ä½äºè¡—é“ä¸Šï¼ŒåŒæ—¶é™åˆ¶é—´éš”è¿ä¾‹ï¼ˆä¹Ÿå°±æ˜¯ä¸åœ¨è¡—é“ä¸Šçš„å®ä¾‹ï¼‰ã€‚è¡—é“çš„å®½åº¦ç”±è¶…å‚æ•°Îµæ§åˆ¶ï¼ŒÎµå€¼è¶Šå¤§ï¼Œé—´éš”è¶Šå¤§ï¼›Îµå€¼è¶Šå°ï¼Œé—´éš”è¶Šå°ã€‚åœ¨é—´éš”å†…æ·»åŠ æ›´å¤šçš„å®ä¾‹ä¸ä¼šå½±å“æ¨¡å‹çš„é¢„æµ‹ï¼Œæ‰€ä»¥è¿™ä¸ªæ¨¡å‹è¢«ç§°ä¸ºÎµä¸æ•æ„Ÿã€‚</p>
<p>æ”¯æŒå‘é‡åˆ†ç±»ç”Ÿæˆçš„æ¨¡å‹ï¼ˆå¦‚ä¸Šæ‰€è¿°ï¼‰ä»…ä¾èµ–äºè®­ç»ƒæ•°æ®çš„ä¸€ä¸ªå­é›†ï¼Œå› ä¸ºæ„å»ºæ¨¡å‹çš„æˆæœ¬å‡½æ•°ä¸å…³å¿ƒè¶…å‡ºè¾¹ç•Œçš„è®­ç»ƒç‚¹ã€‚ç±»ä¼¼åœ°ï¼Œæ”¯æŒå‘é‡å›å½’ç”Ÿæˆçš„æ¨¡å‹ä»…ä¾èµ–äºè®­ç»ƒæ•°æ®çš„ä¸€ä¸ªå­é›†ï¼Œå› ä¸ºæˆæœ¬å‡½æ•°å¿½ç•¥äº†é¢„æµ‹æ¥è¿‘å…¶ç›®æ ‡çš„æ ·æœ¬ã€‚</p>
<p>æ”¯æŒå‘é‡å›å½’æœ‰ 3 ç§ä¸åŒçš„å®ç°ï¼š<code> SVRã€NuSVRå’ŒLinearSVR</code>ã€‚</p>
<p><code>LinearSVR</code>æä¾›æ¯”<code>SVR</code>(ä»…è€ƒè™‘çº¿æ€§å†…æ ¸)æ›´å¿«çš„å®ç°ï¼ŒåŒæ—¶<code>NuSVR</code>å®ç°ä¸<code>SVR</code>ç•¥æœ‰ä¸åŒçš„å…¬å¼ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># API</span></span><br><span class="line"></span><br><span class="line">sklearn.svm.LinearSVR(*, epsilon=<span class="number">0.0</span>, tol=<span class="number">0.0001</span>, C=<span class="number">1.0</span>, loss=<span class="string">&#x27;epsilon_insensitive&#x27;</span>, fit_intercept=<span class="literal">True</span>, intercept_scaling=<span class="number">1.0</span>, dual=<span class="literal">True</span>, verbose=<span class="number">0</span>, random_state=<span class="literal">None</span>, max_iter=<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">sklearn.svm.NuSVR(*, nu=<span class="number">0.5</span>, C=<span class="number">1.0</span>, kernel=<span class="string">&#x27;rbf&#x27;</span>, degree=<span class="number">3</span>, gamma=<span class="string">&#x27;scale&#x27;</span>, coef0=<span class="number">0.0</span>, shrinking=<span class="literal">True</span>, tol=<span class="number">0.001</span>, cache_size=<span class="number">200</span>, verbose=<span class="literal">False</span>, max_iter=- <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">sklearn.svm.NuSVR(*, nu=<span class="number">0.5</span>, C=<span class="number">1.0</span>, kernel=<span class="string">&#x27;rbf&#x27;</span>, degree=<span class="number">3</span>, gamma=<span class="string">&#x27;scale&#x27;</span>, coef0=<span class="number">0.0</span>, shrinking=<span class="literal">True</span>, tol=<span class="number">0.001</span>, cache_size=<span class="number">200</span>, verbose=<span class="literal">False</span>, max_iter=- <span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h3 id="æ¡ˆä¾‹">æ¡ˆä¾‹</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets <span class="keyword">as</span> sd</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> model_selection <span class="keyword">as</span> ms</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> svm</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> metrics <span class="keyword">as</span> sm</span><br><span class="line"></span><br><span class="line">data = sd.load_iris()</span><br><span class="line">x = data.data</span><br><span class="line">y = data.target</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ’åˆ†æ•°æ®é›†</span></span><br><span class="line">train_x, test_x, train_y, test_y = ms.train_test_split(x, y, train_size=<span class="number">0.75</span>, shuffle=<span class="literal">True</span>, random_state=<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é€‰æ‹©åˆ†ç±»æ¨¡å‹</span></span><br><span class="line">model = svm.SVC()</span><br><span class="line"><span class="comment"># è®­ç»ƒåˆ†ç±»æ¨¡å‹</span></span><br><span class="line">model.fit(train_x, train_y)</span><br><span class="line"><span class="comment"># é¢„æµ‹åˆ†ç±»æ¨¡å‹</span></span><br><span class="line">pred_y = model.predict(test_x)</span><br><span class="line"><span class="comment"># åˆ†ç¦»æ¨¡å‹è¯„ä¼°</span></span><br><span class="line"><span class="built_in">print</span>(sm.classification_report(test_y, pred_y))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*****************************************&quot;</span>)</span><br><span class="line">sm.f1_score(test_y, pred_y, average=<span class="literal">None</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">              precision    recall  f1-score   support</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">           0       1.00      1.00      1.00        11</span></span><br><span class="line"><span class="string">           1       0.76      0.93      0.84        14</span></span><br><span class="line"><span class="string">           2       0.90      0.69      0.78        13</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    accuracy                           0.87        38</span></span><br><span class="line"><span class="string">   macro avg       0.89      0.87      0.87        38</span></span><br><span class="line"><span class="string">weighted avg       0.88      0.87      0.87        38</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">*****************************************</span></span><br><span class="line"><span class="string">array([1.        , 0.83870968, 0.7826087 ])</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å›å½’æ¨¡å‹æ„å»º</span></span><br><span class="line">model2 = svm.SVR()</span><br><span class="line"><span class="comment"># è®­ç»ƒå›å½’æ¨¡å‹</span></span><br><span class="line">model2.fit(train_x, train_y)</span><br><span class="line">sm.r2_score(test_y, pred_y)</span><br></pre></td></tr></table></figure>
<h2 id="ROCæ›²çº¿ä¸AUCæŒ‡æ ‡">ROCæ›²çº¿ä¸AUCæŒ‡æ ‡</h2>
<ul>
<li>
<p>AUCåªèƒ½ç”¨æ¥è¯„ä»·äºŒåˆ†ç±»</p>
</li>
<li>
<p>AUCéå¸¸é€‚åˆè¯„ä»·æ ·æœ¬ä¸å¹³è¡¡ä¸­çš„åˆ†ç±»å™¨æ€§èƒ½</p>
</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> roc_auc_score</span><br></pre></td></tr></table></figure>
<h2 id="æ¨¡å‹ä¿å­˜å’ŒåŠ è½½">æ¨¡å‹ä¿å­˜å’ŒåŠ è½½</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> joblib</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿å­˜æ¨¡å‹</span></span><br><span class="line">joblib.dump(model, <span class="string">&quot;titanic.pkl&quot;</span>)</span><br><span class="line"><span class="comment"># åŠ è½½æ¨¡å‹</span></span><br><span class="line">model2 = joblib.load(<span class="string">&quot;titanic.pkl&quot;</span>)</span><br><span class="line">model2.predict(test_x)</span><br></pre></td></tr></table></figure>
<h2 id="æ— ç›‘ç£å­¦ä¹ ">æ— ç›‘ç£å­¦ä¹ </h2>
<h3 id="K-meansèšç±»">K-meansèšç±»</h3>
<p>å°±æ˜¯è®¾ç½®Kå€¼ï¼Œåœ¨ç‰¹å¾ç©ºé—´ä¸­éšæœºæ‰¾Kä¸ªç‰¹å¾ä½œä¸ºèšç±»ä¸­å¿ƒï¼Œç„¶åå»æ‰¾å’Œä¸­å¿ƒç‚¹æœ€è¿‘çš„å¹¶æ ‡ä¸ºåŒä¸€ç±»ï¼Œå…¨éƒ¨æ ‡ä¸ºåŒä¸€é¢œè‰²åé‡æ–°å¯»æ‰¾è¿™äº›èšç±»åçš„Kä¸ªä¸­å¿ƒç‚¹ï¼Œç„¶åé‡å¤ï¼Œå½“æœ€åèšç±»çš„ç‚¹å’Œåˆå§‹ç‚¹ä¸€æ ·æ—¶å€™å°±åœæ­¢</p>
<p>API</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sklearn.cluster.KMeans(n_clusters=<span class="number">8</span>,init=<span class="string">&#x27;k-means++&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="è¯„ä¼°">è¯„ä¼°</h3>
<p>å¤–éƒ¨è·ç¦»æœ€å¤§åŒ–ï¼Œå†…éƒ¨è·ç¦»æœ€å°åŒ–</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è½®å»“ç³»æ•°</span></span><br><span class="line">sklearn.metrics.slihouette_score(ç‰¹å¾, é¢„æµ‹å€¼)</span><br></pre></td></tr></table></figure>
<h2 id="ä¿¡ç”¨å¡è¯ˆéª—æ£€æµ‹">ä¿¡ç”¨å¡è¯ˆéª—æ£€æµ‹</h2>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:%5CUsers%5Cbeihai%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230714155343300.png" alt="image-20230714155343300"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> model_selection <span class="keyword">as</span> ms</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> metrics <span class="keyword">as</span> sm</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> svm</span><br><span class="line"></span><br><span class="line">data = pd.read_csv(<span class="string">f&quot;C:\\Users\\beihai\\workpace\\é‡‘ç –\\æ¨¡å—C\\æ•°æ®\\creditcard.csv&quot;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="comment"># è·å–ç›®æ ‡å€¼å’Œç‰¹å¾å€¼</span></span><br><span class="line">x = data.iloc[:,<span class="number">1</span>:<span class="number">30</span>]</span><br><span class="line">y = data.iloc[:,-<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†</span></span><br><span class="line">train_x, test_x, train_y, test_y = ms.train_test_split(x, y, train_size=<span class="number">0.8</span>, shuffle=<span class="literal">True</span>, random_state=<span class="number">21</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">print(train_x.shape)</span></span><br><span class="line"><span class="string">print(test_x.shape)</span></span><br><span class="line"><span class="string">(227845, 29)</span></span><br><span class="line"><span class="string">(56962, 29)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€‰æ‹©æ¨¡å‹</span></span><br><span class="line">model = svm.SVC()</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®­ç»ƒæ¨¡å‹</span></span><br><span class="line">model.fit(train_x, train_y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ¨¡å‹</span></span><br><span class="line">model.feature_names_in_</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">array([&#x27;V1&#x27;, &#x27;V2&#x27;, &#x27;V3&#x27;, &#x27;V4&#x27;, &#x27;V5&#x27;, &#x27;V6&#x27;, &#x27;V7&#x27;, &#x27;V8&#x27;, &#x27;V9&#x27;, &#x27;V10&#x27;, &#x27;V11&#x27;,</span></span><br><span class="line"><span class="string">       &#x27;V12&#x27;, &#x27;V13&#x27;, &#x27;V14&#x27;, &#x27;V15&#x27;, &#x27;V16&#x27;, &#x27;V17&#x27;, &#x27;V18&#x27;, &#x27;V19&#x27;, &#x27;V20&#x27;,</span></span><br><span class="line"><span class="string">       &#x27;V21&#x27;, &#x27;V22&#x27;, &#x27;V23&#x27;, &#x27;V24&#x27;, &#x27;V25&#x27;, &#x27;V26&#x27;, &#x27;V27&#x27;, &#x27;V28&#x27;, &#x27;Amount&#x27;],</span></span><br><span class="line"><span class="string">      dtype=object)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„æµ‹æ¨¡å‹</span></span><br><span class="line">pred_y = model.predict(test_x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è¯„ä¼°</span></span><br><span class="line"><span class="built_in">print</span>(sm.classification_report(test_y, pred_y))</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">              precision    recall  f1-score   support</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">           0       1.00      1.00      1.00     56853</span></span><br><span class="line"><span class="string">           1       0.91      0.29      0.44       109</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    accuracy                           1.00     56962</span></span><br><span class="line"><span class="string">   macro avg       0.96      0.65      0.72     56962</span></span><br><span class="line"><span class="string">weighted avg       1.00      1.00      1.00     56962</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># f1_scoreè¯„åˆ†</span></span><br><span class="line">sm.f1_score(test_y, pred_y)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0.4444444444444445</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">%matplotlib inline</span><br><span class="line"></span><br><span class="line">data = pd.read_csv(<span class="string">f&quot;C:\\Users\\beihai\\workpace\\é‡‘ç –\\æ¨¡å—C\\æ•°æ®\\creditcard.csv&quot;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">count_classes = pd.value_counts(data[<span class="string">&#x27;Class&#x27;</span>], sort = <span class="literal">True</span>).sort_index()</span><br><span class="line"><span class="built_in">print</span>(count_classes)</span><br><span class="line">count_classes.plot(kind=<span class="string">&#x27;bar&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&quot;Fraud class histograam&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Class&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Frequency&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="comment"># æ•°æ®å¤„ç†</span></span><br><span class="line">data[<span class="string">&#x27;normAmount&#x27;</span>] = StandardScaler().fit_transform(data[<span class="string">&#x27;Amount&#x27;</span>].to_numpy().reshape(-<span class="number">1</span>,<span class="number">1</span>))</span><br><span class="line">data = data.drop([<span class="string">&#x27;Time&#x27;</span>, <span class="string">&#x27;Amount&#x27;</span>], axis = <span class="number">1</span>)</span><br><span class="line">data.head()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸‹é‡‡æ ·ï¼šä½¿å¾—0 å’Œ 1 æ‰€å æ•°æ®ä¸€æ ·å¤š</span></span><br><span class="line">x = data.loc[:, data.columns != <span class="string">&#x27;Class&#x27;</span>]</span><br><span class="line">y = data.loc[:, data.columns == <span class="string">&#x27;Class&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(x.shape)</span><br><span class="line"><span class="built_in">print</span>(y.shape)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">(284807, 29)</span></span><br><span class="line"><span class="string">(284807, 1)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">number_recored_fraud = <span class="built_in">len</span>(data[data.Class == <span class="number">1</span>])</span><br><span class="line">fraud_indicies = np.array(data[data.Class == <span class="number">1</span>].index)</span><br><span class="line"><span class="built_in">print</span>(number_recored_fraud)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(fraud_indicies))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">492</span></span><br><span class="line"><span class="string">492</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">normal_indices = data[data.Class == <span class="number">0</span>].index</span><br><span class="line">random_normal_indices = np.random.choice(normal_indices, number_recored_fraud, replace=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(random_normal_indices)</span><br><span class="line">random_normal_indices = np.array(random_normal_indices)</span><br><span class="line"><span class="built_in">print</span>(random_normal_indices)</span><br><span class="line"></span><br><span class="line">under_sample_indices = np.concatenate([fraud_indicies, random_normal_indices])</span><br><span class="line">under_sample_data = data.iloc[under_sample_indices,:]</span><br><span class="line">x_undersample = under_sample_data.iloc[:,under_sample_data.columns != <span class="string">&#x27;Class&#x27;</span>]</span><br><span class="line">y_undersample = under_sample_data.iloc[:,under_sample_data.columns == <span class="string">&#x27;Class&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(x_undersample),<span class="built_in">len</span>(y_undersample)) </span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">984 984</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€‰æ‹©æ¨¡å‹</span></span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> svm</span><br><span class="line">model = svm.SVC()</span><br><span class="line">model</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®­ç»ƒæ¨¡å‹</span></span><br><span class="line">model.fit(train_x, train_y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„æµ‹æ¨¡å‹</span></span><br><span class="line">pred_y = model.predict(test_x)</span><br><span class="line">pred_y</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è¯„ä¼°</span></span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> metrics <span class="keyword">as</span> sm</span><br><span class="line">sm.f1_score(test_y, pred_y)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0.9236363636363637</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(sm.classification_report(test_y, pred_y))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">              precision    recall  f1-score   support</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">           0       0.88      0.99      0.93       149</span></span><br><span class="line"><span class="string">           1       0.99      0.86      0.92       147</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    accuracy                           0.93       296</span></span><br><span class="line"><span class="string">   macro avg       0.94      0.93      0.93       296</span></span><br><span class="line"><span class="string">weighted avg       0.94      0.93      0.93       296</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>é‡‘ç –å›½å®¶æœºå™¨å­¦ä¹ æ¯”èµ›</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://www.beihai.wiki/posts/fc93a568.html">https://www.beihai.wiki/posts/fc93a568.html</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>ä½œè€…</h><div class="post-copyright-cc-info"><h>åŒ—æµ·ğŸŒŠ</h></div></div><div class="post-copyright-c"><h>å‘å¸ƒäº</h><div class="post-copyright-cc-info"><h>2023-08-10</h></div></div><div class="post-copyright-u"><h>æ›´æ–°äº</h><div class="post-copyright-cc-info"><h>2023-08-10</h></div></div><div class="post-copyright-c"><h>è®¸å¯åè®®</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"></div></div><link rel="stylesheet" href="/css/coin.css" media="defer" onload="this.media='all'"/><div class="post-reward"><button class="tip-button reward-button"><span class="tip-button__text">æŠ•å–‚ä½œè€…</span><div class="coin-wrapper"><div class="coin"><div class="coin__middle"></div><div class="coin__back"></div><div class="coin__front"></div></div></div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://tuchuang.voooe.cn/images/2024/06/07/VXpay.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tuchuang.voooe.cn/images/2024/06/07/VXpay.png" alt="å¾®ä¿¡"/></a><div class="post-qr-code-desc">å¾®ä¿¡</div></li><li class="reward-item"><a href="https://tuchuang.voooe.cn/images/2024/06/07/ZFpay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tuchuang.voooe.cn/images/2024/06/07/ZFpay.jpg" alt="æ”¯ä»˜å®"/></a><div class="post-qr-code-desc">æ”¯ä»˜å®</div></li></ul></div></button></div><audio id="coinAudio" src="https://npm.elemecdn.com/akilar-candyassets@1.0.36/audio/aowu.m4a"></audio><script defer="defer" src="/js/coin.js"></script><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/498ab7d9.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tuchuang.voooe.cn/images/2024/06/28/bc09.webp" onerror="onerror=null;src='/assets/r2.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">æœºå™¨å­¦ä¹ </div></div></a></div><div class="next-post pull-right"><a href="/posts/d7fb1ba1.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tuchuang.voooe.cn/images/2024/06/28/bc16.webp" onerror="onerror=null;src='/assets/r2.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">å…è´¹å›¾åºŠç»¼åˆæ•™ç¨‹</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><svg class="meta_icon" style="width:22px;height:22px;position:relative;top:5px"><use xlink:href="#icon-mulu1"></use></svg><span style="font-weight:bold">ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">æœºå™¨å­¦ä¹ ä¸å¤§æ•°æ®èµ›é¡¹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">æ¨¡å—Aï¼šå¤§æ•°æ®è¿ç»´ä¸åº”ç”¨(30åˆ†)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Hadoop%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-text">HadoopåŸºç¡€ç¯å¢ƒæ­å»º</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85"><span class="toc-text">MySQLç¦»çº¿å®‰è£…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hive%E5%AE%89%E8%A3%85"><span class="toc-text">Hiveå®‰è£…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hive%E4%BD%BF%E7%94%A8"><span class="toc-text">Hiveä½¿ç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sqoop%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="toc-text">Sqoopå®‰è£…ä¸ä½¿ç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spark%E5%AE%89%E8%A3%85"><span class="toc-text">Sparkå®‰è£…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spark%E4%BD%BF%E7%94%A8"><span class="toc-text">Sparkä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9C%81%E8%B5%9B%E6%A0%B7%E5%8D%B7%E4%B8%80"><span class="toc-text">çœèµ›æ ·å·ä¸€</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#6-1-%E8%AE%A1%E7%AE%97%E4%B8%8D%E9%87%8D%E5%A4%8D%E7%9A%84%E7%94%B5%E5%BD%B1%E6%95%B0%E9%87%8F"><span class="toc-text">6.1 è®¡ç®—ä¸é‡å¤çš„ç”µå½±æ•°é‡</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-2-%E8%AE%A1%E7%AE%97%E7%94%B5%E5%BD%B1%E5%B9%B3%E5%9D%87%E8%AF%84%E5%88%86"><span class="toc-text">6.2  è®¡ç®—ç”µå½±å¹³å‡è¯„åˆ†</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-3-%E8%AE%A1%E7%AE%97%E7%94%A8%E6%88%B7%E5%9C%A8%E5%A4%9C%E6%99%9A%E7%9A%84%E8%AF%84%E5%88%86%E6%80%BB%E8%AE%B0%E5%BD%95%E6%95%B0"><span class="toc-text">6.3  è®¡ç®—ç”¨æˆ·åœ¨å¤œæ™šçš„è¯„åˆ†æ€»è®°å½•æ•°</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Flume%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="toc-text">Flumeå®‰è£…ä¸ä½¿ç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Linux%E6%9D%83%E9%99%90"><span class="toc-text">Linuxæƒé™</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-text"></span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">æ¨¡å—Bï¼šæ•°æ®åˆ†æ(30åˆ†)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9C%81%E8%B5%9B%E6%A0%B7%E5%8D%B7%E4%B8%80%EF%BC%9A%E6%A8%A1%E5%9D%97B"><span class="toc-text">çœèµ›æ ·å·ä¸€ï¼šæ¨¡å—B</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A11%EF%BC%9A%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%8F%96%EF%BC%881%E5%88%86%EF%BC%89"><span class="toc-text">ä»»åŠ¡1ï¼šæ•°æ®è¯»å–ï¼ˆ1åˆ†ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A12%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%EF%BC%889%E5%88%86%EF%BC%89"><span class="toc-text">ä»»åŠ¡2ï¼šæ•°æ®å¤„ç†ï¼ˆ9åˆ†ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A12-1%EF%BC%881%E5%88%86%EF%BC%89"><span class="toc-text">ä»»åŠ¡2-1ï¼ˆ1åˆ†ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A12-2%EF%BC%881%E5%88%86%EF%BC%89"><span class="toc-text">ä»»åŠ¡2-2ï¼ˆ1åˆ†ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A12-4%EF%BC%881%E5%88%86%EF%BC%89"><span class="toc-text">ä»»åŠ¡2-4ï¼ˆ1åˆ†ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A12-5%EF%BC%882%E5%88%86%EF%BC%89"><span class="toc-text">ä»»åŠ¡2-5ï¼ˆ2åˆ†ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A12-6%EF%BC%882%E5%88%86%EF%BC%89"><span class="toc-text">ä»»åŠ¡2-6ï¼ˆ2åˆ†ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A13%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%EF%BC%8820%E5%88%86%EF%BC%89"><span class="toc-text">ä»»åŠ¡3ï¼šæ•°æ®å¯è§†åŒ–ï¼ˆ20åˆ†ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A13-1%EF%BC%882%E5%88%86%EF%BC%89"><span class="toc-text">ä»»åŠ¡3-1ï¼ˆ2åˆ†ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A13-2%EF%BC%882%E5%88%86%EF%BC%89"><span class="toc-text">ä»»åŠ¡3-2ï¼ˆ2åˆ†ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A13-3%EF%BC%882%E5%88%86%EF%BC%89"><span class="toc-text">ä»»åŠ¡3-3ï¼ˆ2åˆ†ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A13-4%EF%BC%882%E5%88%86%EF%BC%89"><span class="toc-text">ä»»åŠ¡3-4ï¼ˆ2åˆ†ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A13-5%EF%BC%882%E5%88%86%EF%BC%89"><span class="toc-text">ä»»åŠ¡3-5ï¼ˆ2åˆ†ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A13-6%EF%BC%882%E5%88%86%EF%BC%89"><span class="toc-text">ä»»åŠ¡3-6ï¼ˆ2åˆ†ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A13-7%EF%BC%882%E5%88%86%EF%BC%89"><span class="toc-text">ä»»åŠ¡3-7ï¼ˆ2åˆ†ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A13-8%EF%BC%882%E5%88%86%EF%BC%89"><span class="toc-text">ä»»åŠ¡3-8ï¼ˆ2åˆ†ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A13-9%EF%BC%884%E5%88%86%EF%BC%89"><span class="toc-text">ä»»åŠ¡3-9ï¼ˆ4åˆ†ï¼‰</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">æ¨¡å—Cï¼šæœºå™¨å­¦ä¹ </span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B"><span class="toc-text">ç‰¹å¾å·¥ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%BE%81%E6%8F%90%E5%8F%96"><span class="toc-text">ç‰¹å¾æå–</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E5%AD%97%E5%85%B8%E7%89%B9%E5%BE%81%E6%8F%90%E5%8F%96"><span class="toc-text">1ã€å­—å…¸ç‰¹å¾æå–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E6%96%87%E6%9C%AC%E7%89%B9%E5%BE%81%E6%8F%90%E5%8F%96"><span class="toc-text">2ã€æ–‡æœ¬ç‰¹å¾æå–</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%BE%81%E9%99%8D%E7%BB%B4"><span class="toc-text">ç‰¹å¾é™ç»´</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9"><span class="toc-text">1ã€ç‰¹å¾é€‰æ‹©</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E4%B8%BB%E6%88%90%E5%88%86%E5%88%86%E6%9E%90-PCA"><span class="toc-text">2ã€ä¸»æˆåˆ†åˆ†æ(PCA)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%83%E4%BC%98"><span class="toc-text">è°ƒä¼˜</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BD%91%E6%A0%BC%E6%90%9C%E7%B4%A2%E5%92%8C%E4%BA%A4%E5%8F%89%E9%AA%8C%E8%AF%81"><span class="toc-text">ç½‘æ ¼æœç´¢å’Œäº¤å‰éªŒè¯</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-text">æ•°æ®é¢„å¤„ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E5%9D%87%E5%80%BC%E7%A7%BB%E9%99%A4-%E6%A0%87%E5%87%86%E5%B7%AE%E6%A0%87%E5%87%86%E5%8C%96"><span class="toc-text">1ã€å‡å€¼ç§»é™¤ (æ ‡å‡†å·®æ ‡å‡†åŒ–)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E8%8C%83%E5%9B%B4%E7%BC%A9%E6%94%BE%EF%BC%88%E7%A6%BB%E5%B7%AE%E6%A0%87%E5%87%86%E5%8C%96%EF%BC%89"><span class="toc-text">2ã€èŒƒå›´ç¼©æ”¾ï¼ˆç¦»å·®æ ‡å‡†åŒ–ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81%E5%BC%82%E5%B8%B8%E5%80%BC%E7%BC%A9%E6%94%BE%E6%95%B0%E6%8D%AE"><span class="toc-text">3ã€å¼‚å¸¸å€¼ç¼©æ”¾æ•°æ®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E3%80%81%E5%BD%92%E4%B8%80%E5%8C%96"><span class="toc-text">4ã€å½’ä¸€åŒ–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E3%80%81%E4%BA%8C%E5%80%BC%E5%8C%96"><span class="toc-text">5ã€äºŒå€¼åŒ–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6%E3%80%81%E7%8B%AC%E7%83%AD%E7%BC%96%E7%A0%81%EF%BC%88onehot%EF%BC%89"><span class="toc-text">6ã€ç‹¬çƒ­ç¼–ç ï¼ˆonehotï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%E3%80%81%E6%A0%87%E7%AD%BE%E7%BC%96%E7%A0%81"><span class="toc-text">7ã€æ ‡ç­¾ç¼–ç </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8%E3%80%81%E5%B8%B8%E7%94%A8"><span class="toc-text">8ã€å¸¸ç”¨</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9E%E5%BD%92%E9%97%AE%E9%A2%98"><span class="toc-text">å›å½’é—®é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E7%AE%80%E4%BB%8B"><span class="toc-text">1ã€çº¿æ€§å›å½’ç®€ä»‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E4%B8%80%E5%85%83%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92"><span class="toc-text">2ã€ä¸€å…ƒçº¿æ€§å›å½’</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0"><span class="toc-text">æŸå¤±å‡½æ•°</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B%E7%9A%84%E4%BC%98%E5%8C%96%E6%B1%82%E8%A7%A3"><span class="toc-text">çº¿æ€§å›å½’æ¨¡å‹çš„ä¼˜åŒ–æ±‚è§£</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%AD%A3%E8%A7%84%E6%96%B9%E7%A8%8B"><span class="toc-text">æ­£è§„æ–¹ç¨‹</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%EF%BC%88Gradient-Descent%EF%BC%89"><span class="toc-text">æ¢¯åº¦ä¸‹é™ï¼ˆGradient Descentï¼‰</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%9B%9E%E5%BD%92%E7%9B%B8%E5%85%B3API"><span class="toc-text">3ã€å›å½’ç›¸å…³API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E6%A1%88%E4%BE%8B%E5%AE%9E%E6%88%98%EF%BC%9A%E5%8A%A0%E5%88%A9%E7%A6%8F%E5%B0%BC%E4%BA%9A%E6%88%BF%E5%B1%8B%E4%BB%B7%E6%A0%BC%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90"><span class="toc-text">4ã€æ¡ˆä¾‹å®æˆ˜ï¼šåŠ åˆ©ç¦å°¼äºšæˆ¿å±‹ä»·æ ¼å›å½’åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BB%B7%E6%8C%87%E6%A0%87"><span class="toc-text">5ã€å›å½’æ¨¡å‹è¯„ä»·æŒ‡æ ‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E8%BF%87%E6%8B%9F%E5%90%88%E5%92%8C%E6%AC%A0%E6%8B%9F%E5%90%88"><span class="toc-text">6ã€è¿‡æ‹Ÿåˆå’Œæ¬ æ‹Ÿåˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81%E5%A4%9A%E5%85%83%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92"><span class="toc-text">7ã€å¤šå…ƒçº¿æ€§å›å½’</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%81%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%9B%9E%E5%BD%92"><span class="toc-text">8ã€å¤šé¡¹å¼å›å½’</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9%E3%80%81%E6%AD%A3%E5%88%99%E5%8C%96%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8B"><span class="toc-text">9ã€æ­£åˆ™åŒ–çº¿æ€§æ¨¡å‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92"><span class="toc-text">é€»è¾‘å›å½’</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%E5%8E%9F%E7%90%86"><span class="toc-text">1ã€é€»è¾‘å›å½’åŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E4%BA%A4%E5%8F%89%E9%AA%8C%E8%AF%81"><span class="toc-text">2ã€äº¤å‰éªŒè¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%95%B0%E6%8D%AE%E9%9B%86%E5%88%92%E5%88%86"><span class="toc-text">3ã€æ•°æ®é›†åˆ’åˆ†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E6%A8%A1%E5%9E%8B%E6%90%AD%E5%BB%BA"><span class="toc-text">4ã€æ¨¡å‹æ­å»º</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E5%88%86%E7%B1%BB%E9%97%AE%E9%A2%98%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0"><span class="toc-text">5ã€åˆ†ç±»é—®é¢˜æ¨¡å‹è¯„ä¼°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E7%BA%A2%E9%85%92%E5%88%86%E7%B1%BB"><span class="toc-text">6ã€çº¢é…’åˆ†ç±»</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%B3%E7%AD%96%E6%A0%91"><span class="toc-text">å†³ç­–æ ‘</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%86%B3%E7%AD%96%E6%A0%91%E5%9B%9E%E5%BD%92%E5%99%A8%E6%A8%A1%E5%9E%8B%E7%9B%B8%E5%85%B3API"><span class="toc-text">1ã€å†³ç­–æ ‘å›å½’å™¨æ¨¡å‹ç›¸å…³API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E9%B8%A2%E5%B0%BE%E8%8A%B1%E5%9B%9E%E5%BD%92%E5%86%B3%E7%AD%96%E6%A0%91"><span class="toc-text">2ã€é¸¢å°¾èŠ±å›å½’å†³ç­–æ ‘</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E7%AE%97%E6%B3%95"><span class="toc-text">é›†åˆç®—æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E9%9A%8F%E6%9C%BA%E6%A3%AE%E6%9E%97"><span class="toc-text">1ã€éšæœºæ£®æ—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81AdaBoost"><span class="toc-text">2ã€AdaBoost</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF"><span class="toc-text">æœ´ç´ è´å¶æ–¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA-SVM"><span class="toc-text">æ”¯æŒå‘é‡æœº(SVM)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%B1%BB%EF%BC%88SVC%EF%BC%89"><span class="toc-text">åˆ†ç±»ï¼ˆSVCï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9E%E5%BD%92%EF%BC%88SVR%EF%BC%89"><span class="toc-text">å›å½’ï¼ˆSVRï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B"><span class="toc-text">æ¡ˆä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ROC%E6%9B%B2%E7%BA%BF%E4%B8%8EAUC%E6%8C%87%E6%A0%87"><span class="toc-text">ROCæ›²çº¿ä¸AUCæŒ‡æ ‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E4%BF%9D%E5%AD%98%E5%92%8C%E5%8A%A0%E8%BD%BD"><span class="toc-text">æ¨¡å‹ä¿å­˜å’ŒåŠ è½½</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A0%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0"><span class="toc-text">æ— ç›‘ç£å­¦ä¹ </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#K-means%E8%81%9A%E7%B1%BB"><span class="toc-text">K-meansèšç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%84%E4%BC%B0"><span class="toc-text">è¯„ä¼°</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E7%94%A8%E5%8D%A1%E8%AF%88%E9%AA%97%E6%A3%80%E6%B5%8B"><span class="toc-text">ä¿¡ç”¨å¡è¯ˆéª—æ£€æµ‹</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-color: transparent;"><div id="footer-wrap"><div id="ft"><div class="ft-item-1"><div class="t-top"><div class="t-t-l"><p class="ft-t t-l-t">æ ¼è¨€ğŸ§¬</p><div class="bg-ad"><div>å†çœ‹çœ‹é‚£ä¸ªå…‰ç‚¹ï¼Œå®ƒå°±åœ¨è¿™é‡Œï¼Œè¿™æ˜¯å®¶å›­ï¼Œè¿™æ˜¯æˆ‘ä»¬ â€”â€” ä½ æ‰€çˆ±çš„æ¯ä¸€ä¸ªäººï¼Œä½ è®¤è¯†çš„ä¸€ä¸ªäººï¼Œä½ å¬è¯´è¿‡çš„æ¯ä¸€ä¸ªäººï¼Œæ›¾ç»æœ‰è¿‡çš„æ¯ä¸€ä¸ªäººï¼Œéƒ½åœ¨å®ƒä¸Šé¢åº¦è¿‡ä»–ä»¬çš„ä¸€ç”Ÿâœ¨</div><div class="btn-xz-box"><a class="btn-xz" target="_blank" rel="noopener" href="https://stellarium.org/">ç‚¹å‡»å¼€å¯æ˜Ÿè¾°ä¹‹æ—…</a></div></div></div><div class="t-t-r"><p class="ft-t t-l-t">çŒœä½ æƒ³çœ‹ğŸ’¡</p><ul class="ft-links"><li><a href="/posts/eec9786.html">é­”æ”¹æŒ‡å—</a><a href="/box/nav/">ç½‘å€å¯¼èˆª</a></li><li><a href="/social/link/">æˆ‘çš„æœ‹å‹</a><a href="/comments/">ç•™ç‚¹ä»€ä¹ˆ</a></li><li><a href="/personal/about/">å…³äºä½œè€…</a><a href="/archives/">æ–‡ç« å½’æ¡£</a></li><li><a href="/categories/">æ–‡ç« åˆ†ç±»</a><a href="/tags/">æ–‡ç« æ ‡ç­¾</a></li><li><a href="/box/gallery/">æˆ‘çš„ç”»å»Š</a><a href="/personal/bb/">æˆ‘çš„å” å¨</a></li><li><a href="/site/time/">å»ºè®¾è¿›ç¨‹</a><a href="/site/census/">ç½‘ç«™ç»Ÿè®¡</a></li></ul></div></div></div><div class="ft-item-2"><p class="ft-t">æ¨èå‹é“¾âŒ›</p><div class="ft-img-group"><div class="img-group-item"><a href="https://www.beihai.wiki/" title="åŒ—æµ·WikiğŸŒŠ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tuchuang.voooe.cn/images/2024/06/28/ec042e2c1e514fb772b637364b0710a7.gif" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tuchuang.voooe.cn/images/2024/06/08/hellokittydance.gif" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="" alt=""/></a></div></div></div></div><div class="copyright"><span><b>&copy;2022-2024</b></span><span><b>&nbsp;&nbsp;By åŒ—æµ·ğŸŒŠ</b></span></div><div class="footer_custom_text"><a target="_blank" rel="noopener" href="http://beian.miit.gov.cn/"><img class="icp-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://beian.mps.gov.cn/img/logo01.dd7ff50e.png"><span>å¤‡æ¡ˆå·ï¼šé²ICPå¤‡2024091427å·</span></a></div><div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" title="æœ¬ç«™é‡‡ç”¨å¤šçº¿éƒ¨ç½²ï¼Œä¸»çº¿è·¯æ‰˜ç®¡äºVercel"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Vercel-brightgreen?style=flat&amp;logo=Vercel" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" title="æœ¬ç«™é¡¹ç›®ç”±Githubæ‰˜ç®¡"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" title="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" title="æœ¬ç«™é¡¹ç›®ç”±Githubæ‰˜ç®¡"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a></p></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><a class="icon-V hidden" onclick="switchNightMode()" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button><button class="share" type="button" title="å³é”®æ¨¡å¼" onclick="changeMouseMode()"><i class="fas fa-mouse"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog right_side"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button class="share" type="button" title="åˆ†äº«é“¾æ¥" onclick="share()"><i class="fas fa-share-nodes"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i><span id="percent">0<span>%</span></span></button><button id="go-down" type="button" title="ç›´è¾¾åº•éƒ¨" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div class="js-pjax" id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa fa-arrow-right"></i></a><a class="rightMenu-item" href="javascript:window.location.reload();"><i class="fa fa-refresh"></i></a><a class="rightMenu-item" href="javascript:rmf.scrollToTop();"><i class="fa fa-arrow-up"></i></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa fa-copy"></i><span>å¤åˆ¶</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.baidu.com/s?wd=&quot;+window.getSelection().toString());window.location.reload();"><i class="fa fa-search"></i><span>ç™¾åº¦æœç´¢</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-too"><a class="rightMenu-item" href="javascript:window.open(window.getSelection().toString());window.location.reload();"><i class="fa fa-link"></i><span>è½¬åˆ°é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-paste"><a class="rightMenu-item" href="javascript:rmf.paste()"><i class="fa fa-copy"></i><span>ç²˜è´´</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-post"><a class="rightMenu-item" href="#post-comment"><i class="fas fa-comment"></i><span>ç©ºé™è¯„è®º</span></a><a class="rightMenu-item" href="javascript:rmf.copyWordsLink()"><i class="fa fa-link"></i><span>å¤åˆ¶æœ¬æ–‡åœ°å€</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-to"><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>æ–°çª—å£æ‰“å¼€</span></a><a class="rightMenu-item" id="menu-too" href="javascript:rmf.open()"><i class="fa fa-link"></i><span>è½¬åˆ°é“¾æ¥</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>å¤åˆ¶é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-img"><a class="rightMenu-item" href="javascript:rmf.saveAs()"><i class="fa fa-download"></i><span>ä¿å­˜å›¾ç‰‡</span></a><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>åœ¨æ–°çª—å£æ‰“å¼€</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>å¤åˆ¶å›¾ç‰‡é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:switchNightMode();"><i class="fa fa-moon"></i><span>æ˜¼å¤œåˆ‡æ¢</span></a><a class="rightMenu-item" href="/personal/about/"><i class="fa fa-info-circle"></i><span>å…³äºåšå®¢</span></a><a class="rightMenu-item" href="javascript:rmf.fullScreen();"><i class="fas fa-expand"></i><span>åˆ‡æ¢å…¨å±</span></a><a class="rightMenu-item" href="javascript:window.print();"><i class="fa-solid fa-print"></i><span>æ‰“å°é¡µé¢</span></a></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.umd.min.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js" type="module"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><script async="async">var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())
setTimeout(function(){preloader.endLoading();}, 5000);
document.getElementById('loading-box').addEventListener('click',()=> {preloader.endLoading()})</script><div class="js-pjax"><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: '',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: '',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.staticfile.org/twikoo/1.6.8/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script src="https://cdn.staticfile.org/jquery/3.6.3/jquery.min.js"></script><script async src="https://cdn1.tianli0.top/npm/vue@2.6.14/dist/vue.min.js"></script><script async src="https://cdn1.tianli0.top/npm/element-ui@2.15.6/lib/index.js"></script><div class="aplayer no-destroy" id="aplayer" data-id="7100534627" data-server="netease" data-type="playlist" data-order="list" data-fixed="true" data-preload="auto" data-autoplay="true" data-mutex="true"></div><script async src="https://cdn.bootcdn.net/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script><script defer type="text/javascript" src="https://cdn1.tianli0.top/npm/sweetalert2@8.19.0/dist/sweetalert2.all.js"></script><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer src="https://cdn1.tianli0.top/gh/nextapps-de/winbox/dist/winbox.bundle.min.js"></script><script async src="//at.alicdn.com/t/c/font_4051628_e4216kdfc9.js"></script><script async src="//at.alicdn.com/t/c/font_3586335_hsivh70x0fm.js"></script><script async src="//at.alicdn.com/t/c/font_3636804_gr02jmjr3y9.js"></script><script async src="//at.alicdn.com/t/c/font_3612150_kfv55xn3u2g.js"></script><script async src="https://cdn.wpon.cn/2022-sucai/Gold-ingot.js"></script><canvas id="universe"></canvas><canvas id="snow"></canvas><script defer src="/js/fomal.js"></script><script id="click-show-text" src="https://cdnjs.cloudflare.com/ajax/libs/butterfly-extsrc/1.1.3/click-show-text.min.js" data-mobile="false" data-text="I,LOVE,åŒ—æµ·,Wiki" data-fontsize="15px" data-random="false" async="async"></script><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.js"></script><script src="https://cdn1.tianli0.top/npm/js-heo@1.0.12/metingjs/Meting.min.js"></script><script src="https://lib.baomitu.com/pjax/0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show","#web_bg",".js-pjax","#bibi","body > title","#app","#tag-echarts","#posts-echart","#categories-echarts"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --> <script data-pjax>if(document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    var parent = document.getElementById('recent-posts');
    var child = '<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="https://www.beihai.wiki/categories/å·¥ä½œå®¤/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ… åŒ—æµ·ã®å¤§å­¦çš„å·¥ä½œå®¤ (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://www.beihai.wiki/categories/å¤§æ•°æ®/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ‘©â€ğŸ’» åŒ—æµ·ã®å¤§æ•°æ® (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://www.beihai.wiki/categories/å·¥ä½œå®¤/å¤§æ•°æ®/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ‘©â€ğŸ’» åŒ—æµ·ã®å¤§æ•°æ® (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://www.beihai.wiki/categories/å®ç”¨å°æŠ€å·§/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ® åŒ—æµ·ã®å®ç”¨å°æŠ€å·§ (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item" style="visibility: hidden"></div><div class="magnet_item" style="visibility: hidden"></div><a class="magnet_link_more"  href="https://www.beihai.wiki/categories/" style="flex:1;text-align: center;margin-bottom: 10px;">æŸ¥çœ‹æ›´å¤š...</a></div></div>';
    console.log('å·²æŒ‚è½½magnet')
    parent.insertAdjacentHTML("afterbegin",child)}
     </script><style>#catalog_magnet{flex-wrap: wrap;display: flex;width:100%;justify-content:space-between;padding: 10px 10px 0 10px;align-content: flex-start;}.magnet_item{flex-basis: calc(33.333333333333336% - 5px);background: #e9e9e9;margin-bottom: 10px;border-radius: 8px;transition: all 0.2s ease-in-out;}.magnet_item:hover{background: var(--text-bg-hover)}.magnet_link_more{color:#555}.magnet_link{color:black}.magnet_link:hover{color:white}@media screen and (max-width: 600px) {.magnet_item {flex-basis: 100%;}}.magnet_link_context{display:flex;padding: 10px;font-size:16px;transition: all 0.2s ease-in-out;}.magnet_link_context:hover{padding: 10px 20px;}</style>
    <style></style><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/498ab7d9.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tuchuang.voooe.cn/images/2024/06/28/bc09.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-08-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/498ab7d9.html&quot;);" href="javascript:void(0);" alt="">æœºå™¨å­¦ä¹ </a><div class="blog-slider__text">æœºå™¨å­¦ä¹ </div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/498ab7d9.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tuchuang.voooe.cn/images/2024/06/28/bc09.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-08-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt="">Markdownè¯­æ³•ä¸å¤–æŒ‚æ ‡ç­¾å†™æ³•æ±‡æ€»</a><div class="blog-slider__text">ğŸ¥§æœ¬æ–‡æ±‡æ€»Markdownæ ¼å¼ä»¥åŠå¤–æŒ‚æ ‡ç­¾åœ¨ç½‘é¡µç«¯çš„æ¸²æŸ“æ•ˆæœï¼Œå¯ä½œä¸ºæ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('å·²æŒ‚è½½butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><script data-pjax src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>
  function gitcalendar_injector_config(){
      var parent_div_git = document.getElementById('gitZone');
      var item_html = '<div class="recent-post-item" id="gitcalendarBar" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 320px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      console.log('å·²æŒ‚è½½gitcalendar')
      }

    if( document.getElementById('gitZone') && (location.pathname ==='/site/census/'|| '/site/census/' ==='all')){
        gitcalendar_injector_config()
        GitCalendarInit("/api?null",['#d9e0df', '#c6e0dc', '#a8dcd4', '#9adcd2', '#89ded1', '#77e0d0', '#5fdecb', '#47dcc6', '#39dcc3', '#1fdabe', '#00dab9'],'null')
    }
  </script><!-- hexo injector body_end end --></body></html>